<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeumoCare Hospital Management System</title>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Vue.js 3 - MUST BE LOADED FIRST -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
  <style>
    /* ============ MEDICAL BLUE THEME ============ */
    :root {
        --medical-blue: #0077be;
        --medical-dark-blue: #005a9e;
        --medical-light-blue: #e3f2fd;
        --medical-teal: #00838f;
        --medical-green: #2e7d32;
        --medical-red: #c62828;
        --medical-orange: #f57c00;
        --medical-gray: #546e7a;
        --medical-light-gray: #f5f7fa;
        
        --primary-color: var(--medical-blue);
        --primary-dark: var(--medical-dark-blue);
        --primary-light: var(--medical-light-blue);
        --secondary-color: var(--medical-green);
        --danger-color: var(--medical-red);
        --warning-color: var(--medical-orange);
        --info-color: var(--medical-teal);
        --gray-50: #f8f9fa;
        --gray-100: #f1f3f4;
        --gray-200: #e8eaed;
        --gray-300: #dadce0;
        --gray-400: #bdc1c6;
        --gray-500: var(--medical-gray);
        --gray-600: #80868b;
        --gray-700: #5f6368;
        --gray-800: #3c4043;
        --gray-900: #202124;
        
        --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
        --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
        --shadow-lg: 0 10px 40px rgba(0,0,0,0.15);
        --shadow-xl: 0 20px 60px rgba(0,0,0,0.2);
        
        --border-radius-sm: 6px;
        --border-radius-md: 10px;
        --border-radius-lg: 16px;
        --border-radius-xl: 24px;
        
        --transition-fast: 150ms;
        --transition-normal: 250ms;
        --transition-slow: 350ms;
    }
    
    /* ADD THIS AT THE TOP OF YOUR STYLES */
    [v-cloak] {
        display: none !important;
    }

    #app[v-cloak] {
        opacity: 0;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
        color: var(--gray-900);
        line-height: 1.6;
        min-height: 100vh;
        scroll-behavior: smooth;
    }

    h1, h2, h3, h4, h5, h6 {
        font-family: 'Poppins', sans-serif;
        font-weight: 600;
        line-height: 1.3;
    }

    /* ============ UTILITY CLASSES ============ */
    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
    }

    .text-primary { color: var(--primary-color); }
    .text-success { color: var(--secondary-color); }
    .text-danger { color: var(--danger-color); }
    .text-warning { color: var(--warning-color); }
    .text-info { color: var(--info-color); }
    .text-muted { color: var(--gray-600); }

    .bg-primary { background: var(--primary-color); }
    .bg-success { background: var(--secondary-color); }
    .bg-danger { background: var(--danger-color); }
    .bg-warning { background: var(--warning-color); }
    .bg-info { background: var(--info-color); }
    .bg-light { background: var(--gray-50); }

    .shadow-sm { box-shadow: var(--shadow-sm); }
    .shadow-md { box-shadow: var(--shadow-md); }
    .shadow-lg { box-shadow: var(--shadow-lg); }

    .rounded-sm { border-radius: var(--border-radius-sm); }
    .rounded-md { border-radius: var(--border-radius-md); }
    .rounded-lg { border-radius: var(--border-radius-lg); }
    .rounded-xl { border-radius: var(--border-radius-xl); }

    .transition { transition: all var(--transition-normal) ease; }
    .transition-fast { transition: all var(--transition-fast) ease; }
    .transition-slow { transition: all var(--transition-slow) ease; }

    .mt-1 { margin-top: 0.25rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-3 { margin-top: 0.75rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-6 { margin-top: 1.5rem; }
    .mt-8 { margin-top: 2rem; }

    .mb-1 { margin-bottom: 0.25rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }

    .ml-2 { margin-left: 0.5rem; }

    .w-100 { width: 100%; }
    .h-100 { height: 100%; }

    .flex { display: flex; }
    .grid { display: grid; }
    .hidden { display: none; }
    .block { display: block; }

    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 0.5rem; }
    .gap-4 { gap: 1rem; }
    .gap-6 { gap: 1.5rem; }

    /* ============ MEDICAL PROFESSIONAL BUTTONS ============ */
    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 24px;
        border: none;
        border-radius: var(--border-radius-md);
        font-family: 'Inter', sans-serif;
        font-weight: 600;
        font-size: 14px;
        line-height: 1;
        cursor: pointer;
        transition: all var(--transition-normal) ease;
        white-space: nowrap;
        min-height: 44px;
        touch-action: manipulation;
        letter-spacing: 0.3px;
        text-transform: uppercase;
    }

    .btn i { font-size: 14px; }

    .btn-primary {
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
        color: white;
        box-shadow: 0 4px 12px rgba(0, 119, 190, 0.3);
    }
    .btn-primary:hover {
        background: linear-gradient(135deg, var(--medical-dark-blue), var(--medical-blue));
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 119, 190, 0.4);
    }

    .btn-secondary {
        background: white;
        color: var(--medical-blue);
        border: 2px solid var(--medical-blue);
        box-shadow: 0 2px 8px rgba(0, 119, 190, 0.1);
    }
    .btn-secondary:hover {
        background: var(--medical-light-blue);
        border-color: var(--medical-dark-blue);
        transform: translateY(-2px);
    }

    .btn-success {
        background: linear-gradient(135deg, var(--medical-green), #1b5e20);
        color: white;
        box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
    }
    .btn-success:hover {
        opacity: 0.9;
        transform: translateY(-2px);
    }

    .btn-danger {
        background: linear-gradient(135deg, var(--medical-red), #b71c1c);
        color: white;
        box-shadow: 0 4px 12px rgba(198, 40, 40, 0.3);
    }
    .btn-danger:hover {
        opacity: 0.9;
        transform: translateY(-2px);
    }

    .btn-outline {
        background: transparent;
        border: 2px solid var(--medical-blue);
        color: var(--medical-blue);
    }
    .btn-outline:hover {
        background: var(--medical-blue);
        color: white;
    }

    .btn-outline-danger {
        background: transparent;
        border: 2px solid var(--medical-red);
        color: var(--medical-red);
    }
    .btn-outline-danger:hover {
        background: var(--medical-red);
        color: white;
    }

    .btn-sm { padding: 8px 16px; font-size: 13px; min-height: 36px; }
    .btn-lg { padding: 14px 28px; font-size: 16px; min-height: 52px; }

    .btn-icon {
        width: 44px;
        height: 44px;
        padding: 0;
        border-radius: 50%;
    }

    /* ============ PROFESSIONAL BADGES ============ */
    .badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: white;
        border: 1px solid transparent;
    }

    .badge-primary {
        background: var(--medical-blue);
        border-color: var(--medical-dark-blue);
    }

    .badge-success {
        background: var(--medical-green);
        border-color: #1b5e20;
    }

    .badge-warning {
        background: var(--medical-orange);
        border-color: #e65100;
    }

    .badge-danger {
        background: var(--medical-red);
        border-color: #b71c1c;
    }

    .badge-info {
        background: var(--medical-teal);
        border-color: #006064;
    }

    /* ============ STATUS BADGES ============ */
    .status-available {
        background: linear-gradient(135deg, var(--medical-green), #1b5e20);
        color: white;
    }

    .status-busy {
        background: linear-gradient(135deg, var(--medical-orange), #e65100);
        color: white;
    }

    .status-critical {
        background: linear-gradient(135deg, var(--medical-red), #b71c1c);
        color: white;
    }

    .status-oncall {
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
        color: white;
    }

    /* ============ PROFESSIONAL CARDS ============ */
    .card {
        background: white;
        border-radius: var(--border-radius-lg);
        padding: 24px;
        box-shadow: var(--shadow-sm);
        transition: all var(--transition-normal) ease;
        border: 1px solid var(--gray-200);
        border-left: 4px solid var(--medical-blue);
        position: relative;
        overflow: hidden;
    }

    .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--medical-blue), var(--medical-teal));
    }

    .card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-4px);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--medical-light-blue);
    }

    .card-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--gray-900);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .card-title i {
        color: var(--medical-blue);
        font-size: 18px;
        width: 24px;
        text-align: center;
    }

    /* ============ ENHANCED MODAL STYLES ============ */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        backdrop-filter: blur(5px);
        animation: fadeIn 0.2s ease-out;
        padding: 20px;
    }

    .modal-container {
        background: white;
        border-radius: var(--border-radius-lg);
        width: 90%;
        max-width: 700px;
        max-height: 90vh;
        overflow-y: auto;
        animation: modalSlideIn 0.3s ease;
        box-shadow: var(--shadow-xl);
        border: 1px solid var(--gray-200);
        display: flex;
        flex-direction: column;
    }

    .modal-wide {
        max-width: 900px;
    }

    .modal-xwide {
        max-width: 1100px;
    }

    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(-30px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 24px;
        border-bottom: 2px solid var(--medical-light-blue);
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
        color: white;
        border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        position: sticky;
        top: 0;
        z-index: 10;
    }

    .modal-title {
        font-size: 20px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .modal-title i {
        font-size: 20px;
        opacity: 0.9;
    }

    .modal-close {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        font-size: 16px;
        cursor: pointer;
        padding: 10px;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all var(--transition-fast) ease;
        min-height: 44px;
    }

    .modal-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
    }

    .modal-body {
        padding: 24px;
        flex: 1;
        overflow-y: auto;
    }

    .modal-footer {
        padding: 20px 24px;
        border-top: 2px solid var(--medical-light-blue);
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        background: var(--gray-50);
        border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
        position: sticky;
        bottom: 0;
    }

    /* Modal Tabs */
    .modal-tabs {
        display: flex;
        border-bottom: 2px solid var(--medical-light-blue);
        margin-bottom: 24px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .modal-tabs::-webkit-scrollbar {
        height: 3px;
    }

    .modal-tab {
        padding: 12px 24px;
        border: none;
        background: none;
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        font-weight: 500;
        color: var(--gray-600);
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all var(--transition-fast);
        white-space: nowrap;
        min-height: 44px;
    }

    .modal-tab:hover {
        color: var(--medical-blue);
        background: var(--medical-light-blue);
    }

    .modal-tab.active {
        color: var(--medical-blue);
        border-bottom-color: var(--medical-blue);
        background: var(--medical-light-blue);
    }

    .modal-tab-content {
        display: none;
    }

    .modal-tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
    }

    /* Modal Sections */
    .modal-section {
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 1px solid var(--medical-light-blue);
    }

    .modal-section:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }

    .modal-section-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--gray-800);
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 0;
    }

    .modal-section-title i {
        font-size: 14px;
        color: var(--medical-blue);
    }

    /* ============ ENHANCED FORM STYLES ============ */
    .form-group {
        margin-bottom: 24px;
    }

    .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--medical-dark-blue);
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .form-control {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid var(--gray-300);
        border-radius: var(--border-radius-md);
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        transition: all var(--transition-normal) ease;
        background: white;
        min-height: 44px;
    }

    .form-control:focus {
        outline: none;
        border-color: var(--medical-blue);
        box-shadow: 0 0 0 3px rgba(0, 119, 190, 0.1);
    }

    .form-control-sm {
        padding: 10px 12px;
        font-size: 13px;
        min-height: 40px;
    }

    .form-select {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid var(--gray-300);
        border-radius: var(--border-radius-md);
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        background: white;
        cursor: pointer;
        min-height: 44px;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%230077be' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
        background-size: 16px;
    }

    .form-select:focus {
        outline: none;
        border-color: var(--medical-blue);
        box-shadow: 0 0 0 3px rgba(0, 119, 190, 0.1);
    }

    .form-check {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 12px;
    }

    .form-check-input {
        width: 20px;
        height: 20px;
        cursor: pointer;
        min-height: 20px;
        accent-color: var(--medical-blue);
    }

    .form-check-label {
        font-size: 14px;
        color: var(--gray-700);
        cursor: pointer;
        font-weight: 500;
    }

    /* ============ ENHANCED TRAINING UNITS GRID ============ */
    .training-units-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 24px;
        margin-bottom: 32px;
    }

    .training-unit-card {
        background: white;
        border-radius: var(--border-radius-lg);
        padding: 24px;
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--medical-light-blue);
        transition: all var(--transition-normal);
        position: relative;
    }

    .training-unit-card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
    }

    .training-unit-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .training-unit-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--medical-dark-blue);
    }

    .training-unit-capacity {
        font-size: 14px;
        color: var(--medical-gray);
    }

    .training-unit-residents {
        margin-top: 16px;
    }

    .resident-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 12px;
        background: var(--gray-50);
        border-radius: var(--border-radius-sm);
        margin-bottom: 8px;
    }

    .resident-name {
        font-weight: 500;
        color: var(--gray-800);
    }

    .resident-level {
        font-size: 12px;
        color: var(--medical-gray);
    }

    /* ============ CLINICAL UNIT ENTRY STYLES ============ */
    .clinical-unit-entry {
        background: white;
        border: 1px solid var(--medical-light-blue);
        border-radius: var(--border-radius-md);
        padding: 20px;
        margin-bottom: 20px;
        transition: all var(--transition-normal);
    }

    .clinical-unit-entry:hover {
        border-color: var(--medical-blue);
        box-shadow: var(--shadow-sm);
    }

    /* ============ TABLES ============ */
    .table-responsive {
        overflow-x: auto;
        border-radius: var(--border-radius-md);
        background: white;
        box-shadow: var(--shadow-sm);
        -webkit-overflow-scrolling: touch;
        border: 1px solid var(--medical-light-blue);
    }

    .table-responsive::-webkit-scrollbar {
        height: 6px;
    }

    .table-responsive::-webkit-scrollbar-track {
        background: var(--gray-100);
    }

    .table-responsive::-webkit-scrollbar-thumb {
        background: var(--medical-blue);
        border-radius: 3px;
    }

    .table {
        width: 100%;
        border-collapse: collapse;
        min-width: 800px;
    }

    .table thead {
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
    }

    .table th {
        padding: 16px;
        text-align: left;
        color: white;
        font-weight: 600;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: 2px solid var(--gray-200);
    }

    .table tbody tr {
        border-bottom: 1px solid var(--medical-light-blue);
        transition: all var(--transition-fast) ease;
    }

    .table tbody tr:hover {
        background: var(--medical-light-blue);
    }

    .table td {
        padding: 16px;
        font-size: 14px;
        color: var(--gray-700);
        vertical-align: middle;
    }

    /* ============ TOASTS ============ */
    .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 99999;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .toast {
        background: white;
        border-radius: var(--border-radius-md);
        padding: 16px 20px;
        min-width: 300px;
        max-width: 400px;
        box-shadow: var(--shadow-lg);
        border-left: 4px solid var(--medical-blue);
        animation: toastSlideIn 0.3s ease;
        display: flex;
        gap: 12px;
        align-items: flex-start;
    }

    @keyframes toastSlideIn {
        from {
            opacity: 0;
            transform: translateX(100%);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .toast-icon {
        font-size: 18px;
        color: var(--medical-blue);
        margin-top: 2px;
    }

    .toast-content {
        flex: 1;
    }

    .toast-title {
        font-weight: 600;
        font-size: 14px;
        margin-bottom: 4px;
        color: var(--gray-900);
    }

    .toast-message {
        font-size: 13px;
        color: var(--gray-700);
        line-height: 1.4;
    }

    .toast-close {
        background: none;
        border: none;
        color: var(--gray-500);
        font-size: 14px;
        cursor: pointer;
        padding: 4px;
        border-radius: 4px;
        transition: all var(--transition-fast);
        min-height: 24px;
    }

    .toast-close:hover {
        background: var(--gray-100);
        color: var(--gray-700);
    }

    .toast-success { border-left-color: var(--medical-green); }
    .toast-success .toast-icon { color: var(--medical-green); }

    .toast-error { border-left-color: var(--medical-red); }
    .toast-error .toast-icon { color: var(--medical-red); }

    .toast-warning { border-left-color: var(--medical-orange); }
    .toast-warning .toast-icon { color: var(--medical-orange); }

    /* ============ LOGIN SCREEN ============ */
    .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        background: linear-gradient(135deg, var(--medical-dark-blue) 0%, var(--medical-blue) 100%);
    }

    .login-card {
        background: white;
        border-radius: var(--border-radius-xl);
        padding: 48px;
        width: 100%;
        max-width: 500px;
        box-shadow: var(--shadow-xl);
        animation: fadeIn 0.8s ease;
        border: 1px solid var(--medical-light-blue);
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .login-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .login-logo {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
    }

    .login-logo i {
        font-size: 42px;
        color: var(--medical-blue);
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .login-title {
        font-size: 32px;
        font-weight: 700;
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 8px;
    }

    .login-subtitle {
        color: var(--medical-gray);
        font-size: 16px;
        max-width: 400px;
        margin: 0 auto;
        font-weight: 500;
    }

    /* ============ MAIN LAYOUT ============ */
    .app-layout {
        display: flex;
        min-height: 100vh;
        background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    }

    /* ============ MEDICAL SIDEBAR ============ */
    .sidebar {
        width: 280px;
        background: linear-gradient(180deg, var(--medical-dark-blue) 0%, var(--medical-blue) 100%);
        color: white;
        display: flex;
        flex-direction: column;
        transition: all var(--transition-normal) ease;
        position: fixed;
        height: 100vh;
        z-index: 1000;
        box-shadow: var(--shadow-lg);
    }

    .sidebar-collapsed {
        width: 80px;
    }

    .sidebar-header {
        padding: 24px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: rgba(0, 0, 0, 0.1);
    }

    .sidebar-logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 600;
        font-size: 18px;
    }

    .sidebar-logo i {
        font-size: 24px;
        color: white;
    }

    .sidebar-toggle {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        font-size: 14px;
        cursor: pointer;
        padding: 10px;
        border-radius: 6px;
        transition: all var(--transition-fast) ease;
        min-height: 44px;
        width: 44px;
        height: 44px;
    }

    .sidebar-toggle:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    .sidebar-nav {
        flex: 1;
        padding: 20px 0;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .sidebar-section {
        margin-bottom: 24px;
    }

    .sidebar-section-title {
        padding: 0 24px 12px;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        color: rgba(255, 255, 255, 0.6);
        font-weight: 600;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 8px;
    }

    .sidebar-menu {
        list-style: none;
    }

    .sidebar-menu-item {
        margin: 4px 0;
    }

    .sidebar-menu-link {
        display: flex;
        align-items: center;
        gap: 14px;
        padding: 14px 24px;
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: all var(--transition-fast) ease;
        font-size: 14px;
        font-weight: 500;
        border-left: 3px solid transparent;
        min-height: 48px;
        margin: 0 12px;
        border-radius: 8px;
    }

    .sidebar-menu-link:hover {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        transform: translateX(4px);
    }

    .sidebar-menu-link.active {
        background: rgba(255, 255, 255, 0.15);
        color: white;
        border-left-color: #4fc3f7;
        box-shadow: 0 4px 12px rgba(79, 195, 247, 0.2);
    }

    .sidebar-menu-link i {
        font-size: 16px;
        width: 20px;
        text-align: center;
    }

    .sidebar-footer {
        padding: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(0, 0, 0, 0.1);
    }

    .sidebar-user {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .user-avatar {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: linear-gradient(135deg, #4fc3f7, var(--medical-blue));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 16px;
        flex-shrink: 0;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .user-info {
        flex: 1;
        min-width: 0;
    }

    .user-name {
        font-size: 14px;
        font-weight: 600;
        color: white;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .user-role {
        font-size: 12px;
        color: rgba(255, 255, 255, 0.7);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .sidebar-collapsed .sidebar-header {
        justify-content: center;
    }

    .sidebar-collapsed .sidebar-logo span,
    .sidebar-collapsed .sidebar-section-title,
    .sidebar-collapsed .sidebar-menu-link span,
    .sidebar-collapsed .user-info,
    .sidebar-collapsed .sidebar-toggle span {
        display: none;
    }

    .sidebar-collapsed .sidebar-logo,
    .sidebar-collapsed .sidebar-menu-link {
        justify-content: center;
    }

    .sidebar-collapsed .sidebar-menu-link i {
        font-size: 18px;
    }

    /* ============ MAIN CONTENT ============ */
    .main-content {
        flex: 1;
        margin-left: 280px;
        transition: all var(--transition-normal) ease;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    .main-content-expanded {
        margin-left: 80px;
    }

    /* ============ TOP NAVBAR ============ */
    .top-navbar {
        background: white;
        padding: 16px 32px;
        box-shadow: 0 2px 8px rgba(0, 119, 190, 0.1);
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 3px solid var(--medical-light-blue);
    }

    .navbar-left {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .navbar-title {
        font-size: 20px;
        font-weight: 600;
        color: var(--medical-dark-blue);
    }

    .navbar-subtitle {
        font-size: 14px;
        color: var(--medical-gray);
        margin-left: 10px;
        font-weight: 500;
    }

    .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 18px;
        color: var(--medical-blue);
        cursor: pointer;
        padding: 12px;
        border-radius: 6px;
        min-height: 44px;
    }

    .mobile-menu-toggle:hover {
        background: var(--medical-light-blue);
    }

    .navbar-right {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    /* ============ ENHANCED SEARCH ============ */
    .search-container {
        position: relative;
        width: 300px;
    }

    .search-box {
        position: relative;
    }

    .search-input {
        width: 100%;
        padding: 12px 16px 12px 48px;
        border: 2px solid var(--medical-light-blue);
        border-radius: var(--border-radius-md);
        font-size: 14px;
        transition: all var(--transition-normal) ease;
        background: white;
        min-height: 44px;
        font-weight: 500;
    }

    .search-input:focus {
        outline: none;
        border-color: var(--medical-blue);
        background: white;
        box-shadow: 0 0 0 3px rgba(0, 119, 190, 0.1);
    }

    .search-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--medical-blue);
        font-size: 16px;
        pointer-events: none;
    }

    .search-scope {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        background: var(--medical-light-blue);
        border: none;
        color: var(--medical-blue);
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        padding: 6px 12px;
        border-radius: 4px;
        min-height: 32px;
        transition: all var(--transition-fast);
    }

    .search-scope:hover {
        background: var(--medical-blue);
        color: white;
    }

    .search-filters {
        display: flex;
        gap: 8px;
        margin-top: 8px;
        flex-wrap: wrap;
    }

    .search-filter-btn {
        padding: 6px 12px;
        background: var(--medical-light-blue);
        border: 2px solid var(--medical-light-blue);
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        color: var(--medical-blue);
        cursor: pointer;
        transition: all var(--transition-fast);
        min-height: 32px;
    }

    .search-filter-btn:hover {
        background: var(--medical-blue);
        border-color: var(--medical-blue);
        color: white;
    }

    .search-filter-btn.active {
        background: var(--medical-blue);
        border-color: var(--medical-blue);
        color: white;
    }

    /* ============ CONTENT AREA ============ */
    .content-area {
        flex: 1;
        padding: 32px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        background: var(--medical-light-gray);
    }

    /* ============ QUICK ACTIONS ============ */
    .quick-actions {
        display: flex;
        gap: 12px;
        margin-bottom: 32px;
        padding: 20px;
        background: white;
        border-radius: var(--border-radius-lg);
        flex-wrap: wrap;
        border: 1px solid var(--medical-light-blue);
        box-shadow: var(--shadow-sm);
    }

    .quick-action-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 14px 20px;
        background: white;
        border: 2px solid var(--medical-light-blue);
        border-radius: var(--border-radius-md);
        cursor: pointer;
        transition: all var(--transition-fast);
        font-size: 14px;
        font-weight: 600;
        min-height: 48px;
        color: var(--medical-dark-blue);
    }

    .quick-action-btn:hover {
        border-color: var(--medical-blue);
        background: var(--medical-light-blue);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 119, 190, 0.1);
    }

    .quick-action-btn i {
        font-size: 16px;
    }

    /* ============ STATS CARDS ============ */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 24px;
        margin-bottom: 32px;
    }

    .stat-card {
        background: white;
        border-radius: var(--border-radius-lg);
        padding: 24px;
        display: flex;
        align-items: center;
        gap: 20px;
        box-shadow: var(--shadow-sm);
        transition: all var(--transition-normal) ease;
        border: 1px solid var(--medical-light-blue);
        position: relative;
        overflow: hidden;
    }

    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--medical-blue), var(--medical-teal));
    }

    .stat-card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-4px);
    }

    .stat-icon {
        width: 56px;
        height: 56px;
        border-radius: var(--border-radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: white;
        flex-shrink: 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .stat-icon.primary { background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue)); }
    .stat-icon.success { background: linear-gradient(135deg, var(--medical-green), #1b5e20); }
    .stat-icon.warning { background: linear-gradient(135deg, var(--medical-orange), #e65100); }
    .stat-icon.danger { background: linear-gradient(135deg, var(--medical-red), #b71c1c); }

    .stat-content {
        flex: 1;
    }

    .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: var(--medical-dark-blue);
        line-height: 1;
        margin-bottom: 4px;
    }

    .stat-label {
        font-size: 14px;
        color: var(--medical-gray);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* ============ EMPTY STATES ============ */
    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 64px 24px;
        text-align: center;
        color: var(--medical-gray);
    }

    .empty-state-icon {
        font-size: 56px;
        margin-bottom: 20px;
        color: var(--medical-light-blue);
        opacity: 0.5;
    }

    .empty-state-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 12px;
        color: var(--medical-dark-blue);
    }

    .empty-state-description {
        font-size: 15px;
        max-width: 400px;
        margin-bottom: 24px;
        line-height: 1.6;
    }

    /* ============ LOADING STATES ============ */
    .loading-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: inherit;
        z-index: 10;
        backdrop-filter: blur(2px);
    }

    .loading-spinner {
        width: 48px;
        height: 48px;
        border: 3px solid var(--medical-light-blue);
        border-top-color: var(--medical-blue);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    .skeleton {
        background: linear-gradient(90deg, var(--medical-light-blue) 25%, #e3f2fd 50%, var(--medical-light-blue) 75%);
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s infinite;
        border-radius: var(--border-radius-md);
    }

    @keyframes skeleton-loading {
        0% {
            background-position: 200% 0;
        }
        100% {
            background-position: -200% 0;
        }
    }

    .skeleton-text {
        height: 1em;
        margin-bottom: 0.5em;
    }

    .skeleton-circle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }

    /* ============ DATA SOURCE INDICATOR ============ */
    .data-source-indicator {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-left: 8px;
        vertical-align: middle;
    }

    .data-source-indicator.live {
        background: var(--medical-green);
        color: white;
    }

    .data-source-indicator.mock {
        background: var(--medical-orange);
        color: white;
    }

    /* ============ ALERT BANNER ============ */
    .alert-banner {
        background: linear-gradient(135deg, var(--medical-red), #b71c1c);
        color: white;
        padding: 16px 24px;
        border-radius: var(--border-radius-md);
        margin-bottom: 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 4px 12px rgba(198, 40, 40, 0.2);
        animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .alert-banner-content {
        display: flex;
        align-items: center;
        gap: 12px;
        flex: 1;
    }

    .alert-banner-icon {
        font-size: 20px;
    }

    .alert-banner-message {
        font-weight: 500;
    }

    .alert-banner-close {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        cursor: pointer;
        padding: 8px;
        border-radius: 4px;
        min-height: 36px;
        min-width: 36px;
        transition: background var(--transition-fast);
    }

    .alert-banner-close:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    /* ============ QUICK STATS SIDEBAR ============ */
    .quick-stats-sidebar {
        position: fixed;
        right: 0;
        top: 80px;
        width: 300px;
        height: calc(100vh - 80px);
        background: white;
        border-left: 1px solid var(--medical-light-blue);
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
        z-index: 90;
        overflow-y: auto;
        padding: 24px;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        -webkit-overflow-scrolling: touch;
    }

    .quick-stats-sidebar.open {
        transform: translateX(0);
    }

    .stats-toggle-btn {
        position: fixed;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
        color: white;
        border: none;
        border-radius: 8px 0 0 8px;
        padding: 16px 8px;
        cursor: pointer;
        z-index: 91;
        box-shadow: -2px 0 10px rgba(0, 119, 190, 0.3);
        min-height: 60px;
        min-width: 44px;
        transition: all var(--transition-normal);
    }

    .stats-toggle-btn:hover {
        background: linear-gradient(135deg, var(--medical-dark-blue), var(--medical-blue));
        padding-right: 12px;
    }

    .stats-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--medical-light-blue);
    }

    .stats-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--medical-dark-blue);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .stats-title i {
        font-size: 18px;
        color: var(--medical-blue);
    }

    .stats-close {
        background: var(--medical-light-blue);
        border: none;
        color: var(--medical-blue);
        cursor: pointer;
        padding: 8px;
        border-radius: 4px;
        min-height: 44px;
        min-width: 44px;
        transition: all var(--transition-fast);
    }

    .stats-close:hover {
        background: var(--medical-blue);
        color: white;
    }

    .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 0;
        border-bottom: 1px solid var(--medical-light-blue);
    }

    .stat-item:last-child {
        border-bottom: none;
    }

    .stat-label {
        font-size: 14px;
        color: var(--medical-gray);
        font-weight: 500;
    }

    .stat-value {
        font-size: 18px;
        font-weight: 700;
        color: var(--medical-dark-blue);
    }

    .stat-trend {
        font-size: 11px;
        padding: 3px 8px;
        border-radius: 10px;
        margin-left: 8px;
        font-weight: 600;
    }

    .stat-trend.positive {
        background: rgba(46, 125, 50, 0.1);
        color: var(--medical-green);
    }

    .stat-trend.negative {
        background: rgba(198, 40, 40, 0.1);
        color: var(--medical-red);
    }

    /* ============ STAFF PROFILE DESIGN ============ */
    .staff-profile-header {
        display: flex;
        align-items: center;
        gap: 24px;
        margin-bottom: 32px;
        padding-bottom: 24px;
        border-bottom: 2px solid var(--medical-light-blue);
    }

    .staff-avatar-large {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 32px;
        flex-shrink: 0;
        box-shadow: 0 8px 24px rgba(0, 119, 190, 0.3);
    }

    .staff-basic-info {
        flex: 1;
    }

    .staff-name {
        font-size: 28px;
        font-weight: 700;
        color: var(--medical-dark-blue);
        margin-bottom: 4px;
    }

    .staff-title {
        font-size: 16px;
        color: var(--medical-gray);
        margin-bottom: 12px;
        font-weight: 500;
    }

    .staff-status {
        display: inline-block;
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .staff-status.active {
        background: var(--medical-green);
        color: white;
    }

    .staff-status.inactive {
        background: var(--medical-gray);
        color: white;
    }

    .staff-stats {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 16px;
        margin-bottom: 32px;
    }

    .staff-stat-card {
        background: white;
        border-radius: var(--border-radius-md);
        padding: 20px;
        text-align: center;
        border: 1px solid var(--medical-light-blue);
        transition: all var(--transition-fast);
    }

    .staff-stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 119, 190, 0.1);
    }

    .staff-stat-value {
        font-size: 28px;
        font-weight: 700;
        color: var(--medical-blue);
        margin-bottom: 4px;
    }

    .staff-stat-label {
        font-size: 12px;
        color: var(--medical-gray);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-weight: 600;
    }

    .info-section {
        margin-bottom: 32px;
    }

    .info-section-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--medical-dark-blue);
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 2px solid var(--medical-light-blue);
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .info-section-title i {
        color: var(--medical-blue);
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }

    .info-item {
        background: var(--medical-light-blue);
        border-radius: var(--border-radius-md);
        padding: 16px;
    }

    .info-label {
        font-size: 12px;
        color: var(--medical-gray);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 4px;
        font-weight: 600;
    }

    .info-value {
        font-size: 15px;
        color: var(--medical-dark-blue);
        font-weight: 500;
    }

    .info-value.unavailable {
        color: var(--gray-500);
        font-style: italic;
    }

    /* ============ ACTION DROPDOWN ============ */
    .action-dropdown {
        position: relative;
        display: inline-block;
    }

    .action-menu {
        display: none;
        position: absolute;
        right: 0;
        top: 100%;
        background: white;
        border: 1px solid var(--gray-300);
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-lg);
        min-width: 180px;
        z-index: 1000;
        margin-top: 4px;
    }

    .action-menu.show {
        display: block;
        animation: fadeIn 0.2s ease;
    }

    .action-menu-item {
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
        transition: background-color var(--transition-fast);
        font-size: 13px;
        color: var(--gray-700);
        text-decoration: none;
        min-height: 44px;
        border-bottom: 1px solid var(--gray-100);
    }

    .action-menu-item:last-child {
        border-bottom: none;
    }

    .action-menu-item:hover {
        background-color: var(--medical-light-blue);
    }

    .action-menu-item i {
        width: 16px;
        text-align: center;
        font-size: 14px;
    }

    .action-menu-item.danger {
        color: var(--medical-red);
    }

    .action-menu-item.danger:hover {
        background-color: rgba(198, 40, 40, 0.1);
    }

    /* ============ AUDIT LOGS ============ */
    .audit-filters {
        display: flex;
        gap: 16px;
        margin-bottom: 24px;
        padding: 20px;
        background: white;
        border-radius: var(--border-radius-md);
        border: 1px solid var(--medical-light-blue);
    }

    .audit-log-item {
        padding: 16px;
        border-bottom: 1px solid var(--medical-light-blue);
        background: white;
    }

    .audit-log-item:last-child {
        border-bottom: none;
    }

    .audit-action {
        font-weight: 600;
        color: var(--medical-dark-blue);
        margin-bottom: 4px;
    }

    .audit-details {
        font-size: 13px;
        color: var(--gray-600);
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
    }

    .audit-timestamp {
        font-size: 12px;
        color: var(--gray-500);
        margin-top: 8px;
    }

    /* ============ PERMISSION MANAGER ============ */
    .permission-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 24px;
    }

    .permission-card {
        background: white;
        border-radius: var(--border-radius-md);
        padding: 20px;
        border: 1px solid var(--medical-light-blue);
    }

    .permission-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }

    .permission-role {
        font-weight: 600;
        color: var(--medical-dark-blue);
    }

    .permission-checkboxes {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    /* ============ MOBILE RESPONSIVE ============ */
    @media (max-width: 1024px) {
        .sidebar {
            transform: translateX(-100%);
        }
        
        .sidebar.mobile-open {
            transform: translateX(0);
        }
        
        .main-content {
            margin-left: 0 !important;
        }
        
        .mobile-menu-toggle {
            display: block;
        }
        
        .search-container {
            width: 200px;
        }

        .quick-stats-sidebar {
            width: 100%;
        }
        
        .modal-container {
            width: 95%;
            margin: 10px;
        }

        .training-units-grid {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 768px) {
        .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .navbar-right {
            flex-direction: column;
            align-items: flex-end;
        }
        
        .search-container {
            width: 100%;
            max-width: 200px;
        }
        
        .content-area {
            padding: 20px;
        }
        
        .quick-actions {
            justify-content: center;
        }
        
        .quick-action-btn {
            flex: 1;
            min-width: 160px;
        }

        .stat-card {
            flex-direction: column;
            text-align: center;
            gap: 16px;
        }

        .stat-icon {
            width: 64px;
            height: 64px;
            font-size: 28px;
        }

        .staff-profile-header {
            flex-direction: column;
            text-align: center;
        }

        .staff-stats {
            grid-template-columns: repeat(2, 1fr);
        }

        .staff-avatar-large {
            width: 80px;
            height: 80px;
            font-size: 24px;
        }

        .audit-filters {
            flex-direction: column;
        }

        .modal-tabs {
            flex-wrap: wrap;
        }

        .modal-tab {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 12px 16px;
        }

        .info-grid {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 480px) {
        .login-card {
            padding: 32px 20px;
        }
        
        .modal-container {
            width: 100%;
            margin: 0;
            border-radius: 0;
            max-height: 100vh;
        }
        
        .modal-overlay {
            padding: 0;
        }
        
        .top-navbar {
            padding: 12px 16px;
        }
        
        .navbar-title {
            font-size: 16px;
        }
        
        .quick-actions {
            flex-direction: column;
        }
        
        .quick-action-btn {
            width: 100%;
        }

        .staff-stats {
            grid-template-columns: 1fr;
        }

        .staff-avatar-large {
            width: 60px;
            height: 60px;
            font-size: 20px;
        }

        .modal-header {
            padding: 16px;
        }

        .modal-body {
            padding: 16px;
        }

        .modal-footer {
            padding: 16px;
        }

        .grid.grid-cols-2 {
            grid-template-columns: 1fr;
        }
    }

    /* ============ CUSTOM SCROLLBAR ============ */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: var(--medical-light-blue);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: var(--medical-blue);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: var(--medical-dark-blue);
    }
</style>
</head>
<body>
    <div id="app" v-cloak>

        <!-- ============ TOAST CONTAINER ============ -->
        <div class="toast-container">
            <div v-for="toast in toasts" :key="toast.id" 
                 :class="['toast', `toast-${toast.type}`]" role="alert" aria-live="polite" aria-atomic="true">
                <div class="toast-icon">
                    <i :class="toast.icon"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-title">{{ toast.title }}</div>
                    <div class="toast-message">{{ toast.message }}</div>
                </div>
                <button class="toast-close" @click="removeToast(toast.id)" aria-label="Close notification">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- ============ LOGIN SCREEN ============ -->
        <div v-if="!currentUser" class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="login-logo">
                        <i class="fas fa-lungs"></i>
                        <span class="login-title">NeumoCare</span>
                    </div>
                    <p class="login-subtitle">Pulmonology Department Management System</p>
                </div>
                
                <div class="form-group">
                    <label for="login-email" class="form-label">Email Address</label>
                    <input 
                        type="email" 
                        id="login-email" 
                        class="form-control" 
                        v-model="loginForm.email" 
                        placeholder="admin@neumocare.org" 
                        aria-required="true"
                        name="email"
                        autocomplete="email">
                </div>

                <div class="form-group">
                    <label for="login-password" class="form-label">Password</label>
                    <input 
                        type="password" 
                        id="login-password" 
                        class="form-control" 
                        v-model="loginForm.password" 
                        placeholder="" 
                        aria-required="true"
                        name="password"
                        autocomplete="current-password">
                </div>
                
                <div class="form-group">
                    <label class="form-check">
                        <input type="checkbox" class="form-check-input" v-model="loginForm.remember_me">
                        <span class="form-check-label">Remember me</span>
                    </label>
                </div>
                
                <button class="btn btn-primary btn-lg w-100" @click="handleLogin" :disabled="loading" aria-label="Login to NeumoCare system">
                    <span v-if="loading" class="loading"></span>
                    <span v-else><i class="fas fa-sign-in-alt"></i> Login to NeumoCare</span>
                </button>
                
                <div class="text-center mt-4 text-muted">
                    <small>Demo Credentials: admin@neumocare.org / password123</small>
                </div>
            </div>
        </div>

        <!-- ============ MAIN APPLICATION ============ -->
        <div v-else class="app-layout">
            <!-- Sidebar -->
            <aside class="sidebar" :class="{ 'sidebar-collapsed': sidebarCollapsed, 'mobile-open': mobileMenuOpen }" 
                   aria-label="Main navigation">
                <div class="sidebar-header">
                    <div class="sidebar-logo">
                        <i class="fas fa-lungs"></i>
                        <span>NeumoCare</span>
                    </div>
                    <button class="sidebar-toggle" @click="sidebarCollapsed = !sidebarCollapsed" aria-label="Toggle sidebar">
                        <i class="fas" :class="sidebarCollapsed ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
                    </button>
                </div>
                
                <nav class="sidebar-nav" aria-label="Primary navigation">
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Dashboard</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'daily_operations' }" 
                                   @click.prevent="switchView('daily_operations'); mobileMenuOpen = false"
                                   aria-label="Dashboard overview" :aria-current="currentView === 'daily_operations' ? 'page' : null">
                                    <i class="fas fa-tachometer-alt"></i>
                                    <span>Overview</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Clinical Operations</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'medical_staff' }" 
                                   @click.prevent="switchView('medical_staff'); mobileMenuOpen = false" v-if="hasPermission('medical_staff', 'read')"
                                   :aria-current="currentView === 'medical_staff' ? 'page' : null">
                                    <i class="fas fa-user-md"></i>
                                    <span>Medical Staff</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'oncall_schedule' }" 
                                   @click.prevent="switchView('oncall_schedule'); mobileMenuOpen = false" v-if="hasPermission('oncall_schedule', 'read')"
                                   :aria-current="currentView === 'oncall_schedule' ? 'page' : null">
                                    <i class="fas fa-phone-alt"></i>
                                    <span>On-call Schedule</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Training & Education</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'resident_rotations' }" 
                                   @click.prevent="switchView('resident_rotations'); mobileMenuOpen = false" v-if="hasPermission('resident_rotations', 'read')"
                                   :aria-current="currentView === 'resident_rotations' ? 'page' : null">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>Resident Rotations</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'training_units' }" 
                                   @click.prevent="switchView('training_units'); mobileMenuOpen = false" v-if="hasPermission('training_units', 'read')"
                                   :aria-current="currentView === 'training_units' ? 'page' : null">
                                    <i class="fas fa-clinic-medical"></i>
                                    <span>Training Units</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Administration</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'staff_absence' }" 
                                   @click.prevent="switchView('staff_absence'); mobileMenuOpen = false" v-if="hasPermission('staff_absence', 'read')"
                                   :aria-current="currentView === 'staff_absence' ? 'page' : null">
                                    <i class="fas fa-calendar-times"></i>
                                    <span>Staff Absence</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'department_management' }" 
                                   @click.prevent="switchView('department_management'); mobileMenuOpen = false" v-if="hasPermission('system', 'manage_departments')"
                                   :aria-current="currentView === 'department_management' ? 'page' : null">
                                    <i class="fas fa-sitemap"></i>
                                    <span>Departments</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'communications' }" 
                                   @click.prevent="switchView('communications'); mobileMenuOpen = false" v-if="hasPermission('communications', 'read')"
                                   :aria-current="currentView === 'communications' ? 'page' : null">
                                    <i class="fas fa-bullhorn"></i>
                                    <span>Communications</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" v-if="hasPermission('audit', 'read')">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'audit_logs' }" 
                                   @click.prevent="switchView('audit_logs'); mobileMenuOpen = false"
                                   :aria-current="currentView === 'audit_logs' ? 'page' : null">
                                    <i class="fas fa-history"></i>
                                    <span>Audit Logs</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" v-if="hasPermission('permissions', 'manage')">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'permission_manager' }" 
                                   @click.prevent="switchView('permission_manager'); mobileMenuOpen = false"
                                   :aria-current="currentView === 'permission_manager' ? 'page' : null">
                                    <i class="fas fa-user-shield"></i>
                                    <span>Permission Manager</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" v-if="hasPermission('system', 'read')">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'system_settings' }" 
                                   @click.prevent="switchView('system_settings'); mobileMenuOpen = false"
                                   :aria-current="currentView === 'system_settings' ? 'page' : null">
                                    <i class="fas fa-cog"></i>
                                    <span>System Settings</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
                
                <div class="sidebar-footer">
                    <div class="sidebar-user">
                        <div class="user-avatar" aria-hidden="true">{{ getInitials(currentUser.full_name) }}</div>
                        <div class="user-info">
                            <div class="user-name">{{ currentUser.full_name }}</div>
                            <div class="user-role">{{ getUserRoleDisplay(currentUser.user_role) }}</div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Quick Stats Sidebar -->
            <button class="stats-toggle-btn" @click="toggleStatsSidebar" :aria-label="statsSidebarOpen ? 'Close statistics sidebar' : 'Open statistics sidebar'">
                <i class="fas" :class="statsSidebarOpen ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
            </button>
            
            <div class="quick-stats-sidebar" :class="{ open: statsSidebarOpen }" role="complementary" aria-label="Live statistics">
                <div class="stats-header">
                    <div class="stats-title">
                        <i class="fas fa-chart-line"></i>
                        Live Statistics
                    </div>
                    <button class="stats-close" @click="statsSidebarOpen = false" aria-label="Close statistics">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Department Occupancy</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.occupancy || 0 }}%</span>
                        <span class="stat-trend" :class="liveStats.occupancyTrend > 0 ? 'positive' : 'negative'">
                            {{ liveStats.occupancyTrend > 0 ? '' : '' }}{{ Math.abs(liveStats.occupancyTrend || 0) }}%
                        </span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">On-duty Staff</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 40px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.onDutyStaff || 0 }}</span>
                        <span class="stat-trend" :class="liveStats.staffTrend > 0 ? 'positive' : 'negative'">
                            {{ liveStats.staffTrend > 0 ? '' : '' }}{{ Math.abs(liveStats.staffTrend || 0) }}
                        </span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Pending Requests</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 30px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.pendingRequests || 0 }}</span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Training Unit Capacity</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 80px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.trainingCapacity?.current || 0 }}/{{ liveStats.trainingCapacity?.max || 0 }}</span>
                        <span class="stat-trend" :class="liveStats.trainingCapacity?.status || ''">{{ liveStats.trainingCapacity?.status || 'normal' }}</span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Active Rotations</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 80px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.activeRotations || 0 }}</span>
                    </template>
                </div>
            </div>

            <!-- Main Content -->
            <main class="main-content" :class="{ 'main-content-expanded': sidebarCollapsed }">
                <!-- Top Navbar -->
                <header class="top-navbar">
                    <div class="navbar-left">
                        <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen" aria-label="Toggle mobile menu">
                            <i class="fas fa-bars"></i>
                        </button>
                        <div>
                            <span class="navbar-title">{{ getCurrentTitle() }}</span>
                            <span class="navbar-subtitle">{{ getCurrentSubtitle() }}</span>
                        </div>
                    </div>
                    
                    <div class="navbar-right">
                        <!-- Enhanced Search -->
                        <div class="search-container">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" :placeholder="getSearchPlaceholder()" 
                                       v-model="searchQuery" @keyup.enter="handleSearch"
                                       aria-label="Search">
                                <button class="search-scope" @click="toggleSearchScope" aria-label="Change search scope">
                                    {{ searchScope }} <i class="fas fa-chevron-down ml-2"></i>
                                </button>
                            </div>
                            
                            <div class="search-filters">
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'all' }" 
                                        @click="searchFilter = 'all'">All</button>
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'staff' }" 
                                        @click="searchFilter = 'staff'">Staff</button>
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'rotations' }" 
                                        @click="searchFilter = 'rotations'">Rotations</button>
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'units' }" 
                                        @click="searchFilter = 'units'">Units</button>
                            </div>
                        </div>
                        
                        <div class="navbar-actions" style="display: flex; align-items: center; gap: 12px;">
                            <div class="notification-badge">
                                <button class="btn btn-icon btn-secondary" @click="showNotifications" 
                                        :aria-label="`${unreadNotifications} unread notifications`">
                                    <i class="fas fa-bell"></i>
                                    <span class="badge badge-danger" v-if="unreadNotifications > 0" style="position: absolute; top: -8px; right: -8px; min-width: 20px; height: 20px; padding: 2px 6px; font-size: 10px;">
                                        {{ unreadNotifications }}
                                    </span>
                                </button>
                            </div>
                            
                            <button class="btn btn-icon btn-secondary" @click="showCommunicationsModal" 
                                    v-if="hasPermission('communications', 'create')" aria-label="Communications">
                                <i class="fas fa-bullhorn"></i>
                            </button>
                            
                            <div class="user-menu" style="position: relative;">
                                <button class="user-menu-toggle" @click="toggleUserMenu" :aria-label="`${currentUser.full_name} profile menu`" style="display: flex; align-items: center; gap: 8px; background: none; border: none; cursor: pointer; padding: 8px; border-radius: var(--border-radius-md); transition: background var(--transition-fast); min-height: 44px;">
                                    <div class="user-avatar">{{ getInitials(currentUser.full_name) }}</div>
                                    <i class="fas fa-chevron-down" style="font-size: 12px;"></i>
                                </button>
                                
                                <div class="action-menu" v-if="userMenuOpen" style="position: absolute; right: 0; top: 100%; margin-top: 8px; min-width: 200px;">
                                    <div class="action-menu-item" @click="showUserProfile">
                                        <i class="fas fa-user"></i>
                                        <span>Profile Settings</span>
                                    </div>
                                    <div class="action-menu-item" @click="showSystemSettingsModal" v-if="hasPermission('system', 'read')">
                                        <i class="fas fa-cog"></i>
                                        <span>System Settings</span>
                                    </div>
                                    <div class="action-menu-item danger" @click="handleLogout">
                                        <i class="fas fa-sign-out-alt"></i>
                                        <span>Logout</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Content Area -->
                <div class="content-area">
                    <!-- Dynamic Alert Banner -->
                    <div v-if="activeAlerts.length > 0" class="alert-banner">
                        <div class="alert-banner-content">
                            <i class="fas fa-exclamation-triangle alert-banner-icon"></i>
                            <span class="alert-banner-message">
                                {{ activeAlerts[0].message }}
                                <span v-if="activeAlerts.length > 1"> (and {{ activeAlerts.length - 1 }} more)</span>
                            </span>
                        </div>
                        <button class="alert-banner-close" @click="dismissAlert(activeAlerts[0].id)" aria-label="Dismiss alert">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Breadcrumb Navigation -->
                    <nav class="breadcrumb" style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px; padding: 12px 0; border-bottom: 2px solid var(--medical-light-blue); flex-wrap: wrap;" aria-label="Breadcrumb">
                        <div class="breadcrumb-item" @click="switchView('daily_operations')" style="cursor: pointer; display: flex; align-items: center; gap: 8px; color: var(--medical-gray); font-size: 14px; transition: color var(--transition-fast); text-decoration: none; padding: 4px 8px; border-radius: 4px;">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </div>
                        <div class="breadcrumb-separator" style="color: var(--gray-400);">/</div>
                        <div class="breadcrumb-item active" style="display: flex; align-items: center; gap: 8px; color: var(--medical-blue); font-size: 14px; font-weight: 500; padding: 4px 8px;" aria-current="page">
                            {{ getCurrentTitle() }}
                        </div>
                    </nav>

                    <!-- Daily Operations View -->
                    <div v-if="currentView === 'daily_operations'">
                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <div class="quick-action-btn" @click="showAddMedicalStaffModal" v-if="hasPermission('medical_staff', 'create')">
                                <i class="fas fa-user-plus" style="color: var(--medical-green);"></i>
                                Add Medical Staff
                            </div>
                            <div class="quick-action-btn" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                <i class="fas fa-phone-alt" style="color: var(--medical-blue);"></i>
                                Schedule On-call
                            </div>
                            <div class="quick-action-btn" @click="showAddAbsenceModal" v-if="hasPermission('staff_absence', 'create')">
                                <i class="fas fa-calendar-times" style="color: var(--medical-orange);"></i>
                                Document Absence
                            </div>
                            <div class="quick-action-btn" @click="showQuickPlacementModal" v-if="hasPermission('placements', 'create')">
                                <i class="fas fa-user-md" style="color: var(--medical-teal);"></i>
                                Quick Placement
                            </div>
                            <div class="quick-action-btn" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                <i class="fas fa-calendar-alt" style="color: var(--medical-blue);"></i>
                                Add Rotation
                            </div>
                            <div class="quick-action-btn" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                <i class="fas fa-bullhorn" style="color: var(--medical-red);"></i>
                                Post Announcement
                            </div>
                        </div>

                        <!-- Stats Overview -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon primary">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.totalStaff || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Total Medical Staff</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon success">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.activeRotations || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Active Rotations</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon warning">
                                    <i class="fas fa-clinic-medical"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.occupiedUnits || 0 }}/{{ stats.totalUnits || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Training Units</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon danger">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.pendingAlerts || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Pending Alerts</div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Announcements -->
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-bullhorn"></i>
                                    Recent Announcements
                                </div>
                                <button class="btn btn-sm btn-primary" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                    <i class="fas fa-plus"></i> New Announcement
                                </button>
                            </div>
                            <div class="card-content">
                                <div v-if="loadingAnnouncements" class="loading-overlay">
                                    <div class="loading-spinner"></div>
                                </div>
                                <div v-else-if="recentAnnouncements.length === 0" class="empty-state">
                                    <i class="fas fa-bullhorn empty-state-icon"></i>
                                    <div class="empty-state-title">No Announcements</div>
                                    <div class="empty-state-description">
                                        No announcements have been posted yet.
                                    </div>
                                    <button class="btn btn-primary mt-4" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                        <i class="fas fa-plus"></i> Create Announcement
                                    </button>
                                </div>
                                <div v-else>
                                    <div v-for="announcement in recentAnnouncements.slice(0, 3)" :key="announcement.id" style="margin-bottom: 16px; padding: 16px; border: 1px solid var(--medical-light-blue); border-radius: var(--border-radius-md); transition: all var(--transition-fast);" @mouseenter="this.style.backgroundColor='var(--medical-light-blue)'" @mouseleave="this.style.backgroundColor='white'">
                                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                                            <div>
                                                <div style="font-weight: 600; color: var(--medical-dark-blue);">{{ announcement.title }}</div>
                                                <div style="font-size: 12px; color: var(--medical-gray);">By: {{ announcement.author }}  {{ formatTimeAgo(announcement.created_at) }}</div>
                                            </div>
                                            <span class="badge" :class="`badge-${announcement.priority}`">
                                                {{ announcement.priority }}
                                            </span>
                                        </div>
                                        <p style="color: var(--gray-700); margin-bottom: 12px;">{{ announcement.content }}</p>
                                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: var(--gray-500);">
                                            <span>Expires: {{ announcement.expires_at ? formatDateTime(announcement.expires_at) : 'Never' }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Today's On-call Schedule -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-phone-alt"></i>
                                    Today's On-call Schedule
                                </div>
                                <button class="btn btn-sm btn-primary" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                    <i class="fas fa-plus"></i> Add Schedule
                                </button>
                            </div>
                            <div class="card-content">
                                <div v-if="loadingSchedule" class="loading-overlay">
                                    <div class="loading-spinner"></div>
                                </div>
                                <div v-else-if="todaysOnCall.length === 0" class="empty-state">
                                    <i class="fas fa-phone-slash empty-state-icon"></i>
                                    <div class="empty-state-title">No On-call Scheduled</div>
                                    <div class="empty-state-description">
                                        No physicians are scheduled for on-call duty today
                                    </div>
                                    <button class="btn btn-primary mt-4" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                        <i class="fas fa-plus"></i> Schedule On-call
                                    </button>
                                </div>
                                <div v-else class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Physician</th>
                                                <th>Shift Time</th>
                                                <th>Role</th>
                                                <th>Contact</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="schedule in todaysOnCall" :key="schedule.id">
                                                <td>{{ schedule.physician_name }}</td>
                                                <td>{{ formatTimeRange(schedule.start_time, schedule.end_time) }}</td>
                                                <td>
                                                    <span class="badge badge-primary">{{ schedule.shift_type }}</span>
                                                </td>
                                                <td>{{ schedule.contact_number || 'N/A' }}</td>
                                                <td>
                                                    <div class="action-dropdown">
                                                        <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Schedule actions">
                                                            <i class="fas fa-ellipsis-v"></i>
                                                        </button>
                                                        <div class="action-menu">
                                                            <div class="action-menu-item" @click="editOnCallSchedule(schedule)" v-if="hasPermission('oncall_schedule', 'update')">
                                                                <i class="fas fa-edit"></i>
                                                                <span>Edit</span>
                                                            </div>
                                                            <div class="action-menu-item danger" @click="deleteOnCallSchedule(schedule.id)" v-if="hasPermission('oncall_schedule', 'delete')">
                                                                <i class="fas fa-trash"></i>
                                                                <span>Delete</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Medical Staff View -->
                    <div v-if="currentView === 'medical_staff'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Medical Staff Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage all medical staff with comprehensive profiles</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddMedicalStaffModal" 
                                    v-if="hasPermission('medical_staff', 'create')">
                                <i class="fas fa-plus"></i> Add Medical Staff
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight: 500;">Search</div>
                                <input type="text" class="form-control form-control-sm" v-model="staffSearch" placeholder="Name, ID, or email...">
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Staff Type</div>
                                <select class="form-select form-select-sm" v-model="staffFilter.staff_type">
                                    <option value="">All Types</option>
                                    <option value="medical_resident">Medical Resident</option>
                                    <option value="attending_physician">Attending Physician</option>
                                    <option value="fellow">Fellow</option>
                                    <option value="nurse_practitioner">Nurse Practitioner</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Status</div>
                                <select class="form-select form-select-sm" v-model="staffFilter.employment_status">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="on_leave">On Leave</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetStaffFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyStaffFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Staff Table -->
                        <div class="card">
                            <div v-if="loadingStaff" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredMedicalStaff.length === 0" class="empty-state">
                                <i class="fas fa-user-md empty-state-icon"></i>
                                <div class="empty-state-title">No Medical Staff Found</div>
                                <div class="empty-state-description">
                                    Try adjusting your filters or add new medical staff to get started.
                                </div>
                                <button class="btn btn-primary mt-4" @click="showAddMedicalStaffModal" v-if="hasPermission('medical_staff', 'create')">
                                    <i class="fas fa-plus"></i> Add Medical Staff
                                </button>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Staff Type</th>
                                            <th>Staff ID</th>
                                            <th>Department</th>
                                            <th>Status</th>
                                            <th>Last Active</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="staff in filteredMedicalStaff" :key="staff.id">
                                            <td style="cursor: pointer;" @click="viewStaffDetails(staff)">
                                                <div class="flex items-center gap-3" style="display: flex; align-items: center; gap: 12px;">
                                                    <div class="user-avatar" aria-hidden="true">{{ getInitials(staff.full_name) }}</div>
                                                    <div>
                                                        <div class="font-medium" style="font-weight: 500; color: var(--medical-dark-blue);">{{ staff.full_name }}</div>
                                                        <div class="text-sm text-gray-500">{{ staff.professional_email }}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="badge" :class="getStaffTypeClass(staff.staff_type)">
                                                    {{ formatStaffType(staff.staff_type) }}
                                                </span>
                                            </td>
                                            <td>{{ staff.staff_id }}</td>
                                            <td>{{ getDepartmentName(staff.department_id) || 'Unassigned' }}</td>
                                            <td>
                                                <span class="badge" :class="staff.employment_status === 'active' ? 'status-available' : staff.employment_status === 'on_leave' ? 'status-busy' : 'status-critical'">
                                                    {{ formatEmploymentStatus(staff.employment_status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <span class="updated-timestamp" style="font-size: 12px; color: var(--medical-gray); display: flex; align-items: center; gap: 4px;">
                                                    <i class="fas fa-clock"></i> {{ formatTimeAgo(staff.last_activity) }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Staff actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="viewStaffDetails(staff)">
                                                            <i class="fas fa-eye"></i>
                                                            <span>View Profile</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="editMedicalStaff(staff)" v-if="hasPermission('medical_staff', 'update')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="assignRotationToStaff(staff)" v-if="hasPermission('resident_rotations', 'create') && staff.staff_type === 'medical_resident'">
                                                            <i class="fas fa-calendar-alt"></i>
                                                            <span>Assign Rotation</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteMedicalStaff(staff.id)" v-if="hasPermission('medical_staff', 'delete')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Department Management View -->
                    <div v-if="currentView === 'department_management'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Department Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage departments with integrated clinical units</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddDepartmentModal" 
                                    v-if="hasPermission('system', 'manage_departments')">
                                <i class="fas fa-plus"></i> Add Department
                            </button>
                        </div>

                        <!-- Departments Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; margin-bottom: 32px;">
                            <div v-for="department in departments" :key="department.id" class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-hospital"></i>
                                        {{ department.name }}
                                    </div>
                                    <span class="badge" :class="department.status === 'active' ? 'status-available' : 'status-busy'">
                                        {{ department.status }}
                                    </span>
                                </div>
                                
                                <div class="mb-4">
                                    <div class="text-sm text-gray-600 mb-2">Department Code: {{ department.code }}</div>
                                    <div class="text-sm text-gray-600 mb-4">{{ department.description || 'No description available' }}</div>
                                    
                                    <div class="mt-3">
                                        <div class="text-sm font-medium mb-2">Clinical Units:</div>
                                        <div class="flex flex-wrap gap-2">
                                            <span v-for="unit in getDepartmentUnits(department.id)" :key="unit.id" 
                                                  style="background: var(--medical-light-blue); color: var(--medical-blue); font-size: 12px; padding: 4px 12px; border-radius: 20px;">
                                                {{ unit.name }} ({{ unit.code }})
                                            </span>
                                            <span v-if="getDepartmentUnits(department.id).length === 0" class="text-gray-500 text-sm">
                                                No units assigned
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex gap-2" style="display: flex; gap: 8px;">
                                    <button class="btn btn-sm btn-primary flex-1" @click="editDepartment(department)"
                                            v-if="hasPermission('system', 'manage_departments')">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <div class="action-dropdown">
                                        <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Department actions">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                        <div class="action-menu">
                                            <div class="action-menu-item" @click="viewDepartmentDetails(department)">
                                                <i class="fas fa-eye"></i>
                                                <span>View Details</span>
                                            </div>
                                            <div class="action-menu-item danger" @click="deleteDepartment(department.id)" v-if="hasPermission('system', 'manage_departments')">
                                                <i class="fas fa-trash"></i>
                                                <span>Delete</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Training Units View -->
                    <div v-if="currentView === 'training_units'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Training Units Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage clinical training units and resident assignments</p>
                            </div>
                            <div class="flex gap-2" style="display: flex; gap: 8px;">
                                <button class="btn btn-primary" @click="showAddTrainingUnitModal" v-if="hasPermission('training_units', 'create')">
                                    <i class="fas fa-plus"></i> Add Training Unit
                                </button>
                                <button class="btn btn-success" @click="showQuickPlacementModal" v-if="hasPermission('placements', 'create')">
                                    <i class="fas fa-user-plus"></i> Quick Placement
                                </button>
                            </div>
                        </div>

                        <!-- Training Units Grid -->
                        <div class="training-units-grid">
                            <div v-for="unit in trainingUnits" :key="unit.id" class="training-unit-card">
                                <div class="training-unit-header">
                                    <div>
                                        <div class="training-unit-title">{{ unit.unit_name }}</div>
                                        <div class="training-unit-capacity">{{ unit.current_residents || 0 }}/{{ unit.maximum_residents }} residents</div>
                                        <div class="text-sm text-gray-600 mt-1">{{ unit.unit_code }}  {{ getDepartmentName(unit.department_id) }}</div>
                                    </div>
                                    <span class="badge" :class="unit.unit_status === 'active' ? 'status-available' : 'status-busy'">
                                        {{ unit.unit_status }}
                                    </span>
                                </div>
                                
                                <div class="text-sm text-gray-600 mb-4">{{ unit.unit_description || 'No description available' }}</div>
                                
                                <div v-if="unit.specialty" class="mb-3">
                                    <span class="badge badge-info">{{ unit.specialty }}</span>
                                </div>
                                
                                <div class="training-unit-residents">
                                    <div class="text-sm font-medium mb-2">Assigned Residents:</div>
                                    <div v-if="getUnitResidents(unit.id).length === 0" class="text-sm text-gray-500 italic">
                                        No residents assigned
                                    </div>
                                    <div v-else>
                                        <div v-for="resident in getUnitResidents(unit.id)" :key="resident.id" class="resident-item">
                                            <div>
                                                <div class="resident-name">{{ resident.full_name }}</div>
                                                <div class="resident-level">{{ formatResidentCategory(resident.resident_category) }}</div>
                                            </div>
                                            <button class="btn btn-sm btn-outline-danger" @click="removeResidentFromUnit(resident.id, unit.id)" v-if="hasPermission('training_units', 'update')">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex gap-2 mt-4">
                                    <button class="btn btn-sm btn-primary flex-1" @click="editTrainingUnit(unit)" v-if="hasPermission('training_units', 'update')">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm btn-secondary" @click="showQuickPlacementModalForUnit(unit)" v-if="hasPermission('placements', 'create')">
                                        <i class="fas fa-user-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Resident Rotations View -->
                    <div v-if="currentView === 'resident_rotations'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Resident Rotations</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage resident rotations and assignments</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                <i class="fas fa-plus"></i> Add Rotation
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Resident</div>
                                <select class="form-select form-select-sm" v-model="rotationFilter.resident_id">
                                    <option value="">All Residents</option>
                                    <option v-for="resident in availableResidents" :key="resident.id" :value="resident.id">
                                        {{ resident.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Status</div>
                                <select class="form-select form-select-sm" v-model="rotationFilter.status">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Training Unit</div>
                                <select class="form-select form-select-sm" v-model="rotationFilter.training_unit_id">
                                    <option value="">All Units</option>
                                    <option v-for="unit in trainingUnits" :key="unit.id" :value="unit.id">
                                        {{ unit.unit_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetRotationFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyRotationFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Rotations Table -->
                        <div class="card">
                            <div v-if="loadingRotations" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredRotations.length === 0" class="empty-state">
                                <i class="fas fa-calendar-alt empty-state-icon"></i>
                                <div class="empty-state-title">No Rotations Found</div>
                                <div class="empty-state-description">
                                    Try adjusting your filters or add new rotations to get started.
                                </div>
                                <button class="btn btn-primary mt-4" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                    <i class="fas fa-plus"></i> Add Rotation
                                </button>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Rotation ID</th>
                                            <th>Resident</th>
                                            <th>Training Unit</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Category</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="rotation in filteredRotations" :key="rotation.id">
                                            <td>{{ rotation.rotation_id }}</td>
                                            <td>{{ getResidentName(rotation.resident_id) }}</td>
                                            <td>{{ getTrainingUnitName(rotation.training_unit_id) }}</td>
                                            <td>{{ formatDate(rotation.rotation_start_date) }}</td>
                                            <td>{{ formatDate(rotation.rotation_end_date) }}</td>
                                            <td>
                                                <span class="badge" :class="getRotationStatusClass(rotation.rotation_status)">
                                                    {{ formatRotationStatus(rotation.rotation_status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <span class="badge badge-info">{{ formatRotationCategory(rotation.rotation_category) }}</span>
                                            </td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Rotation actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="viewRotationDetails(rotation)">
                                                            <i class="fas fa-eye"></i>
                                                            <span>View Details</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="editRotation(rotation)" v-if="hasPermission('resident_rotations', 'update')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteRotation(rotation.id)" v-if="hasPermission('resident_rotations', 'delete')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- On-call Schedule View -->
                    <div v-if="currentView === 'oncall_schedule'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">On-call Schedule Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage physician on-call schedules and coverage</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                <i class="fas fa-plus"></i> Schedule On-call
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Date</div>
                                <input type="date" class="form-control form-control-sm" v-model="oncallFilter.date">
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Shift Type</div>
                                <select class="form-select form-select-sm" v-model="oncallFilter.shift_type">
                                    <option value="">All Types</option>
                                    <option value="primary_call">Primary Call</option>
                                    <option value="backup_call">Backup Call</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Physician</div>
                                <select class="form-select form-select-sm" v-model="oncallFilter.physician_id">
                                    <option value="">All Physicians</option>
                                    <option v-for="physician in availablePhysicians" :key="physician.id" :value="physician.id">
                                        {{ physician.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetOncallFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyOncallFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Schedule Table -->
                        <div class="card">
                            <div v-if="loadingOncall" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredOncall.length === 0" class="empty-state">
                                <i class="fas fa-phone-alt empty-state-icon"></i>
                                <div class="empty-state-title">No On-call Schedules Found</div>
                                <div class="empty-state-description">
                                    Try adjusting your filters or add new schedules to get started.
                                </div>
                                <button class="btn btn-primary mt-4" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                    <i class="fas fa-plus"></i> Schedule On-call
                                </button>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Primary Physician</th>
                                            <th>Backup Physician</th>
                                            <th>Shift Time</th>
                                            <th>Shift Type</th>
                                            <th>Coverage Area</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="schedule in filteredOncall" :key="schedule.id">
                                            <td>{{ formatDate(schedule.duty_date) }}</td>
                                            <td>{{ getPhysicianName(schedule.primary_physician_id) }}</td>
                                            <td>{{ schedule.backup_physician_id ? getPhysicianName(schedule.backup_physician_id) : 'No backup' }}</td>
                                            <td>{{ schedule.start_time }} - {{ schedule.end_time }}</td>
                                            <td>
                                                <span class="badge" :class="schedule.shift_type === 'primary_call' ? 'badge-primary' : 'badge-info'">
                                                    {{ formatShiftType(schedule.shift_type) }}
                                                </span>
                                            </td>
                                            <td>{{ schedule.coverage_area }}</td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Schedule actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="viewOncallDetails(schedule)">
                                                            <i class="fas fa-eye"></i>
                                                            <span>View Details</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="editOnCallSchedule(schedule)" v-if="hasPermission('oncall_schedule', 'update')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteOnCallSchedule(schedule.id)" v-if="hasPermission('oncall_schedule', 'delete')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Staff Absence View -->
                    <div v-if="currentView === 'staff_absence'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Staff Absence Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Track and manage staff absences and coverage</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddAbsenceModal" v-if="hasPermission('staff_absence', 'create')">
                                <i class="fas fa-plus"></i> Document Absence
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Staff Member</div>
                                <select class="form-select form-select-sm" v-model="absenceFilter.staff_id">
                                    <option value="">All Staff</option>
                                    <option v-for="staff in medicalStaff" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Status</div>
                                <select class="form-select form-select-sm" v-model="absenceFilter.status">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Date Range</div>
                                <input type="date" class="form-control form-control-sm" v-model="absenceFilter.start_date">
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetAbsenceFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyAbsenceFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Absence Table -->
                        <div class="card mb-6">
                            <div v-if="loadingAbsences" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredAbsences.length === 0" class="empty-state">
                                <i class="fas fa-calendar-times empty-state-icon"></i>
                                <div class="empty-state-title">No Absences Found</div>
                                <div class="empty-state-description">
                                    No staff absences have been documented yet.
                                </div>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Staff Member</th>
                                            <th>Absence Reason</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Duration</th>
                                            <th>Coverage</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="absence in filteredAbsences" :key="absence.id">
                                            <td>{{ getStaffName(absence.staff_member_id) }}</td>
                                            <td>{{ formatAbsenceReason(absence.absence_reason) }}</td>
                                            <td>{{ formatDate(absence.start_date) }}</td>
                                            <td>{{ formatDate(absence.end_date) }}</td>
                                            <td>{{ calculateAbsenceDuration(absence.start_date, absence.end_date) }} days</td>
                                            <td>{{ getStaffName(absence.replacement_staff_id) || 'No coverage' }}</td>
                                            <td>
                                                <span class="badge" :class="getAbsenceStatusClass(absence.status)">
                                                    {{ formatAbsenceStatus(absence.status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Absence actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="viewAbsenceDetails(absence)">
                                                            <i class="fas fa-eye"></i>
                                                            <span>View Details</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="editAbsence(absence)" v-if="hasPermission('staff_absence', 'update')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="assignCoverage(absence)" v-if="hasPermission('staff_absence', 'update') && !absence.replacement_staff_id">
                                                            <i class="fas fa-user-md"></i>
                                                            <span>Assign Coverage</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteAbsence(absence.id)" v-if="hasPermission('staff_absence', 'delete')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Communications View -->
                    <div v-if="currentView === 'communications'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Department Communications</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Announcements, capacity planning, and quick updates</p>
                            </div>
                            <button class="btn btn-primary" @click="showCommunicationsModal" 
                                    v-if="hasPermission('communications', 'create')">
                                <i class="fas fa-plus"></i> New Communication
                            </button>
                        </div>

                        <!-- Communications Feed -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6" style="display: grid; grid-template-columns: 1fr; gap: 24px;">
                            <div class="lg:col-span-2">
                                <div class="card mb-6">
                                    <div class="card-header">
                                        <div class="card-title">
                                            <i class="fas fa-bullhorn"></i>
                                            Recent Announcements
                                        </div>
                                    </div>
                                    <div class="activity-feed" style="background: white; border-radius: var(--border-radius-lg); padding: 24px;">
                                        <div v-for="announcement in recentAnnouncements" :key="announcement.id" style="display: flex; gap: 16px; padding: 16px 0; border-bottom: 1px solid var(--medical-light-blue);">
                                            <div :class="`bg-${getPriorityColor(announcement.priority_level)}`" style="width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 14px; flex-shrink: 0;">
                                                <i class="fas fa-bullhorn"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div style="font-weight: 600; margin-bottom: 4px;">{{ announcement.announcement_title }}</div>
                                                <div style="font-size: 14px; color: var(--gray-800); margin-bottom: 4px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">{{ announcement.announcement_content }}</div>
                                                <div style="font-size: 12px; color: var(--gray-500);">
                                                    {{ formatDateTime(announcement.publish_start_date) }}  
                                                    <span class="badge badge-sm" :class="`badge-${getPriorityColor(announcement.priority_level)}`">
                                                        {{ announcement.priority_level }}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Audit Logs View -->
                    <div v-if="currentView === 'audit_logs'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Audit Logs</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">System activity and user action tracking</p>
                            </div>
                            <button class="btn btn-primary" @click="exportAuditLogs" v-if="hasPermission('audit', 'export')">
                                <i class="fas fa-download"></i> Export Logs
                            </button>
                        </div>

                        <!-- Audit Filters -->
                        <div class="audit-filters">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Date Range</div>
                                <input type="date" class="form-control form-control-sm" v-model="auditFilters.dateRange">
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Action Type</div>
                                <select class="form-select form-select-sm" v-model="auditFilters.actionType">
                                    <option value="">All Actions</option>
                                    <option value="create">Create</option>
                                    <option value="update">Update</option>
                                    <option value="delete">Delete</option>
                                    <option value="login">Login</option>
                                    <option value="logout">Logout</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">User</div>
                                <select class="form-select form-select-sm" v-model="auditFilters.userId">
                                    <option value="">All Users</option>
                                    <option v-for="user in users" :key="user.id" :value="user.id">
                                        {{ user.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; align-items: flex-end;">
                                <button class="btn btn-sm btn-secondary" @click="resetAuditFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyAuditFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Audit Logs List -->
                        <div class="card">
                            <div v-if="loadingAuditLogs" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredAuditLogs.length === 0" class="empty-state">
                                <i class="fas fa-history empty-state-icon"></i>
                                <div class="empty-state-title">No Audit Logs Found</div>
                                <div class="empty-state-description">
                                    No audit logs match your filter criteria.
                                </div>
                            </div>
                            <div v-else>
                                <div v-for="log in filteredAuditLogs" :key="log.id" class="audit-log-item">
                                    <div class="audit-action">{{ formatAuditAction(log.action) }}</div>
                                    <div class="audit-details">
                                        <span>User: {{ getUserName(log.user_id) }}</span>
                                        <span>Module: {{ log.module }}</span>
                                        <span>IP: {{ log.ip_address }}</span>
                                    </div>
                                    <div class="audit-timestamp">
                                        <i class="fas fa-clock"></i> {{ formatDateTime(log.created_at) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Permission Manager View -->
                    <div v-if="currentView === 'permission_manager'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Permission Manager</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage user permissions and access controls</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddRoleModal" v-if="hasPermission('permissions', 'manage')">
                                <i class="fas fa-plus"></i> Add Role
                            </button>
                        </div>

                        <!-- Permission Grid -->
                        <div class="permission-grid">
                            <div v-for="role in userRoles" :key="role.id" class="permission-card">
                                <div class="permission-header">
                                    <div class="permission-role">{{ role.name }}</div>
                                    <div class="flex gap-2">
                                        <button class="btn btn-sm btn-primary" @click="editRole(role)" v-if="hasPermission('permissions', 'manage')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-danger" @click="deleteRole(role.id)" v-if="hasPermission('permissions', 'manage') && role.name !== 'Administrator'">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="permission-checkboxes">
                                    <div v-for="permission in availablePermissions" :key="permission.id" class="form-check">
                                        <input type="checkbox" class="form-check-input" 
                                               :checked="roleHasPermission(role.id, permission.id)"
                                               @change="toggleRolePermission(role.id, permission.id)"
                                               :id="`role-${role.id}-permission-${permission.id}`">
                                        <label class="form-check-label" :for="`role-${role.id}-permission-${permission.id}`">
                                            {{ formatPermissionName(permission.name) }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- User Permissions Table -->
                        <div class="card mt-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-users"></i>
                                    User Permissions
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Role</th>
                                            <th>Permissions</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="user in users" :key="user.id">
                                            <td>{{ user.full_name }}</td>
                                            <td>{{ user.user_role }}</td>
                                            <td>
                                                <span class="badge badge-sm" v-for="permission in getUserPermissions(user.id)" :key="permission">
                                                    {{ permission }}
                                                </span>
                                            </td>
                                            <td>
                                                <button class="btn btn-sm btn-primary" @click="editUserPermissions(user)" v-if="hasPermission('permissions', 'manage')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- System Settings View -->
                    <div v-if="currentView === 'system_settings'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">System Settings</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Configure system preferences and behavior</p>
                            </div>
                            <button class="btn btn-primary" @click="saveSystemSettings">
                                <i class="fas fa-save"></i> Save Settings
                            </button>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="modal-section">
                                    <div class="modal-section-title">
                                        <i class="fas fa-hospital"></i>
                                        Hospital Information
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="form-group">
                                            <label class="form-label">Hospital Name</label>
                                            <input type="text" class="form-control" v-model="systemSettings.hospital_name">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Default Department</label>
                                            <select class="form-select" v-model="systemSettings.default_department_id">
                                                <option value="">Select Default Department</option>
                                                <option v-for="department in departments" :key="department.id" :value="department.id">
                                                    {{ department.name }}
                                                </option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Max Residents per Training Unit</label>
                                            <input type="number" class="form-control" v-model="systemSettings.max_residents_per_unit" min="1" max="50">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Default Rotation Duration (weeks)</label>
                                            <input type="number" class="form-control" v-model="systemSettings.default_rotation_duration" min="1" max="52">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="modal-section">
                                    <div class="modal-section-title">
                                        <i class="fas fa-shield-alt"></i>
                                        Security Settings
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.enable_audit_logging">
                                            <span class="form-check-label">Enable Audit Logging</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.require_mfa">
                                            <span class="form-check-label">Require MFA Authentication</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.maintenance_mode">
                                            <span class="form-check-label">Maintenance Mode</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="modal-section">
                                    <div class="modal-section-title">
                                        <i class="fas fa-bell"></i>
                                        Notification Settings
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.notifications_enabled">
                                            <span class="form-check-label">Enable Email Notifications</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.absence_notifications">
                                            <span class="form-check-label">Staff Absence Notifications</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.announcement_notifications">
                                            <span class="form-check-label">Announcement Notifications</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- ============ MODALS ============ -->
            
            <!-- MODAL 1: Staff Details Modal -->
            <div v-if="staffDetailsModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="staff-details-title">
                <div class="modal-container modal-xwide">
                    <div class="modal-header">
                        <div class="modal-title" id="staff-details-title">
                            <i class="fas fa-user-md"></i>
                            Staff Profile
                        </div>
                        <button class="modal-close" @click="staffDetailsModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="staff-profile-header">
                            <div class="staff-avatar-large" aria-hidden="true">{{ getInitials(staffDetailsModal.staff.full_name) }}</div>
                            <div class="staff-basic-info">
                                <div class="staff-name">{{ staffDetailsModal.staff.full_name }}</div>
                                <div class="staff-title">{{ formatStaffType(staffDetailsModal.staff.staff_type) }}</div>
                                <span class="staff-status" :class="staffDetailsModal.staff.employment_status">
                                    {{ formatEmploymentStatus(staffDetailsModal.staff.employment_status) }}
                                </span>
                            </div>
                        </div>

                        <div class="staff-stats">
                            <div class="staff-stat-card">
                                <div class="staff-stat-value">{{ staffDetailsModal.stats.completedRotations || 0 }}</div>
                                <div class="staff-stat-label">Completed Rotations</div>
                            </div>
                            <div class="staff-stat-card">
                                <div class="staff-stat-value">{{ staffDetailsModal.stats.oncallShifts || 0 }}</div>
                                <div class="staff-stat-label">On-call Shifts</div>
                            </div>
                            <div class="staff-stat-card">
                                <div class="staff-stat-value">{{ staffDetailsModal.stats.absenceDays || 0 }}</div>
                                <div class="staff-stat-label">Absence Days</div>
                            </div>
                            <div class="staff-stat-card">
                                <div class="staff-stat-value">{{ staffDetailsModal.stats.supervisionCount || 0 }}</div>
                                <div class="staff-stat-label">Residents Supervised</div>
                            </div>
                        </div>

                        <div class="modal-tabs" role="tablist">
                            <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'personal' }" 
                                    @click="staffDetailsModal.activeTab = 'personal'" role="tab" aria-selected="staffDetailsModal.activeTab === 'personal'">
                                <i class="fas fa-user"></i> Personal Info
                            </button>
                            <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'professional' }" 
                                    @click="staffDetailsModal.activeTab = 'professional'" role="tab" aria-selected="staffDetailsModal.activeTab === 'professional'">
                                <i class="fas fa-briefcase"></i> Professional Info
                            </button>
                            <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'contact' }" 
                                    @click="staffDetailsModal.activeTab = 'contact'" role="tab" aria-selected="staffDetailsModal.activeTab === 'contact'">
                                <i class="fas fa-address-book"></i> Contact & Schedule
                            </button>
                        </div>

                        <!-- Personal Info Tab -->
                        <div v-if="staffDetailsModal.activeTab === 'personal'" class="modal-tab-content active" role="tabpanel">
                            <div class="info-section">
                                <div class="info-section-title">
                                    <i class="fas fa-id-card"></i>
                                    Personal Information
                                </div>
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">Date of Birth</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.date_of_birth ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.date_of_birth || 'Information unavailable' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Medical License</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.medical_license ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.medical_license || 'Information unavailable' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Years of Experience</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.years_experience ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.years_experience || 'Information unavailable' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Biography</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.biography ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.biography || 'No biography available' }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Professional Info Tab -->
                        <div v-if="staffDetailsModal.activeTab === 'professional'" class="modal-tab-content active" role="tabpanel">
                            <div class="info-section">
                                <div class="info-section-title">
                                    <i class="fas fa-graduation-cap"></i>
                                    Professional Information
                                </div>
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">Staff ID</div>
                                        <div class="info-value">{{ staffDetailsModal.staff.staff_id }}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Professional Email</div>
                                        <div class="info-value">{{ staffDetailsModal.staff.professional_email }}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Department</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.department_id ? '' : 'unavailable'">
                                            {{ getDepartmentName(staffDetailsModal.staff.department_id) || 'Department information unavailable' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Specialization</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.specialization ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.specialization || 'Specialization information unavailable' }}
                                        </div>
                                    </div>
                                    <div v-if="staffDetailsModal.staff.staff_type === 'medical_resident'" class="info-item">
                                        <div class="info-label">Resident Category</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.resident_category ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.resident_category ? formatResidentCategory(staffDetailsModal.staff.resident_category) : 'Resident category unavailable' }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contact & Schedule Tab -->
                        <div v-if="staffDetailsModal.activeTab === 'contact'" class="modal-tab-content active" role="tabpanel">
                            <div class="info-section">
                                <div class="info-section-title">
                                    <i class="fas fa-calendar-alt"></i>
                                    Schedule Information
                                </div>
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">Current Rotation</div>
                                        <div class="info-value" :class="staffDetailsModal.currentRotation ? '' : 'unavailable'">
                                            {{ staffDetailsModal.currentRotation || 'No active rotation' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Next On-call</div>
                                        <div class="info-value" :class="staffDetailsModal.nextOncall ? '' : 'unavailable'">
                                            {{ staffDetailsModal.nextOncall || 'No upcoming on-call scheduled' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Office Phone</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.office_phone ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.office_phone || 'Office phone unavailable' }}
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Mobile Phone</div>
                                        <div class="info-value" :class="staffDetailsModal.staff.mobile_phone ? '' : 'unavailable'">
                                            {{ staffDetailsModal.staff.mobile_phone || 'Mobile phone unavailable' }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="staffDetailsModal.show = false">Close</button>
                        <button class="btn btn-primary" @click="editMedicalStaff(staffDetailsModal.staff)"
                                v-if="hasPermission('medical_staff', 'update')">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 2: Add/Edit Medical Staff Modal -->
            <div v-if="medicalStaffModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="medical-staff-title">
                <div class="modal-container modal-wide">
                    <div class="modal-header">
                        <div class="modal-title" id="medical-staff-title">
                            <i class="fas fa-user-md"></i>
                            {{ medicalStaffModal.mode === 'add' ? 'Add Medical Staff' : 'Edit Medical Staff' }}
                        </div>
                        <button class="modal-close" @click="medicalStaffModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-tabs" role="tablist">
                            <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'basic' }" 
                                    @click="medicalStaffModal.activeTab = 'basic'" role="tab" aria-selected="medicalStaffModal.activeTab === 'basic'">
                                <i class="fas fa-user"></i> Basic Information
                            </button>
                            <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'professional' }" 
                                    @click="medicalStaffModal.activeTab = 'professional'" role="tab" aria-selected="medicalStaffModal.activeTab === 'professional'">
                                <i class="fas fa-graduation-cap"></i> Professional Details
                            </button>
                            <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'contact' }" 
                                    @click="medicalStaffModal.activeTab = 'contact'" role="tab" aria-selected="medicalStaffModal.activeTab === 'contact'">
                                <i class="fas fa-address-book"></i> Contact Information
                            </button>
                        </div>

                        <!-- Basic Information Tab -->
                        <div v-if="medicalStaffModal.activeTab === 'basic'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-id-card"></i>
                                    Basic Information
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Full Name *</label>
                                        <input type="text" class="form-control" v-model="medicalStaffModal.form.full_name" aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Staff Type *</label>
                                        <select class="form-select" v-model="medicalStaffModal.form.staff_type" aria-required="true">
                                            <option value="medical_resident">Medical Resident</option>
                                            <option value="attending_physician">Attending Physician</option>
                                            <option value="fellow">Fellow</option>
                                            <option value="nurse_practitioner">Nurse Practitioner</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Staff ID</label>
                                        <input type="text" class="form-control" v-model="medicalStaffModal.form.staff_id">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Employment Status</label>
                                        <select class="form-select" v-model="medicalStaffModal.form.employment_status">
                                            <option value="active">Active</option>
                                            <option value="on_leave">On Leave</option>
                                            <option value="inactive">Inactive</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Professional Details Tab -->
                        <div v-if="medicalStaffModal.activeTab === 'professional'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-graduation-cap"></i>
                                    Professional Details
                                </div>
                                
                                <div v-if="medicalStaffModal.form.staff_type === 'medical_resident'">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="form-group">
                                            <label class="form-label">Resident Category</label>
                                            <select class="form-select" v-model="medicalStaffModal.form.resident_category">
                                                <option value="">Select Category</option>
                                                <option value="department_internal">Department Internal</option>
                                                <option value="rotating_other_dept">Rotating Other Dept</option>
                                                <option value="external_institution">External Institution</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div v-if="medicalStaffModal.form.staff_type === 'attending_physician'">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="form-group">
                                            <label class="form-label">Specialization</label>
                                            <input type="text" class="form-control" v-model="medicalStaffModal.form.specialization">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Years of Experience</label>
                                            <input type="number" class="form-control" v-model="medicalStaffModal.form.years_experience" min="0" max="50">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Biography</label>
                                    <textarea class="form-control" v-model="medicalStaffModal.form.biography" rows="4"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Information Tab -->
                        <div v-if="medicalStaffModal.activeTab === 'contact'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-envelope"></i>
                                    Contact Information
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Professional Email *</label>
                                        <input type="email" class="form-control" v-model="medicalStaffModal.form.professional_email" aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Department</label>
                                        <select class="form-select" v-model="medicalStaffModal.form.department_id">
                                            <option value="">Select Department</option>
                                            <option v-for="department in departments" :key="department.id" :value="department.id">
                                                {{ department.name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Office Phone</label>
                                        <input type="tel" class="form-control" v-model="medicalStaffModal.form.office_phone">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Mobile Phone</label>
                                        <input type="tel" class="form-control" v-model="medicalStaffModal.form.mobile_phone">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Medical License Number</label>
                                        <input type="text" class="form-control" v-model="medicalStaffModal.form.medical_license">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Date of Birth</label>
                                        <input type="date" class="form-control" v-model="medicalStaffModal.form.date_of_birth">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="medicalStaffModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveMedicalStaff" :disabled="saving">
                            <span v-if="saving" class="loading"></span>
                            <span v-else>{{ medicalStaffModal.mode === 'add' ? 'Add Staff' : 'Save Changes' }}</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 3: Add/Edit Department Modal (WITH INTEGRATED CLINICAL UNITS) -->
            <div v-if="departmentModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="department-title">
                <div class="modal-container modal-wide">
                    <div class="modal-header">
                        <div class="modal-title" id="department-title">
                            <i class="fas fa-hospital"></i>
                            {{ departmentModal.mode === 'add' ? 'Add Department' : 'Edit Department' }}
                        </div>
                        <button class="modal-close" @click="departmentModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-tabs" role="tablist">
                            <button class="modal-tab" :class="{ active: departmentModal.activeTab === 'basic' }" 
                                    @click="departmentModal.activeTab = 'basic'" role="tab" aria-selected="departmentModal.activeTab === 'basic'">
                                <i class="fas fa-info-circle"></i> Department Info
                            </button>
                            <button class="modal-tab" :class="{ active: departmentModal.activeTab === 'units' }" 
                                    @click="departmentModal.activeTab = 'units'" role="tab" aria-selected="departmentModal.activeTab === 'units'">
                                <i class="fas fa-clinic-medical"></i> Clinical Units
                            </button>
                        </div>

                        <!-- Department Information Tab -->
                        <div v-if="departmentModal.activeTab === 'basic'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-building"></i>
                                    Department Information
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Department Name *</label>
                                        <input type="text" class="form-control" v-model="departmentModal.form.name" aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Department Code *</label>
                                        <input type="text" class="form-control" v-model="departmentModal.form.code" aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Status</label>
                                        <select class="form-select" v-model="departmentModal.form.status">
                                            <option value="active">Active</option>
                                            <option value="inactive">Inactive</option>
                                            <option value="archived">Archived</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Head of Department</label>
                                        <select class="form-select" v-model="departmentModal.form.head_of_department_id">
                                            <option value="">Select Head</option>
                                            <option v-for="staff in availableHeadsOfDepartment" :key="staff.id" :value="staff.id">
                                                {{ staff.full_name }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" v-model="departmentModal.form.description" rows="3"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Clinical Units Tab -->
                        <div v-if="departmentModal.activeTab === 'units'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-clinic-medical"></i>
                                    Clinical Units
                                    <small class="text-muted" style="font-size: 12px; margin-left: 10px;">(Required: At least one clinical unit per department)</small>
                                </div>
                                
                                <div v-for="(unit, index) in departmentModal.form.clinical_units" :key="index" 
                                     class="clinical-unit-entry" style="margin-bottom: 20px; padding: 15px; border: 1px solid var(--medical-light-blue); border-radius: var(--border-radius-md);">
                                    <div class="flex justify-between items-center mb-3">
                                        <div class="text-lg font-semibold">Clinical Unit {{ index + 1 }} *</div>
                                        <button type="button" class="btn btn-sm btn-danger" @click="removeClinicalUnit(index)" 
                                                v-if="departmentModal.form.clinical_units.length > 1">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="form-group">
                                            <label class="form-label">Unit Name *</label>
                                            <input type="text" class="form-control" v-model="unit.name" aria-required="true" 
                                                   placeholder="e.g., Pulmonology ICU">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Unit Code *</label>
                                            <input type="text" class="form-control" v-model="unit.code" aria-required="true" 
                                                   placeholder="e.g., PULM-ICU-01">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Unit Type *</label>
                                            <select class="form-select" v-model="unit.unit_type" aria-required="true">
                                                <option value="clinical">Clinical</option>
                                                <option value="administrative">Administrative</option>
                                                <option value="support">Support</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Status *</label>
                                            <select class="form-select" v-model="unit.status" aria-required="true">
                                                <option value="active">Active</option>
                                                <option value="inactive">Inactive</option>
                                                <option value="maintenance">Maintenance</option>
                                            </select>
                                        </div>
                                        <div class="form-group col-span-2">
                                            <label class="form-label">Description</label>
                                            <textarea class="form-control" v-model="unit.description" rows="2"></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-between items-center mt-4">
                                    <div class="text-sm text-gray-600">
                                        {{ departmentModal.form.clinical_units.length }} unit(s) configured
                                    </div>
                                    <button type="button" class="btn btn-primary" @click="addClinicalUnit">
                                        <i class="fas fa-plus"></i> Add Another Unit
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="departmentModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveDepartment" :disabled="saving || departmentModal.form.clinical_units.length === 0">
                            <span v-if="saving" class="loading"></span>
                            <span v-else>{{ departmentModal.mode === 'add' ? 'Create Department' : 'Save Changes' }}</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 4: Add/Edit Training Unit Modal -->
            <div v-if="trainingUnitModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="training-unit-title">
                <div class="modal-container" style="max-width: 600px;">
                    <div class="modal-header">
                        <div class="modal-title" id="training-unit-title">
                            <i class="fas fa-hospital-alt"></i>
                            {{ trainingUnitModal.mode === 'add' ? 'Add Training Unit' : 'Edit Training Unit' }}
                        </div>
                        <button class="modal-close" @click="trainingUnitModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-clinic-medical"></i>
                                Training Unit Information
                            </div>
                            <div class="form-group">
                                <label class="form-label">Unit Name *</label>
                                <input type="text" class="form-control" v-model="trainingUnitModal.form.unit_name" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Unit Code *</label>
                                <input type="text" 
                                       class="form-control" 
                                       v-model="trainingUnitModal.form.unit_code" 
                                       required
                                       placeholder="e.g., ICU-PULM-1">
                                <div class="text-sm text-gray-600 mt-1">
                                    Unique code for this unit
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Department *</label>
                                <select class="form-select" v-model="trainingUnitModal.form.department_id" required>
                                    <option value="">Select Department</option>
                                    <option v-for="department in departments" :key="department.id" :value="department.id">
                                        {{ department.name }}
                                    </option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" v-model="trainingUnitModal.form.unit_description" rows="3"></textarea>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Status *</label>
                                    <select class="form-select" v-model="trainingUnitModal.form.unit_status" required>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Max Residents *</label>
                                    <input type="number" class="form-control" v-model="trainingUnitModal.form.maximum_residents" min="1" max="50" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Specialty</label>
                                <input type="text" class="form-control" v-model="trainingUnitModal.form.specialty" placeholder="e.g., Pulmonology, Critical Care">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Supervising Attending</label>
                                <select class="form-select" v-model="trainingUnitModal.form.supervising_attending_id">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="attending in availableAttendings" :key="attending.id" :value="attending.id">
                                        {{ attending.full_name }} ({{ attending.staff_id }})
                                        <span v-if="attending.can_supervise_residents"> - Supervisor</span>
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="trainingUnitModal.show = false">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary" @click="saveTrainingUnit" :disabled="saving">
                            <i class="fas fa-save"></i>
                            {{ saving ? 'Saving...' : (trainingUnitModal.mode === 'add' ? 'Add Unit' : 'Update Unit') }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 5: Add/Edit Rotation Modal -->
            <div v-if="rotationModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="rotation-title">
                <div class="modal-container" style="max-width: 700px;">
                    <div class="modal-header">
                        <div class="modal-title" id="rotation-title">
                            <i class="fas fa-calendar-alt"></i>
                            {{ rotationModal.mode === 'add' ? 'Schedule Rotation' : 'Edit Rotation' }}
                        </div>
                        <button class="modal-close" @click="rotationModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-calendar-check"></i>
                                Rotation Details
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Rotation ID</label>
                                    <input type="text" class="form-control" v-model="rotationModal.form.rotation_id" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Status *</label>
                                    <select class="form-select" v-model="rotationModal.form.rotation_status" required>
                                        <option value="scheduled">Scheduled</option>
                                        <option value="active">Active</option>
                                        <option value="completed">Completed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Start Date *</label>
                                    <input type="date" class="form-control" v-model="rotationModal.form.rotation_start_date" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">End Date *</label>
                                    <input type="date" class="form-control" v-model="rotationModal.form.rotation_end_date" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Resident *</label>
                                    <select class="form-select" 
                                            v-model="rotationModal.form.resident_id" 
                                            required>
                                        <option value="">Select Resident</option>
                                        <option v-for="resident in availableResidents" 
                                                :key="resident.id" 
                                                :value="resident.id">
                                            {{ resident.full_name }} ({{ resident.staff_id }} - {{ formatResidentCategory(resident.resident_category) }})
                                        </option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Training Unit *</label>
                                    <select class="form-select" 
                                            v-model="rotationModal.form.training_unit_id" 
                                            required>
                                        <option value="">Select Training Unit</option>
                                        <option v-for="unit in activeTrainingUnits" 
                                                :key="unit.id" 
                                                :value="unit.id">
                                            {{ unit.unit_name }} ({{ unit.current_residents || 0 }}/{{ unit.maximum_residents }})
                                            <span v-if="unit.specialty"> - {{ unit.specialty }}</span>
                                        </option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Supervising Attending (Optional)</label>
                                    <select class="form-select" 
                                            v-model="rotationModal.form.supervising_attending_id">
                                        <option value="">No Supervisor Assigned</option>
                                        <option v-for="attending in availableAttendings" 
                                                :key="attending.id" 
                                                :value="attending.id">
                                            {{ attending.full_name }} ({{ attending.staff_id }})
                                            <span v-if="attending.can_supervise_residents"> - Supervisor</span>
                                        </option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Category *</label>
                                    <select class="form-select" v-model="rotationModal.form.rotation_category" required>
                                        <option value="clinical_rotation">Clinical Rotation</option>
                                        <option value="elective_rotation">Elective Rotation</option>
                                        <option value="research_rotation">Research</option>
                                        <option value="vacation_rotation">Vacation</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Clinical Notes</label>
                                <textarea class="form-control" 
                                          v-model="rotationModal.form.clinical_notes"
                                          rows="3"
                                          placeholder="Enter clinical notes or instructions..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Supervisor Evaluation</label>
                                <textarea class="form-control" 
                                          v-model="rotationModal.form.supervisor_evaluation"
                                          rows="3"
                                          placeholder="Enter supervisor evaluation..."></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="rotationModal.show = false">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary" @click="saveRotation" :disabled="saving">
                            <i class="fas fa-save"></i>
                            {{ saving ? 'Saving...' : (rotationModal.mode === 'add' ? 'Schedule Rotation' : 'Update Rotation') }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 6: Quick Placement Modal -->
            <div v-if="quickPlacementModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="quick-placement-title">
                <div class="modal-container" style="max-width: 500px;">
                    <div class="modal-header">
                        <div class="modal-title" id="quick-placement-title">
                            <i class="fas fa-user-plus"></i>
                            Quick Resident Placement
                        </div>
                        <button class="modal-close" @click="quickPlacementModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-user-graduate"></i>
                                Placement Details
                            </div>
                            <div class="form-group">
                                <label class="form-label">Resident *</label>
                                <select class="form-select" v-model="quickPlacementModal.form.resident_id" required>
                                    <option value="">Select Resident</option>
                                    <option v-for="resident in availableResidents" :key="resident.id" :value="resident.id">
                                        {{ resident.full_name }} ({{ formatResidentCategory(resident.resident_category) }})
                                    </option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Training Unit *</label>
                                <select class="form-select" v-model="quickPlacementModal.form.unit_id" required>
                                    <option value="">Select Unit</option>
                                    <option v-for="unit in trainingUnits" :key="unit.id" :value="unit.id">
                                        {{ unit.unit_name }} ({{ unit.current_residents || 0 }}/{{ unit.maximum_residents }})
                                    </option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Duration (weeks)</label>
                                <input type="number" class="form-control" v-model="quickPlacementModal.form.duration" min="1" max="52" value="4">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Start Date</label>
                                <input type="date" class="form-control" v-model="quickPlacementModal.form.start_date">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Supervisor (Optional)</label>
                                <select class="form-select" v-model="quickPlacementModal.form.supervisor_id">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="supervisor in availableAttendings" :key="supervisor.id" :value="supervisor.id">
                                        {{ supervisor.full_name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="quickPlacementModal.show = false">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary" @click="saveQuickPlacement" :disabled="saving">
                            <i class="fas fa-user-plus"></i>
                            {{ saving ? 'Placing...' : 'Place Resident' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 7: On-call Schedule Modal -->
            <div v-if="onCallModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="oncall-title">
                <div class="modal-container" style="max-width: 600px;">
                    <div class="modal-header">
                        <div class="modal-title" id="oncall-title">
                            <i class="fas fa-phone-alt"></i>
                            {{ onCallModal.mode === 'add' ? 'Schedule On-call' : 'Edit On-call Schedule' }}
                        </div>
                        <button class="modal-close" @click="onCallModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-calendar"></i>
                                Schedule Details
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Date *</label>
                                    <input type="date" class="form-control" v-model="onCallModal.form.duty_date" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Shift Type *</label>
                                    <select class="form-select" v-model="onCallModal.form.shift_type" required>
                                        <option value="backup_call">Backup Call</option>
                                        <option value="primary_call">Primary Call</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Primary Physician *</label>
                                    <select class="form-select" 
                                            v-model="onCallModal.form.primary_physician_id" 
                                            required>
                                        <option value="">Select Primary Physician</option>
                                        <option v-for="physician in availablePhysicians" 
                                                :key="physician.id" 
                                                :value="physician.id">
                                            {{ physician.full_name }} ({{ physician.staff_id }})
                                        </option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Backup Physician</label>
                                    <select class="form-select" 
                                            v-model="onCallModal.form.backup_physician_id">
                                        <option value="">No Backup Assigned</option>
                                        <option v-for="physician in availablePhysicians" 
                                                :key="physician.id" 
                                                :value="physician.id">
                                            {{ physician.full_name }} ({{ physician.staff_id }})
                                        </option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Start Time *</label>
                                    <input type="time" class="form-control" v-model="onCallModal.form.start_time" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">End Time *</label>
                                    <input type="time" class="form-control" v-model="onCallModal.form.end_time" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Coverage Area</label>
                                <select class="form-select" v-model="onCallModal.form.coverage_area">
                                    <option value="emergency">Emergency Department</option>
                                    <option value="icu">Intensive Care Unit</option>
                                    <option value="ward">General Ward</option>
                                    <option value="consultation">Consultations</option>
                                    <option value="all">All Areas</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Coverage Notes</label>
                                <textarea class="form-control" v-model="onCallModal.form.coverage_notes" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Contact Number</label>
                                <input type="tel" class="form-control" v-model="onCallModal.form.contact_number" placeholder="Emergency contact number">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="onCallModal.show = false">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary" @click="saveOnCallSchedule" :disabled="saving">
                            <i class="fas fa-save"></i>
                            {{ saving ? 'Saving...' : (onCallModal.mode === 'add' ? 'Schedule On-call' : 'Update Schedule') }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 8: Add/Edit Staff Absence Modal -->
            <div v-if="absenceModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="absence-title">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title" id="absence-title">
                            <i class="fas fa-calendar-times"></i>
                            {{ absenceModal.mode === 'add' ? 'Document Staff Absence' : 'Edit Absence Record' }}
                        </div>
                        <button class="modal-close" @click="absenceModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-tabs" role="tablist">
                            <button class="modal-tab" :class="{ active: absenceModal.activeTab === 'basic' }" 
                                    @click="absenceModal.activeTab = 'basic'" role="tab" aria-selected="absenceModal.activeTab === 'basic'">
                                <i class="fas fa-info-circle"></i> Basic Information
                            </button>
                            <button class="modal-tab" :class="{ active: absenceModal.activeTab === 'coverage' }" 
                                    @click="absenceModal.activeTab = 'coverage'" role="tab" aria-selected="absenceModal.activeTab === 'coverage'">
                                <i class="fas fa-user-md"></i> Coverage Arrangements
                            </button>
                        </div>

                        <!-- Basic Information Tab -->
                        <div v-if="absenceModal.activeTab === 'basic'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-user"></i>
                                    Staff Information
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Staff Member *</label>
                                        <select class="form-select" v-model="absenceModal.form.staff_member_id" aria-required="true">
                                            <option value="">Select Staff Member</option>
                                            <option v-for="staff in availableStaff" :key="staff.id" :value="staff.id">
                                                {{ staff.full_name }} ({{ formatStaffType(staff.staff_type) }})
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Absence Reason *</label>
                                        <select class="form-select" v-model="absenceModal.form.absence_reason" aria-required="true">
                                            <option value="">Select Reason</option>
                                            <option value="vacation">Vacation</option>
                                            <option value="sick_leave">Sick Leave</option>
                                            <option value="family_emergency">Family Emergency</option>
                                            <option value="conference">Conference/Training</option>
                                            <option value="maternity_paternity">Maternity/Paternity Leave</option>
                                            <option value="personal">Personal Leave</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-calendar-alt"></i>
                                    Dates & Duration
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Start Date *</label>
                                        <input type="date" class="form-control" v-model="absenceModal.form.start_date" aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">End Date *</label>
                                        <input type="date" class="form-control" v-model="absenceModal.form.end_date" aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Status</label>
                                        <select class="form-select" v-model="absenceModal.form.status">
                                            <option value="upcoming">Upcoming</option>
                                            <option value="active">Active</option>
                                            <option value="completed">Completed</option>
                                            <option value="cancelled">Cancelled</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Total Days</label>
                                        <input type="number" class="form-control" v-model="absenceModal.form.total_days" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Coverage Arrangements Tab -->
                        <div v-if="absenceModal.activeTab === 'coverage'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-user-friends"></i>
                                    Coverage Information
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Needs Coverage?</label>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" v-model="absenceModal.form.needs_coverage" 
                                               :id="'needs-coverage-' + absenceModal.mode">
                                        <label class="form-check-label" :for="'needs-coverage-' + absenceModal.mode">
                                            This absence requires coverage arrangements
                                        </label>
                                    </div>
                                </div>

                                <div v-if="absenceModal.form.needs_coverage" class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Replacement Staff</label>
                                        <select class="form-select" v-model="absenceModal.form.replacement_staff_id">
                                            <option value="">Select Replacement</option>
                                            <option v-for="staff in availableCoverageStaff" :key="staff.id" :value="staff.id">
                                                {{ staff.full_name }} ({{ formatStaffType(staff.staff_type) }})
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Coverage Type</label>
                                        <select class="form-select" v-model="absenceModal.form.coverage_type">
                                            <option value="">Select Type</option>
                                            <option value="full">Full Coverage</option>
                                            <option value="partial">Partial Coverage</option>
                                            <option value="emergency">Emergency Only</option>
                                            <option value="shared">Shared Responsibility</option>
                                        </select>
                                    </div>
                                </div>

                                <div v-if="absenceModal.form.needs_coverage && absenceModal.form.replacement_staff_id" class="form-group">
                                    <label class="form-label">Coverage Notes</label>
                                    <textarea class="form-control" v-model="absenceModal.form.coverage_notes" rows="3" 
                                              placeholder="Details about coverage arrangements, responsibilities, etc."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="absenceModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveAbsence" :disabled="saving">
                            <span v-if="saving" class="loading"></span>
                            <span v-else>{{ absenceModal.mode === 'add' ? 'Document Absence' : 'Save Changes' }}</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 9: Communications Modal -->
            <div v-if="communicationsModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="communications-title">
                <div class="modal-container modal-wide">
                    <div class="modal-header">
                        <div class="modal-title" id="communications-title">
                            <i class="fas fa-comments"></i>
                            Department Communications
                        </div>
                        <button class="modal-close" @click="communicationsModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-tabs" role="tablist">
                            <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'announcement' }" 
                                    @click="communicationsModal.activeTab = 'announcement'" role="tab" aria-selected="communicationsModal.activeTab === 'announcement'">
                                <i class="fas fa-bullhorn"></i> Announcement
                            </button>
                            <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'quick_note' }" 
                                    @click="communicationsModal.activeTab = 'quick_note'" role="tab" aria-selected="communicationsModal.activeTab === 'quick_note'">
                                <i class="fas fa-sticky-note"></i> Quick Note
                            </button>
                        </div>

                        <!-- Announcement Tab -->
                        <div v-if="communicationsModal.activeTab === 'announcement'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-newspaper"></i>
                                    Create Announcement
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Title *</label>
                                    <input type="text" class="form-control" v-model="communicationsModal.form.announcement_title" 
                                           placeholder="Enter announcement title" aria-required="true">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Content *</label>
                                    <textarea class="form-control" v-model="communicationsModal.form.announcement_content" 
                                              rows="6" placeholder="Enter announcement content" aria-required="true"></textarea>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Priority Level *</label>
                                        <select class="form-select" v-model="communicationsModal.form.priority_level" aria-required="true">
                                            <option value="low">Low Priority</option>
                                            <option value="medium">Medium Priority</option>
                                            <option value="high">High Priority</option>
                                            <option value="urgent">Urgent</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Target Audience</label>
                                        <select class="form-select" v-model="communicationsModal.form.target_audience">
                                            <option value="all_staff">All Staff</option>
                                            <option value="medical_staff">Medical Staff Only</option>
                                            <option value="residents">Residents Only</option>
                                            <option value="attendings">Attending Physicians Only</option>
                                            <option value="department">Department Specific</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Publish Start Date *</label>
                                        <input type="datetime-local" class="form-control" v-model="communicationsModal.form.publish_start_date" 
                                               aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Publish End Date</label>
                                        <input type="datetime-local" class="form-control" v-model="communicationsModal.form.publish_end_date">
                                    </div>
                                </div>
                                
                                <div v-if="communicationsModal.form.target_audience === 'department'" class="form-group">
                                    <label class="form-label">Target Department</label>
                                    <select class="form-select" v-model="communicationsModal.form.target_department_id">
                                        <option value="">Select Department</option>
                                        <option v-for="department in departments" :key="department.id" :value="department.id">
                                            {{ department.name }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Note Tab -->
                        <div v-if="communicationsModal.activeTab === 'quick_note'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-pen"></i>
                                    Quick Department Note
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Note Type</label>
                                    <select class="form-select" v-model="communicationsModal.form.note_type">
                                        <option value="info">Information</option>
                                        <option value="reminder">Reminder</option>
                                        <option value="update">Status Update</option>
                                        <option value="alert">Alert</option>
                                        <option value="thanks">Thanks/Recognition</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Note Content *</label>
                                    <textarea class="form-control" v-model="communicationsModal.form.note_content" 
                                              rows="4" placeholder="Enter your quick note here..." aria-required="true"></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Expires In</label>
                                    <select class="form-select" v-model="communicationsModal.form.note_expires_in">
                                        <option value="1">1 hour</option>
                                        <option value="4">4 hours</option>
                                        <option value="8">8 hours</option>
                                        <option value="24">24 hours</option>
                                        <option value="168">1 week</option>
                                        <option value="never">Never</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="communicationsModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveCommunication" :disabled="saving">
                            <span v-if="saving" class="loading"></span>
                            <span v-else>
                                <i class="fas" :class="getCommunicationIcon(communicationsModal.activeTab)"></i>
                                {{ getCommunicationButtonText(communicationsModal.activeTab) }}
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 10: Permission Role Modal -->
            <div v-if="roleModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="role-title">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title" id="role-title">
                            <i class="fas fa-user-shield"></i>
                            {{ roleModal.mode === 'add' ? 'Add Role' : 'Edit Role' }}
                        </div>
                        <button class="modal-close" @click="roleModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-info-circle"></i>
                                Role Information
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Role Name *</label>
                                <input type="text" class="form-control" v-model="roleModal.form.name" 
                                       placeholder="Enter role name" aria-required="true">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" v-model="roleModal.form.description" rows="3"
                                          placeholder="Enter role description"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Default Permissions</label>
                                <div class="permission-checkboxes">
                                    <div v-for="permission in availablePermissions" :key="permission.id" class="form-check">
                                        <input type="checkbox" class="form-check-input" 
                                               :id="'role-permission-' + permission.id"
                                               :checked="isPermissionSelected(permission.id)"
                                               @change="togglePermissionSelection(permission.id)">
                                        <label class="form-check-label" :for="'role-permission-' + permission.id">
                                            {{ formatPermissionName(permission.name) }}
                                            <span class="text-xs text-gray-500 ml-2">({{ permission.module }})</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="roleModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveRole" :disabled="saving">
                            <span v-if="saving" class="loading"></span>
                            <span v-else>{{ roleModal.mode === 'add' ? 'Add Role' : 'Save Changes' }}</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 11: User Profile Modal -->
            <div v-if="userProfileModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="user-profile-title">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title" id="user-profile-title">
                            <i class="fas fa-user"></i> Profile Settings
                        </div>
                        <button class="modal-close" @click="userProfileModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-tabs" role="tablist">
                            <button class="modal-tab" :class="{ active: userProfileModal.activeTab === 'profile' }" 
                                    @click="userProfileModal.activeTab = 'profile'" role="tab" aria-selected="userProfileModal.activeTab === 'profile'">
                                <i class="fas fa-user-circle"></i> Profile
                            </button>
                            <button class="modal-tab" :class="{ active: userProfileModal.activeTab === 'security' }" 
                                    @click="userProfileModal.activeTab = 'security'" role="tab" aria-selected="userProfileModal.activeTab === 'security'">
                                <i class="fas fa-shield-alt"></i> Security
                            </button>
                        </div>

                        <!-- Profile Tab -->
                        <div v-if="userProfileModal.activeTab === 'profile'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-user"></i>
                                    Personal Information
                                </div>
                                
                                <div class="flex flex-col items-center mb-6">
                                    <div class="user-avatar" style="width: 80px; height: 80px; font-size: 24px;">
                                        {{ getInitials(userProfileModal.form.full_name) }}
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Full Name *</label>
                                        <input type="text" class="form-control" v-model="userProfileModal.form.full_name" 
                                               aria-required="true">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Email *</label>
                                        <input type="email" class="form-control" v-model="userProfileModal.form.email" 
                                               aria-required="true" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" v-model="userProfileModal.form.phone">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Department</label>
                                        <select class="form-select" v-model="userProfileModal.form.department_id">
                                            <option value="">Select Department</option>
                                            <option v-for="department in departments" :key="department.id" :value="department.id">
                                                {{ department.name }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Biography</label>
                                    <textarea class="form-control" v-model="userProfileModal.form.biography" rows="4"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Security Tab -->
                        <div v-if="userProfileModal.activeTab === 'security'" class="modal-tab-content active" role="tabpanel">
                            <div class="modal-section">
                                <div class="modal-section-title">
                                    <i class="fas fa-key"></i>
                                    Change Password
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Current Password</label>
                                    <input type="password" class="form-control" v-model="userProfileModal.form.current_password">
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">New Password</label>
                                        <input type="password" class="form-control" v-model="userProfileModal.form.new_password">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Confirm Password</label>
                                        <input type="password" class="form-control" v-model="userProfileModal.form.confirm_password">
                                    </div>
                                </div>
                                
                                <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded" v-if="userProfileModal.form.new_password">
                                    <div class="text-sm text-blue-700">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        Password must contain at least 8 characters including uppercase, lowercase, and numbers.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="userProfileModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveUserProfile" :disabled="saving">
                            <span v-if="saving" class="loading"></span>
                            <span v-else>Save Profile</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 12: Confirmation Modal -->
            <div v-if="confirmationModal && confirmationModal.show" class="modal-overlay" role="dialog" aria-modal="true" 
                 aria-labelledby="confirmation-title" aria-describedby="confirmation-message">
                <div class="modal-container" style="max-width: 500px;">
                    <div class="modal-header">
                        <div class="modal-title" id="confirmation-title">
                            <i class="fas" :class="confirmationModal.icon || 'fa-question-circle'"></i>
                            {{ confirmationModal.title || 'Confirm Action' }}
                        </div>
                        <button class="modal-close" @click="cancelConfirmation" aria-label="Close confirmation dialog">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p id="confirmation-message" style="text-align: center; margin: 20px 0; font-size: 16px; color: var(--gray-700); line-height: 1.5;">
                            {{ confirmationModal.message || 'Are you sure you want to proceed?' }}
                        </p>
                        <div v-if="confirmationModal.details" style="background: var(--medical-light-blue); padding: 16px; border-radius: var(--border-radius-md); margin-top: 16px; font-size: 14px; color: var(--medical-dark-blue);">
                            <i class="fas fa-info-circle" style="margin-right: 8px;"></i>
                            {{ confirmationModal.details }}
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="cancelConfirmation" :disabled="saving">
                            {{ confirmationModal.cancelButtonText || 'Cancel' }}
                        </button>
                        <button class="btn" :class="confirmationModal.confirmButtonClass || 'btn-danger'" @click="confirmAction" :disabled="saving">
                            <template v-if="saving">
                                <span class="loading-spinner" style="display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite;"></span>
                            </template>
                            <template v-else>
                                <i :class="confirmationModal.confirmButtonIcon || 'fa-check'" style="margin-right: 8px;"></i>
                                {{ confirmationModal.confirmButtonText || 'Confirm' }}
                            </template>
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Load your Vue app AFTER Vue is loaded and AFTER the template -->
    <script src="app.js"></script>
    
    <!-- Safety check -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Vue === 'undefined') {
                console.error('Vue.js failed to load!');
                alert('Vue.js failed to load. Please refresh the page.');
            }
        });
    </script>
</body>
</html>
