<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeumoCare Hospital Management System</title>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Vue.js 3 - MUST BE LOADED FIRST -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <style>
        /* ============ MEDICAL BLUE THEME ============ */
        :root {
            --medical-blue: #0077be;
            --medical-dark-blue: #005a9e;
            --medical-light-blue: #e3f2fd;
            --medical-teal: #00838f;
            --medical-green: #2e7d32;
            --medical-red: #c62828;
            --medical-orange: #f57c00;
            --medical-gray: #546e7a;
            --medical-light-gray: #f5f7fa;
            
            --primary-color: var(--medical-blue);
            --primary-dark: var(--medical-dark-blue);
            --primary-light: var(--medical-light-blue);
            --secondary-color: var(--medical-green);
            --danger-color: var(--medical-red);
            --warning-color: var(--medical-orange);
            --info-color: var(--medical-teal);
            --gray-50: #f8f9fa;
            --gray-100: #f1f3f4;
            --gray-200: #e8eaed;
            --gray-300: #dadce0;
            --gray-400: #bdc1c6;
            --gray-500: var(--medical-gray);
            --gray-600: #80868b;
            --gray-700: #5f6368;
            --gray-800: #3c4043;
            --gray-900: #202124;
            
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 40px rgba(0,0,0,0.15);
            --shadow-xl: 0 20px 60px rgba(0,0,0,0.2);
            
            --border-radius-sm: 6px;
            --border-radius-md: 10px;
            --border-radius-lg: 16px;
            --border-radius-xl: 24px;
            
            --transition-fast: 150ms;
            --transition-normal: 250ms;
            --transition-slow: 350ms;
        }
        
        /* ADD THIS AT THE TOP OF YOUR STYLES */
        [v-cloak] {
            display: none !important;
        }

        #app[v-cloak] {
            opacity: 0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--gray-900);
            line-height: 1.6;
            min-height: 100vh;
            scroll-behavior: smooth;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            line-height: 1.3;
        }

        /* ============ UTILITY CLASSES ============ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .text-primary { color: var(--primary-color); }
        .text-success { color: var(--secondary-color); }
        .text-danger { color: var(--danger-color); }
        .text-warning { color: var(--warning-color); }
        .text-info { color: var(--info-color); }
        .text-muted { color: var(--gray-600); }

        .bg-primary { background: var(--primary-color); }
        .bg-success { background: var(--secondary-color); }
        .bg-danger { background: var(--danger-color); }
        .bg-warning { background: var(--warning-color); }
        .bg-info { background: var(--info-color); }
        .bg-light { background: var(--gray-50); }

        .shadow-sm { box-shadow: var(--shadow-sm); }
        .shadow-md { box-shadow: var(--shadow-md); }
        .shadow-lg { box-shadow: var(--shadow-lg); }

        .rounded-sm { border-radius: var(--border-radius-sm); }
        .rounded-md { border-radius: var(--border-radius-md); }
        .rounded-lg { border-radius: var(--border-radius-lg); }
        .rounded-xl { border-radius: var(--border-radius-xl); }

        .transition { transition: all var(--transition-normal) ease; }
        .transition-fast { transition: all var(--transition-fast) ease; }
        .transition-slow { transition: all var(--transition-slow) ease; }

        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-3 { margin-top: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mt-8 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }

        .ml-2 { margin-left: 0.5rem; }

        .w-100 { width: 100%; }
        .h-100 { height: 100%; }

        .flex { display: flex; }
        .grid { display: grid; }
        .hidden { display: none; }
        .block { display: block; }

        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }

        /* ============ MEDICAL PROFESSIONAL BUTTONS ============ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius-md);
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 14px;
            line-height: 1;
            cursor: pointer;
            transition: all var(--transition-normal) ease;
            white-space: nowrap;
            min-height: 44px;
            touch-action: manipulation;
            letter-spacing: 0.3px;
            text-transform: uppercase;
        }

        .btn i { font-size: 14px; }

        .btn-primary {
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
            color: white;
            box-shadow: 0 4px 12px rgba(0, 119, 190, 0.3);
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--medical-dark-blue), var(--medical-blue));
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 119, 190, 0.4);
        }

        .btn-secondary {
            background: white;
            color: var(--medical-blue);
            border: 2px solid var(--medical-blue);
            box-shadow: 0 2px 8px rgba(0, 119, 190, 0.1);
        }
        .btn-secondary:hover {
            background: var(--medical-light-blue);
            border-color: var(--medical-dark-blue);
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--medical-green), #1b5e20);
            color: white;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
        }
        .btn-success:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--medical-red), #b71c1c);
            color: white;
            box-shadow: 0 4px 12px rgba(198, 40, 40, 0.3);
        }
        .btn-danger:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--medical-blue);
            color: var(--medical-blue);
        }
        .btn-outline:hover {
            background: var(--medical-blue);
            color: white;
        }

        .btn-outline-danger {
            background: transparent;
            border: 2px solid var(--medical-red);
            color: var(--medical-red);
        }
        .btn-outline-danger:hover {
            background: var(--medical-red);
            color: white;
        }

        .btn-sm { padding: 8px 16px; font-size: 13px; min-height: 36px; }
        .btn-lg { padding: 14px 28px; font-size: 16px; min-height: 52px; }

        .btn-icon {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
        }

        /* ============ PROFESSIONAL BADGES ============ */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: white;
            border: 1px solid transparent;
        }

        .badge-primary {
            background: var(--medical-blue);
            border-color: var(--medical-dark-blue);
        }

        .badge-success {
            background: var(--medical-green);
            border-color: #1b5e20;
        }

        .badge-warning {
            background: var(--medical-orange);
            border-color: #e65100;
        }

        .badge-danger {
            background: var(--medical-red);
            border-color: #b71c1c;
        }

        .badge-info {
            background: var(--medical-teal);
            border-color: #006064;
        }

        /* ============ STATUS BADGES ============ */
        .status-available {
            background: linear-gradient(135deg, var(--medical-green), #1b5e20);
            color: white;
        }

        .status-busy {
            background: linear-gradient(135deg, var(--medical-orange), #e65100);
            color: white;
        }

        .status-critical {
            background: linear-gradient(135deg, var(--medical-red), #b71c1c);
            color: white;
        }

        .status-oncall {
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
            color: white;
        }

        /* ============ PROFESSIONAL CARDS ============ */
        .card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: 24px;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal) ease;
            border: 1px solid var(--gray-200);
            border-left: 4px solid var(--medical-blue);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--medical-blue), var(--medical-teal));
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-4px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--medical-light-blue);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--medical-blue);
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* ============ FORMS ============ */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--medical-dark-blue);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            transition: all var(--transition-normal) ease;
            background: white;
            min-height: 44px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--medical-blue);
            box-shadow: 0 0 0 3px rgba(0, 119, 190, 0.1);
        }

        .form-control-sm {
            padding: 10px 12px;
            font-size: 13px;
            min-height: 40px;
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            background: white;
            cursor: pointer;
            min-height: 44px;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%230077be' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--medical-blue);
            box-shadow: 0 0 0 3px rgba(0, 119, 190, 0.1);
        }

        .form-check {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .form-check-input {
            width: 20px;
            height: 20px;
            cursor: pointer;
            min-height: 20px;
            accent-color: var(--medical-blue);
        }

        .form-check-label {
            font-size: 14px;
            color: var(--gray-700);
            cursor: pointer;
            font-weight: 500;
        }

        /* ============ TABLES ============ */
        .table-responsive {
            overflow-x: auto;
            border-radius: var(--border-radius-md);
            background: white;
            box-shadow: var(--shadow-sm);
            -webkit-overflow-scrolling: touch;
            border: 1px solid var(--medical-light-blue);
        }

        .table-responsive::-webkit-scrollbar {
            height: 6px;
        }

        .table-responsive::-webkit-scrollbar-track {
            background: var(--gray-100);
        }

        .table-responsive::-webkit-scrollbar-thumb {
            background: var(--medical-blue);
            border-radius: 3px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .table thead {
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
        }

        .table th {
            padding: 16px;
            text-align: left;
            color: white;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid var(--gray-200);
        }

        .table tbody tr {
            border-bottom: 1px solid var(--medical-light-blue);
            transition: all var(--transition-fast) ease;
        }

        .table tbody tr:hover {
            background: var(--medical-light-blue);
        }

        .table td {
            padding: 16px;
            font-size: 14px;
            color: var(--gray-700);
            vertical-align: middle;
        }

        /* ============ MODALS ============ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.2s ease-out;
            padding: 20px;
        }

        .modal-container {
            background: white;
            border-radius: var(--border-radius-lg);
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--gray-200);
        }

        .modal-wide {
            max-width: 900px;
        }

        .modal-xwide {
            max-width: 1100px;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px;
            border-bottom: 2px solid var(--medical-light-blue);
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
            color: white;
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-title i {
            font-size: 20px;
            opacity: 0.9;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 10px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast) ease;
            min-height: 44px;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 2px solid var(--medical-light-blue);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            background: var(--gray-50);
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
            position: sticky;
            bottom: 0;
        }

        /* Modal Tabs */
        .modal-tabs {
            display: flex;
            border-bottom: 2px solid var(--medical-light-blue);
            margin-bottom: 24px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-tabs::-webkit-scrollbar {
            height: 3px;
        }

        .modal-tab {
            padding: 12px 24px;
            border: none;
            background: none;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-600);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all var(--transition-fast);
            white-space: nowrap;
            min-height: 44px;
        }

        .modal-tab:hover {
            color: var(--medical-blue);
            background: var(--medical-light-blue);
        }

        .modal-tab.active {
            color: var(--medical-blue);
            border-bottom-color: var(--medical-blue);
            background: var(--medical-light-blue);
        }

        .modal-tab-content {
            display: none;
        }

        .modal-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Modal Sections */
        .modal-section {
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--medical-light-blue);
        }

        .modal-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .modal-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 0;
        }

        .modal-section-title i {
            font-size: 14px;
            color: var(--medical-blue);
        }

        /* ============ TOASTS ============ */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 99999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: white;
            border-radius: var(--border-radius-md);
            padding: 16px 20px;
            min-width: 300px;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--medical-blue);
            animation: toastSlideIn 0.3s ease;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        @keyframes toastSlideIn {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .toast-icon {
            font-size: 18px;
            color: var(--medical-blue);
            margin-top: 2px;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
            color: var(--gray-900);
        }

        .toast-message {
            font-size: 13px;
            color: var(--gray-700);
            line-height: 1.4;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--gray-500);
            font-size: 14px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all var(--transition-fast);
            min-height: 24px;
        }

        .toast-close:hover {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .toast-success { border-left-color: var(--medical-green); }
        .toast-success .toast-icon { color: var(--medical-green); }

        .toast-error { border-left-color: var(--medical-red); }
        .toast-error .toast-icon { color: var(--medical-red); }

        .toast-warning { border-left-color: var(--medical-orange); }
        .toast-warning .toast-icon { color: var(--medical-orange); }

        /* ============ LOGIN SCREEN ============ */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--medical-dark-blue) 0%, var(--medical-blue) 100%);
        }

        .login-card {
            background: white;
            border-radius: var(--border-radius-xl);
            padding: 48px;
            width: 100%;
            max-width: 500px;
            box-shadow: var(--shadow-xl);
            animation: fadeIn 0.8s ease;
            border: 1px solid var(--medical-light-blue);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .login-logo i {
            font-size: 42px;
            color: var(--medical-blue);
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .login-title {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .login-subtitle {
            color: var(--medical-gray);
            font-size: 16px;
            max-width: 400px;
            margin: 0 auto;
            font-weight: 500;
        }

        /* ============ MAIN LAYOUT ============ */
        .app-layout {
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
        }

        /* ============ MEDICAL SIDEBAR ============ */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, var(--medical-dark-blue) 0%, var(--medical-blue) 100%);
            color: white;
            display: flex;
            flex-direction: column;
            transition: all var(--transition-normal) ease;
            position: fixed;
            height: 100vh;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-collapsed {
            width: 80px;
        }

        .sidebar-header {
            padding: 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.1);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 18px;
        }

        .sidebar-logo i {
            font-size: 24px;
            color: white;
        }

        .sidebar-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
            padding: 10px;
            border-radius: 6px;
            transition: all var(--transition-fast) ease;
            min-height: 44px;
            width: 44px;
            height: 44px;
        }

        .sidebar-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-section-title {
            padding: 0 24px 12px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 600;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 8px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu-item {
            margin: 4px 0;
        }

        .sidebar-menu-link {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 24px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all var(--transition-fast) ease;
            font-size: 14px;
            font-weight: 500;
            border-left: 3px solid transparent;
            min-height: 48px;
            margin: 0 12px;
            border-radius: 8px;
        }

        .sidebar-menu-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(4px);
        }

        .sidebar-menu-link.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border-left-color: #4fc3f7;
            box-shadow: 0 4px 12px rgba(79, 195, 247, 0.2);
        }

        .sidebar-menu-link i {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
        }

        .sidebar-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4fc3f7, var(--medical-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-size: 14px;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-role {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-collapsed .sidebar-header {
            justify-content: center;
        }

        .sidebar-collapsed .sidebar-logo span,
        .sidebar-collapsed .sidebar-section-title,
        .sidebar-collapsed .sidebar-menu-link span,
        .sidebar-collapsed .user-info,
        .sidebar-collapsed .sidebar-toggle span {
            display: none;
        }

        .sidebar-collapsed .sidebar-logo,
        .sidebar-collapsed .sidebar-menu-link {
            justify-content: center;
        }

        .sidebar-collapsed .sidebar-menu-link i {
            font-size: 18px;
        }

        /* ============ MAIN CONTENT ============ */
        .main-content {
            flex: 1;
            margin-left: 280px;
            transition: all var(--transition-normal) ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-content-expanded {
            margin-left: 80px;
        }

        /* ============ TOP NAVBAR ============ */
        .top-navbar {
            background: white;
            padding: 16px 32px;
            box-shadow: 0 2px 8px rgba(0, 119, 190, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 3px solid var(--medical-light-blue);
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .navbar-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--medical-dark-blue);
        }

        .navbar-subtitle {
            font-size: 14px;
            color: var(--medical-gray);
            margin-left: 10px;
            font-weight: 500;
        }

        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 18px;
            color: var(--medical-blue);
            cursor: pointer;
            padding: 12px;
            border-radius: 6px;
            min-height: 44px;
        }

        .mobile-menu-toggle:hover {
            background: var(--medical-light-blue);
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        /* ============ ENHANCED SEARCH ============ */
        .search-container {
            position: relative;
            width: 300px;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 48px;
            border: 2px solid var(--medical-light-blue);
            border-radius: var(--border-radius-md);
            font-size: 14px;
            transition: all var(--transition-normal) ease;
            background: white;
            min-height: 44px;
            font-weight: 500;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--medical-blue);
            background: white;
            box-shadow: 0 0 0 3px rgba(0, 119, 190, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--medical-blue);
            font-size: 16px;
            pointer-events: none;
        }

        .search-scope {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--medical-light-blue);
            border: none;
            color: var(--medical-blue);
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 4px;
            min-height: 32px;
            transition: all var(--transition-fast);
        }

        .search-scope:hover {
            background: var(--medical-blue);
            color: white;
        }

        .search-filters {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .search-filter-btn {
            padding: 6px 12px;
            background: var(--medical-light-blue);
            border: 2px solid var(--medical-light-blue);
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            color: var(--medical-blue);
            cursor: pointer;
            transition: all var(--transition-fast);
            min-height: 32px;
        }

        .search-filter-btn:hover {
            background: var(--medical-blue);
            border-color: var(--medical-blue);
            color: white;
        }

        .search-filter-btn.active {
            background: var(--medical-blue);
            border-color: var(--medical-blue);
            color: white;
        }

        /* ============ CONTENT AREA ============ */
        .content-area {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            background: var(--medical-light-gray);
        }

        /* ============ QUICK ACTIONS ============ */
        .quick-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 32px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius-lg);
            flex-wrap: wrap;
            border: 1px solid var(--medical-light-blue);
            box-shadow: var(--shadow-sm);
        }

        .quick-action-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 20px;
            background: white;
            border: 2px solid var(--medical-light-blue);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 14px;
            font-weight: 600;
            min-height: 48px;
            color: var(--medical-dark-blue);
        }

        .quick-action-btn:hover {
            border-color: var(--medical-blue);
            background: var(--medical-light-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 119, 190, 0.1);
        }

        .quick-action-btn i {
            font-size: 16px;
        }

        /* ============ STATS CARDS ============ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal) ease;
            border: 1px solid var(--medical-light-blue);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--medical-blue), var(--medical-teal));
        }

        .stat-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-4px);
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .stat-icon.primary { background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue)); }
        .stat-icon.success { background: linear-gradient(135deg, var(--medical-green), #1b5e20); }
        .stat-icon.warning { background: linear-gradient(135deg, var(--medical-orange), #e65100); }
        .stat-icon.danger { background: linear-gradient(135deg, var(--medical-red), #b71c1c); }

        .stat-content {
            flex: 1;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--medical-dark-blue);
            line-height: 1;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--medical-gray);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ============ EMPTY STATES ============ */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 64px 24px;
            text-align: center;
            color: var(--medical-gray);
        }

        .empty-state-icon {
            font-size: 56px;
            margin-bottom: 20px;
            color: var(--medical-light-blue);
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--medical-dark-blue);
        }

        .empty-state-description {
            font-size: 15px;
            max-width: 400px;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        /* ============ LOADING STATES ============ */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: inherit;
            z-index: 10;
            backdrop-filter: blur(2px);
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--medical-light-blue);
            border-top-color: var(--medical-blue);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .skeleton {
            background: linear-gradient(90deg, var(--medical-light-blue) 25%, #e3f2fd 50%, var(--medical-light-blue) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: var(--border-radius-md);
        }

        @keyframes skeleton-loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        .skeleton-text {
            height: 1em;
            margin-bottom: 0.5em;
        }

        .skeleton-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }

        /* ============ DATA SOURCE INDICATOR ============ */
        .data-source-indicator {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 8px;
            vertical-align: middle;
        }

        .data-source-indicator.live {
            background: var(--medical-green);
            color: white;
        }

        .data-source-indicator.mock {
            background: var(--medical-orange);
            color: white;
        }

        /* ============ ALERT BANNER ============ */
        .alert-banner {
            background: linear-gradient(135deg, var(--medical-red), #b71c1c);
            color: white;
            padding: 16px 24px;
            border-radius: var(--border-radius-md);
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 12px rgba(198, 40, 40, 0.2);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-banner-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .alert-banner-icon {
            font-size: 20px;
        }

        .alert-banner-message {
            font-weight: 500;
        }

        .alert-banner-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            min-height: 36px;
            min-width: 36px;
            transition: background var(--transition-fast);
        }

        .alert-banner-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* ============ QUICK STATS SIDEBAR ============ */
        .quick-stats-sidebar {
            position: fixed;
            right: 0;
            top: 80px;
            width: 300px;
            height: calc(100vh - 80px);
            background: white;
            border-left: 1px solid var(--medical-light-blue);
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
            z-index: 90;
            overflow-y: auto;
            padding: 24px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            -webkit-overflow-scrolling: touch;
        }

        .quick-stats-sidebar.open {
            transform: translateX(0);
        }

        .stats-toggle-btn {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
            color: white;
            border: none;
            border-radius: 8px 0 0 8px;
            padding: 16px 8px;
            cursor: pointer;
            z-index: 91;
            box-shadow: -2px 0 10px rgba(0, 119, 190, 0.3);
            min-height: 60px;
            min-width: 44px;
            transition: all var(--transition-normal);
        }

        .stats-toggle-btn:hover {
            background: linear-gradient(135deg, var(--medical-dark-blue), var(--medical-blue));
            padding-right: 12px;
        }

        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--medical-light-blue);
        }

        .stats-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--medical-dark-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-title i {
            font-size: 18px;
            color: var(--medical-blue);
        }

        .stats-close {
            background: var(--medical-light-blue);
            border: none;
            color: var(--medical-blue);
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            min-height: 44px;
            min-width: 44px;
            transition: all var(--transition-fast);
        }

        .stats-close:hover {
            background: var(--medical-blue);
            color: white;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--medical-light-blue);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-size: 14px;
            color: var(--medical-gray);
            font-weight: 500;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--medical-dark-blue);
        }

        .stat-trend {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 10px;
            margin-left: 8px;
            font-weight: 600;
        }

        .stat-trend.positive {
            background: rgba(46, 125, 50, 0.1);
            color: var(--medical-green);
        }

        .stat-trend.negative {
            background: rgba(198, 40, 40, 0.1);
            color: var(--medical-red);
        }

        /* ============ STAFF PROFILE DESIGN ============ */
        .staff-profile-header {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 2px solid var(--medical-light-blue);
        }

        .staff-avatar-large {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--medical-blue), var(--medical-dark-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 32px;
            flex-shrink: 0;
            box-shadow: 0 8px 24px rgba(0, 119, 190, 0.3);
        }

        .staff-basic-info {
            flex: 1;
        }

        .staff-name {
            font-size: 28px;
            font-weight: 700;
            color: var(--medical-dark-blue);
            margin-bottom: 4px;
        }

        .staff-title {
            font-size: 16px;
            color: var(--medical-gray);
            margin-bottom: 12px;
            font-weight: 500;
        }

        .staff-status {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .staff-status.active {
            background: var(--medical-green);
            color: white;
        }

        .staff-status.inactive {
            background: var(--medical-gray);
            color: white;
        }

        .staff-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .staff-stat-card {
            background: white;
            border-radius: var(--border-radius-md);
            padding: 20px;
            text-align: center;
            border: 1px solid var(--medical-light-blue);
            transition: all var(--transition-fast);
        }

        .staff-stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 119, 190, 0.1);
        }

        .staff-stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--medical-blue);
            margin-bottom: 4px;
        }

        .staff-stat-label {
            font-size: 12px;
            color: var(--medical-gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .info-section {
            margin-bottom: 32px;
        }

        .info-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--medical-dark-blue);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--medical-light-blue);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-section-title i {
            color: var(--medical-blue);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .info-item {
            background: var(--medical-light-blue);
            border-radius: var(--border-radius-md);
            padding: 16px;
        }

        .info-label {
            font-size: 12px;
            color: var(--medical-gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .info-value {
            font-size: 15px;
            color: var(--medical-dark-blue);
            font-weight: 500;
        }

        .info-value.unavailable {
            color: var(--gray-500);
            font-style: italic;
        }

        /* ============ CAPACITY PLANNING ============ */
        .capacity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .capacity-card {
            background: white;
            border-radius: var(--border-radius-md);
            padding: 16px;
            border: 2px solid var(--medical-light-blue);
            transition: all var(--transition-fast);
        }

        .capacity-card:hover {
            border-color: var(--medical-blue);
            transform: translateY(-2px);
        }

        .capacity-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .capacity-unit {
            font-weight: 600;
            color: var(--gray-900);
            font-size: 14px;
        }

        .capacity-status {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 500;
        }

        .capacity-status.low {
            background: rgba(52, 168, 83, 0.1);
            color: var(--medical-green);
        }

        .capacity-status.medium {
            background: rgba(251, 188, 5, 0.1);
            color: var(--medical-orange);
        }

        .capacity-status.high {
            background: rgba(234, 67, 53, 0.1);
            color: var(--medical-red);
        }

        .capacity-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .capacity-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            text-align: center;
            min-height: 36px;
        }

        .capacity-input:focus {
            outline: none;
            border-color: var(--medical-blue);
        }

        .capacity-slash {
            color: var(--gray-400);
            font-weight: 600;
        }

        /* ============ ACTION DROPDOWN ============ */
        .action-dropdown {
            position: relative;
            display: inline-block;
        }

        .action-menu {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background: white;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            min-width: 180px;
            z-index: 1000;
            margin-top: 4px;
        }

        .action-menu.show {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        .action-menu-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background-color var(--transition-fast);
            font-size: 13px;
            color: var(--gray-700);
            text-decoration: none;
            min-height: 44px;
            border-bottom: 1px solid var(--gray-100);
        }

        .action-menu-item:last-child {
            border-bottom: none;
        }

        .action-menu-item:hover {
            background-color: var(--medical-light-blue);
        }

        .action-menu-item i {
            width: 16px;
            text-align: center;
            font-size: 14px;
        }

        .action-menu-item.danger {
            color: var(--medical-red);
        }

        .action-menu-item.danger:hover {
            background-color: rgba(198, 40, 40, 0.1);
        }

        /* ============ TRAINING UNITS GRID ============ */
        .training-units-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .training-unit-card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: 24px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--medical-light-blue);
            transition: all var(--transition-normal);
            position: relative;
        }

        .training-unit-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .training-unit-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .training-unit-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--medical-dark-blue);
        }

        .training-unit-capacity {
            font-size: 14px;
            color: var(--medical-gray);
        }

        .training-unit-residents {
            margin-top: 16px;
        }

        .resident-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            background: var(--gray-50);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
        }

        .resident-name {
            font-weight: 500;
            color: var(--gray-800);
        }

        .resident-level {
            font-size: 12px;
            color: var(--medical-gray);
        }

        /* ============ AUDIT LOGS ============ */
        .audit-filters {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius-md);
            border: 1px solid var(--medical-light-blue);
        }

        .audit-log-item {
            padding: 16px;
            border-bottom: 1px solid var(--medical-light-blue);
            background: white;
        }

        .audit-log-item:last-child {
            border-bottom: none;
        }

        .audit-action {
            font-weight: 600;
            color: var(--medical-dark-blue);
            margin-bottom: 4px;
        }

        .audit-details {
            font-size: 13px;
            color: var(--gray-600);
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .audit-timestamp {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 8px;
        }

        /* ============ PERMISSION MANAGER ============ */
        .permission-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .permission-card {
            background: white;
            border-radius: var(--border-radius-md);
            padding: 20px;
            border: 1px solid var(--medical-light-blue);
        }

        .permission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .permission-role {
            font-weight: 600;
            color: var(--medical-dark-blue);
        }

        .permission-checkboxes {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* ============ MOBILE RESPONSIVE ============ */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0 !important;
            }
            
            .mobile-menu-toggle {
                display: block;
            }
            
            .search-container {
                width: 200px;
            }

            .quick-stats-sidebar {
                width: 100%;
            }
            
            .modal-container {
                width: 95%;
                margin: 10px;
            }

            .training-units-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .navbar-right {
                flex-direction: column;
                align-items: flex-end;
            }
            
            .search-container {
                width: 100%;
                max-width: 200px;
            }
            
            .content-area {
                padding: 20px;
            }
            
            .quick-actions {
                justify-content: center;
            }
            
            .quick-action-btn {
                flex: 1;
                min-width: 160px;
            }

            .stat-card {
                flex-direction: column;
                text-align: center;
                gap: 16px;
            }

            .stat-icon {
                width: 64px;
                height: 64px;
                font-size: 28px;
            }

            .staff-profile-header {
                flex-direction: column;
                text-align: center;
            }

            .staff-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .staff-avatar-large {
                width: 80px;
                height: 80px;
                font-size: 24px;
            }

            .audit-filters {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .login-card {
                padding: 32px 20px;
            }
            
            .modal-container {
                width: 100%;
                margin: 0;
                border-radius: 0;
                max-height: 100vh;
            }
            
            .modal-overlay {
                padding: 0;
            }
            
            .top-navbar {
                padding: 12px 16px;
            }
            
            .navbar-title {
                font-size: 16px;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .quick-action-btn {
                width: 100%;
            }

            .staff-stats {
                grid-template-columns: 1fr;
            }
        }

        /* ============ CUSTOM SCROLLBAR ============ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--medical-light-blue);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--medical-blue);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--medical-dark-blue);
        }
    </style>
</head>
<body>
    <div id="app" v-cloak>

        <!-- ============ TOAST CONTAINER ============ -->
        <div class="toast-container">
            <div v-for="toast in toasts" :key="toast.id" 
                 :class="['toast', `toast-${toast.type}`]" role="alert" aria-live="polite" aria-atomic="true">
                <div class="toast-icon">
                    <i :class="toast.icon"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-title">{{ toast.title }}</div>
                    <div class="toast-message">{{ toast.message }}</div>
                </div>
                <button class="toast-close" @click="removeToast(toast.id)" aria-label="Close notification">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- ============ LOGIN SCREEN ============ -->
        <div v-if="!currentUser" class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="login-logo">
                        <i class="fas fa-lungs"></i>
                        <span class="login-title">NeumoCare</span>
                    </div>
                    <p class="login-subtitle">Pulmonology Department Management System</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" class="form-control" v-model="loginForm.email" placeholder="admin@neumocare.org" aria-required="true">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" v-model="loginForm.password" placeholder="" aria-required="true">
                </div>
                
                <div class="form-group">
                    <label class="form-check">
                        <input type="checkbox" class="form-check-input" v-model="loginForm.remember_me">
                        <span class="form-check-label">Remember me</span>
                    </label>
                </div>
                
                <button class="btn btn-primary btn-lg w-100" @click="handleLogin" :disabled="loading" aria-label="Login to NeumoCare system">
                    <span v-if="loading" class="loading"></span>
                    <span v-else><i class="fas fa-sign-in-alt"></i> Login to NeumoCare</span>
                </button>
                
                <div class="text-center mt-4 text-muted">
                    <small>Demo Credentials: admin@neumocare.org / password123</small>
                </div>
            </div>
        </div>

        <!-- ============ MAIN APPLICATION ============ -->
        <div v-else class="app-layout">
            <!-- Sidebar -->
            <aside class="sidebar" :class="{ 'sidebar-collapsed': sidebarCollapsed, 'mobile-open': mobileMenuOpen }" 
                   aria-label="Main navigation">
                <div class="sidebar-header">
                    <div class="sidebar-logo">
                        <i class="fas fa-lungs"></i>
                        <span>NeumoCare</span>
                    </div>
                    <button class="sidebar-toggle" @click="sidebarCollapsed = !sidebarCollapsed" aria-label="Toggle sidebar">
                        <i class="fas" :class="sidebarCollapsed ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
                    </button>
                </div>
                
                <nav class="sidebar-nav" aria-label="Primary navigation">
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Dashboard</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'daily_operations' }" 
                                   @click.prevent="switchView('daily_operations'); mobileMenuOpen = false"
                                   aria-label="Dashboard overview" :aria-current="currentView === 'daily_operations' ? 'page' : null">
                                    <i class="fas fa-tachometer-alt"></i>
                                    <span>Overview</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Clinical Operations</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'medical_staff' }" 
                                   @click.prevent="switchView('medical_staff'); mobileMenuOpen = false" v-if="hasPermission('medical_staff', 'read')"
                                   :aria-current="currentView === 'medical_staff' ? 'page' : null">
                                    <i class="fas fa-user-md"></i>
                                    <span>Medical Staff</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'patient_census' }" 
                                   @click.prevent="switchView('patient_census'); mobileMenuOpen = false" v-if="hasPermission('patient_census', 'read')"
                                   :aria-current="currentView === 'patient_census' ? 'page' : null">
                                    <i class="fas fa-procedures"></i>
                                    <span>Patient Census</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'oncall_schedule' }" 
                                   @click.prevent="switchView('oncall_schedule'); mobileMenuOpen = false" v-if="hasPermission('oncall_schedule', 'read')"
                                   :aria-current="currentView === 'oncall_schedule' ? 'page' : null">
                                    <i class="fas fa-phone-alt"></i>
                                    <span>On-call Schedule</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Training & Education</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'resident_rotations' }" 
                                   @click.prevent="switchView('resident_rotations'); mobileMenuOpen = false" v-if="hasPermission('resident_rotations', 'read')"
                                   :aria-current="currentView === 'resident_rotations' ? 'page' : null">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>Resident Rotations</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'training_units' }" 
                                   @click.prevent="switchView('training_units'); mobileMenuOpen = false" v-if="hasPermission('training_units', 'read')"
                                   :aria-current="currentView === 'training_units' ? 'page' : null">
                                    <i class="fas fa-clinic-medical"></i>
                                    <span>Training Units</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title">Administration</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'staff_absence' }" 
                                   @click.prevent="switchView('staff_absence'); mobileMenuOpen = false" v-if="hasPermission('staff_absence', 'read')"
                                   :aria-current="currentView === 'staff_absence' ? 'page' : null">
                                    <i class="fas fa-calendar-times"></i>
                                    <span>Staff Absence</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'department_management' }" 
                                   @click.prevent="switchView('department_management'); mobileMenuOpen = false" v-if="hasPermission('system', 'manage_departments')"
                                   :aria-current="currentView === 'department_management' ? 'page' : null">
                                    <i class="fas fa-sitemap"></i>
                                    <span>Departments</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'communications' }" 
                                   @click.prevent="switchView('communications'); mobileMenuOpen = false" v-if="hasPermission('communications', 'read')"
                                   :aria-current="currentView === 'communications' ? 'page' : null">
                                    <i class="fas fa-bullhorn"></i>
                                    <span>Communications</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" v-if="hasPermission('audit', 'read')">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'audit_logs' }" 
                                   @click.prevent="switchView('audit_logs'); mobileMenuOpen = false"
                                   :aria-current="currentView === 'audit_logs' ? 'page' : null">
                                    <i class="fas fa-history"></i>
                                    <span>Audit Logs</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" v-if="hasPermission('permissions', 'manage')">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'permission_manager' }" 
                                   @click.prevent="switchView('permission_manager'); mobileMenuOpen = false"
                                   :aria-current="currentView === 'permission_manager' ? 'page' : null">
                                    <i class="fas fa-user-shield"></i>
                                    <span>Permission Manager</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item" v-if="hasPermission('system', 'read')">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'system_settings' }" 
                                   @click.prevent="switchView('system_settings'); mobileMenuOpen = false"
                                   :aria-current="currentView === 'system_settings' ? 'page' : null">
                                    <i class="fas fa-cog"></i>
                                    <span>System Settings</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
                
                <div class="sidebar-footer">
                    <div class="sidebar-user">
                        <div class="user-avatar" aria-hidden="true">{{ getInitials(currentUser.full_name) }}</div>
                        <div class="user-info">
                            <div class="user-name">{{ currentUser.full_name }}</div>
                            <div class="user-role">{{ getUserRoleDisplay(currentUser.user_role) }}</div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Quick Stats Sidebar -->
            <button class="stats-toggle-btn" @click="toggleStatsSidebar" :aria-label="statsSidebarOpen ? 'Close statistics sidebar' : 'Open statistics sidebar'">
                <i class="fas" :class="statsSidebarOpen ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
            </button>
            
            <div class="quick-stats-sidebar" :class="{ open: statsSidebarOpen }" role="complementary" aria-label="Live statistics">
                <div class="stats-header">
                    <div class="stats-title">
                        <i class="fas fa-chart-line"></i>
                        Live Statistics
                    </div>
                    <button class="stats-close" @click="statsSidebarOpen = false" aria-label="Close statistics">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Department Occupancy</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.occupancy || 0 }}%</span>
                        <span class="stat-trend" :class="liveStats.occupancyTrend > 0 ? 'positive' : 'negative'">
                            {{ liveStats.occupancyTrend > 0 ? '' : '' }}{{ Math.abs(liveStats.occupancyTrend || 0) }}%
                        </span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">On-duty Staff</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 40px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.onDutyStaff || 0 }}</span>
                        <span class="stat-trend" :class="liveStats.staffTrend > 0 ? 'positive' : 'negative'">
                            {{ liveStats.staffTrend > 0 ? '' : '' }}{{ Math.abs(liveStats.staffTrend || 0) }}
                        </span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Pending Requests</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 30px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.pendingRequests || 0 }}</span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">ER Capacity</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 80px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.erCapacity?.current || 0 }}/{{ liveStats.erCapacity?.max || 0 }}</span>
                        <span class="stat-trend" :class="liveStats.erCapacity?.status || ''">{{ liveStats.erCapacity?.status || 'normal' }}</span>
                    </template>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">ICU Capacity</span>
                    <div v-if="loadingStats" class="skeleton skeleton-text" style="width: 80px;"></div>
                    <template v-else>
                        <span class="stat-value">{{ liveStats.icuCapacity?.current || 0 }}/{{ liveStats.icuCapacity?.max || 0 }}</span>
                        <span class="stat-trend" :class="liveStats.icuCapacity?.status || ''">{{ liveStats.icuCapacity?.status || 'normal' }}</span>
                    </template>
                </div>
            </div>

            <!-- Main Content -->
            <main class="main-content" :class="{ 'main-content-expanded': sidebarCollapsed }">
                <!-- Top Navbar -->
                <header class="top-navbar">
                    <div class="navbar-left">
                        <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen" aria-label="Toggle mobile menu">
                            <i class="fas fa-bars"></i>
                        </button>
                        <div>
                            <span class="navbar-title">{{ getCurrentTitle() }}</span>
                            <span class="navbar-subtitle">{{ getCurrentSubtitle() }}</span>
                        </div>
                    </div>
                    
                    <div class="navbar-right">
                        <!-- Enhanced Search -->
                        <div class="search-container">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" :placeholder="getSearchPlaceholder()" 
                                       v-model="searchQuery" @keyup.enter="handleSearch"
                                       aria-label="Search">
                                <button class="search-scope" @click="toggleSearchScope" aria-label="Change search scope">
                                    {{ searchScope }} <i class="fas fa-chevron-down ml-2"></i>
                                </button>
                            </div>
                            
                            <div class="search-filters">
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'all' }" 
                                        @click="setSearchFilter('all')">All</button>
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'staff' }" 
                                        @click="setSearchFilter('staff')">Staff</button>
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'patients' }" 
                                        @click="setSearchFilter('patients')">Patients</button>
                                <button class="search-filter-btn" :class="{ active: searchFilter === 'units' }" 
                                        @click="setSearchFilter('units')">Units</button>
                            </div>
                        </div>
                        
                        <div class="navbar-actions" style="display: flex; align-items: center; gap: 12px;">
                            <div class="notification-badge">
                                <button class="btn btn-icon btn-secondary" @click="showNotifications" 
                                        :aria-label="`${unreadNotifications} unread notifications`">
                                    <i class="fas fa-bell"></i>
                                    <span class="badge badge-danger" v-if="unreadNotifications > 0" style="position: absolute; top: -8px; right: -8px; min-width: 20px; height: 20px; padding: 2px 6px; font-size: 10px;">
                                        {{ unreadNotifications }}
                                    </span>
                                </button>
                            </div>
                            
                            <button class="btn btn-icon btn-secondary" @click="showCommunicationsModal" 
                                    v-if="hasPermission('communications', 'create')" aria-label="Communications">
                                <i class="fas fa-bullhorn"></i>
                            </button>
                            
                            <div class="user-menu" style="position: relative;">
                                <button class="user-menu-toggle" @click="toggleUserMenu" :aria-label="`${currentUser.full_name} profile menu`" style="display: flex; align-items: center; gap: 8px; background: none; border: none; cursor: pointer; padding: 8px; border-radius: var(--border-radius-md); transition: background var(--transition-fast); min-height: 44px;">
                                    <div class="user-avatar">{{ getInitials(currentUser.full_name) }}</div>
                                    <i class="fas fa-chevron-down" style="font-size: 12px;"></i>
                                </button>
                                
                                <div class="action-menu" v-if="userMenuOpen" style="position: absolute; right: 0; top: 100%; margin-top: 8px; min-width: 200px;">
                                    <div class="action-menu-item" @click="showUserProfile">
                                        <i class="fas fa-user"></i>
                                        <span>Profile Settings</span>
                                    </div>
                                    <div class="action-menu-item" @click="showSystemSettingsModal" v-if="hasPermission('system', 'read')">
                                        <i class="fas fa-cog"></i>
                                        <span>System Settings</span>
                                    </div>
                                    <div class="action-menu-item" @click="showPermissionManager" v-if="hasPermission('permissions', 'manage')">
                                        <i class="fas fa-user-shield"></i>
                                        <span>Permission Manager</span>
                                    </div>
                                    <div class="action-menu-item danger" @click="handleLogout">
                                        <i class="fas fa-sign-out-alt"></i>
                                        <span>Logout</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Content Area -->
                <div class="content-area">
                    <!-- Dynamic Alert Banner -->
                    <div v-if="activeAlerts.length > 0" class="alert-banner">
                        <div class="alert-banner-content">
                            <i class="fas fa-exclamation-triangle alert-banner-icon"></i>
                            <span class="alert-banner-message">
                                {{ activeAlerts[0].message }}
                                <span v-if="activeAlerts.length > 1"> (and {{ activeAlerts.length - 1 }} more)</span>
                            </span>
                        </div>
                        <button class="alert-banner-close" @click="dismissAlert(activeAlerts[0].id)" aria-label="Dismiss alert">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Breadcrumb Navigation -->
                    <nav class="breadcrumb" style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px; padding: 12px 0; border-bottom: 2px solid var(--medical-light-blue); flex-wrap: wrap;" aria-label="Breadcrumb">
                        <div class="breadcrumb-item" @click="switchView('daily_operations')" style="cursor: pointer; display: flex; align-items: center; gap: 8px; color: var(--medical-gray); font-size: 14px; transition: color var(--transition-fast); text-decoration: none; padding: 4px 8px; border-radius: 4px;">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </div>
                        <div class="breadcrumb-separator" style="color: var(--gray-400);">/</div>
                        <div class="breadcrumb-item active" style="display: flex; align-items: center; gap: 8px; color: var(--medical-blue); font-size: 14px; font-weight: 500; padding: 4px 8px;" aria-current="page">
                            {{ getCurrentTitle() }}
                        </div>
                    </nav>

                    <!-- Daily Operations View -->
                    <div v-if="currentView === 'daily_operations'">
                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <div class="quick-action-btn" @click="showAddMedicalStaffModal" v-if="hasPermission('medical_staff', 'create')">
                                <i class="fas fa-user-plus" style="color: var(--medical-green);"></i>
                                Add Medical Staff
                            </div>
                            <div class="quick-action-btn" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                <i class="fas fa-phone-alt" style="color: var(--medical-blue);"></i>
                                Schedule On-call
                            </div>
                            <div class="quick-action-btn" @click="showAddAbsenceModal" v-if="hasPermission('staff_absence', 'create')">
                                <i class="fas fa-calendar-times" style="color: var(--medical-orange);"></i>
                                Document Absence
                            </div>
                            <div class="quick-action-btn" @click="showQuickPlacementModal" v-if="hasPermission('placements', 'create')">
                                <i class="fas fa-user-md" style="color: var(--medical-teal);"></i>
                                Quick Placement
                            </div>
                            <div class="quick-action-btn" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                <i class="fas fa-calendar-alt" style="color: var(--medical-blue);"></i>
                                Add Rotation
                            </div>
                            <div class="quick-action-btn" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                <i class="fas fa-bullhorn" style="color: var(--medical-red);"></i>
                                Post Announcement
                            </div>
                        </div>

                        <!-- Stats Overview -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon primary">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.totalStaff || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Total Medical Staff</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon success">
                                    <i class="fas fa-procedures"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.activePatients || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Active Patients</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon warning">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.todayAppointments || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Today's Appointments</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon danger">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value">
                                        <span v-if="loadingStats" class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                                        <span v-else>{{ stats.pendingAlerts || 0 }}</span>
                                    </div>
                                    <div class="stat-label">Pending Alerts</div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Announcements -->
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-bullhorn"></i>
                                    Recent Announcements
                                </div>
                                <button class="btn btn-sm btn-primary" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                    <i class="fas fa-plus"></i> New Announcement
                                </button>
                            </div>
                            <div class="card-content">
                                <div v-if="loadingAnnouncements" class="loading-overlay">
                                    <div class="loading-spinner"></div>
                                </div>
                                <div v-else-if="recentAnnouncements.length === 0" class="empty-state">
                                    <i class="fas fa-bullhorn empty-state-icon"></i>
                                    <div class="empty-state-title">No Announcements</div>
                                    <div class="empty-state-description">
                                        No announcements have been posted yet.
                                    </div>
                                    <button class="btn btn-primary mt-4" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                        <i class="fas fa-plus"></i> Create Announcement
                                    </button>
                                </div>
                                <div v-else>
                                    <div v-for="announcement in recentAnnouncements.slice(0, 3)" :key="announcement.id" style="margin-bottom: 16px; padding: 16px; border: 1px solid var(--medical-light-blue); border-radius: var(--border-radius-md); transition: all var(--transition-fast);" @mouseenter="this.style.backgroundColor='var(--medical-light-blue)'" @mouseleave="this.style.backgroundColor='white'">
                                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                                            <div>
                                                <div style="font-weight: 600; color: var(--medical-dark-blue);">{{ announcement.title }}</div>
                                                <div style="font-size: 12px; color: var(--medical-gray);">By: {{ announcement.author }}  {{ formatTimeAgo(announcement.created_at) }}</div>
                                            </div>
                                            <span class="badge" :class="`badge-${announcement.priority}`">
                                                {{ announcement.priority }}
                                            </span>
                                        </div>
                                        <p style="color: var(--gray-700); margin-bottom: 12px;">{{ announcement.content }}</p>
                                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: var(--gray-500);">
                                            <span>Expires: {{ announcement.expires_at ? formatDateTime(announcement.expires_at) : 'Never' }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Today's On-call Schedule -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-phone-alt"></i>
                                    Today's On-call Schedule
                                </div>
                                <button class="btn btn-sm btn-primary" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                    <i class="fas fa-plus"></i> Add Schedule
                                </button>
                            </div>
                            <div class="card-content">
                                <div v-if="loadingSchedule" class="loading-overlay">
                                    <div class="loading-spinner"></div>
                                </div>
                                <div v-else-if="todaysOnCall.length === 0" class="empty-state">
                                    <i class="fas fa-phone-slash empty-state-icon"></i>
                                    <div class="empty-state-title">No On-call Scheduled</div>
                                    <div class="empty-state-description">
                                        No physicians are scheduled for on-call duty today
                                    </div>
                                    <button class="btn btn-primary mt-4" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                        <i class="fas fa-plus"></i> Schedule On-call
                                    </button>
                                </div>
                                <div v-else class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Physician</th>
                                                <th>Shift Time</th>
                                                <th>Role</th>
                                                <th>Contact</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="schedule in todaysOnCall" :key="schedule.id">
                                                <td>{{ schedule.physician_name }}</td>
                                                <td>{{ formatTimeRange(schedule.start_time, schedule.end_time) }}</td>
                                                <td>
                                                    <span class="badge badge-primary">{{ schedule.role }}</span>
                                                </td>
                                                <td>{{ schedule.contact_number || 'N/A' }}</td>
                                                <td>
                                                    <div class="action-dropdown">
                                                        <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Schedule actions">
                                                            <i class="fas fa-ellipsis-v"></i>
                                                        </button>
                                                        <div class="action-menu">
                                                            <div class="action-menu-item" @click="editOnCallSchedule(schedule)" v-if="hasPermission('oncall_schedule', 'update')">
                                                                <i class="fas fa-edit"></i>
                                                                <span>Edit</span>
                                                            </div>
                                                            <div class="action-menu-item danger" @click="deleteOnCallSchedule(schedule.id)" v-if="hasPermission('oncall_schedule', 'delete')">
                                                                <i class="fas fa-trash"></i>
                                                                <span>Delete</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Medical Staff View -->
                    <div v-if="currentView === 'medical_staff'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Medical Staff Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage all medical staff with comprehensive profiles</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddMedicalStaffModal" 
                                    v-if="hasPermission('medical_staff', 'create')">
                                <i class="fas fa-plus"></i> Add Medical Staff
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight: 500;">Search</div>
                                <input type="text" class="form-control form-control-sm" v-model="staffSearch" placeholder="Name, ID, or email...">
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Staff Type</div>
                                <select class="form-select form-select-sm" v-model="staffFilter.staff_type">
                                    <option value="">All Types</option>
                                    <option value="medical_resident">Medical Resident</option>
                                    <option value="attending_physician">Attending Physician</option>
                                    <option value="fellow">Fellow</option>
                                    <option value="nurse_practitioner">Nurse Practitioner</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Status</div>
                                <select class="form-select form-select-sm" v-model="staffFilter.employment_status">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="on_leave">On Leave</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetStaffFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyStaffFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Staff Table -->
                        <div class="card">
                            <div v-if="loadingStaff" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredMedicalStaff.length === 0" class="empty-state">
                                <i class="fas fa-user-md empty-state-icon"></i>
                                <div class="empty-state-title">No Medical Staff Found</div>
                                <div class="empty-state-description">
                                    Try adjusting your filters or add new medical staff to get started.
                                </div>
                                <button class="btn btn-primary mt-4" @click="showAddMedicalStaffModal" v-if="hasPermission('medical_staff', 'create')">
                                    <i class="fas fa-plus"></i> Add Medical Staff
                                </button>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Staff Type</th>
                                            <th>Staff ID</th>
                                            <th>Department</th>
                                            <th>Status</th>
                                            <th>Last Active</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="staff in filteredMedicalStaff" :key="staff.id">
                                            <td style="cursor: pointer;" @click="viewStaffDetails(staff)">
                                                <div class="flex items-center gap-3" style="display: flex; align-items: center; gap: 12px;">
                                                    <div class="user-avatar" aria-hidden="true">{{ getInitials(staff.full_name) }}</div>
                                                    <div>
                                                        <div class="font-medium" style="font-weight: 500; color: var(--medical-dark-blue);">{{ staff.full_name }}</div>
                                                        <div class="text-sm text-gray-500">{{ staff.professional_email }}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="badge" :class="getStaffTypeClass(staff.staff_type)">
                                                    {{ formatStaffType(staff.staff_type) }}
                                                </span>
                                            </td>
                                            <td>{{ staff.staff_id }}</td>
                                            <td>{{ getDepartmentName(staff.department_id) || 'Unassigned' }}</td>
                                            <td>
                                                <span class="badge" :class="staff.employment_status === 'active' ? 'status-available' : staff.employment_status === 'on_leave' ? 'status-busy' : 'status-critical'">
                                                    {{ formatEmploymentStatus(staff.employment_status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <span class="updated-timestamp" style="font-size: 12px; color: var(--medical-gray); display: flex; align-items: center; gap: 4px;">
                                                    <i class="fas fa-clock"></i> {{ formatTimeAgo(staff.last_activity) }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Staff actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="viewStaffDetails(staff)">
                                                            <i class="fas fa-eye"></i>
                                                            <span>View Profile</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="editMedicalStaff(staff)" v-if="hasPermission('medical_staff', 'update')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="assignRotationToStaff(staff)" v-if="hasPermission('resident_rotations', 'create') && staff.staff_type === 'medical_resident'">
                                                            <i class="fas fa-calendar-alt"></i>
                                                            <span>Assign Rotation</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteMedicalStaff(staff.id)" v-if="hasPermission('medical_staff', 'delete')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Department Management View -->
                    <div v-if="currentView === 'department_management'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Department Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage departments and clinical units for organizational structure</p>
                            </div>
                            <div class="flex gap-2" style="display: flex; gap: 8px;">
                                <button class="btn btn-primary" @click="showAddDepartmentModal" 
                                        v-if="hasPermission('system', 'manage_departments')">
                                    <i class="fas fa-plus"></i> Add Department
                                </button>
                                <button class="btn btn-success" @click="showAddClinicalUnitModal" 
                                        v-if="hasPermission('system', 'manage_departments')">
                                    <i class="fas fa-plus"></i> Add Clinical Unit
                                </button>
                            </div>
                        </div>

                        <!-- Departments Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; margin-bottom: 32px;">
                            <div v-for="department in departments" :key="department.id" class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-hospital"></i>
                                        {{ department.name }}
                                    </div>
                                    <span class="badge" :class="department.status === 'active' ? 'status-available' : 'status-busy'">
                                        {{ department.status }}
                                    </span>
                                </div>
                                
                                <div class="mb-4">
                                    <div class="text-sm text-gray-600 mb-2">Department Code: {{ department.code }}</div>
                                    <div class="text-sm text-gray-600 mb-4">{{ department.description || 'No description available' }}</div>
                                    
                                    <div class="mt-3">
                                        <div class="text-sm font-medium mb-2">Associated Clinical Units:</div>
                                        <div class="flex flex-wrap gap-2">
                                            <span v-for="unit in getDepartmentUnits(department.id)" :key="unit.id" 
                                                  style="background: var(--medical-light-blue); color: var(--medical-blue); font-size: 12px; padding: 4px 12px; border-radius: 20px;">
                                                {{ unit.name }}
                                            </span>
                                            <span v-if="getDepartmentUnits(department.id).length === 0" class="text-gray-500 text-sm">
                                                No units assigned
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex gap-2" style="display: flex; gap: 8px;">
                                    <button class="btn btn-sm btn-primary flex-1" @click="editDepartment(department)"
                                            v-if="hasPermission('system', 'manage_departments')">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <div class="action-dropdown">
                                        <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Department actions">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                        <div class="action-menu">
                                            <div class="action-menu-item" @click="viewDepartmentDetails(department)">
                                                <i class="fas fa-eye"></i>
                                                <span>View Details</span>
                                            </div>
                                            <div class="action-menu-item danger" @click="deleteDepartment(department.id)" v-if="hasPermission('system', 'manage_departments')">
                                                <i class="fas fa-trash"></i>
                                                <span>Delete</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Clinical Units Table -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-clinic-medical"></i>
                                    All Clinical Units
                                </div>
                            </div>
                            <div v-if="loading" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="clinicalUnits.length === 0" class="empty-state">
                                <i class="fas fa-clinic-medical empty-state-icon"></i>
                                <div class="empty-state-title">No Clinical Units</div>
                                <div class="empty-state-description">
                                    No clinical units have been created yet.
                                </div>
                                <button class="btn btn-primary mt-4" @click="showAddClinicalUnitModal" v-if="hasPermission('system', 'manage_departments')">
                                    <i class="fas fa-plus"></i> Add Clinical Unit
                                </button>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Unit Name</th>
                                            <th>Unit Code</th>
                                            <th>Department</th>
                                            <th>Type</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="unit in clinicalUnits" :key="unit.id">
                                            <td>{{ unit.name }}</td>
                                            <td>{{ unit.code }}</td>
                                            <td>{{ getDepartmentName(unit.department_id) }}</td>
                                            <td>
                                                <span class="badge" :class="unit.unit_type === 'clinical' ? 'badge-primary' : 'badge-info'">
                                                    {{ unit.unit_type }}
                                                </span>
                                            </td>
                                            <td>
                                                <span class="badge" :class="unit.status === 'active' ? 'status-available' : 'status-busy'">
                                                    {{ unit.status }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Unit actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="editClinicalUnit(unit)" v-if="hasPermission('system', 'manage_departments')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteClinicalUnit(unit.id)" v-if="hasPermission('system', 'manage_departments')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Training Units View -->
                    <div v-if="currentView === 'training_units'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Training Units Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage clinical training units and resident assignments</p>
                            </div>
                            <div class="flex gap-2" style="display: flex; gap: 8px;">
                                <button class="btn btn-primary" @click="showAddTrainingUnitModal" v-if="hasPermission('training_units', 'create')">
                                    <i class="fas fa-plus"></i> Add Training Unit
                                </button>
                                <button class="btn btn-success" @click="showBulkAssignModal" v-if="hasPermission('training_units', 'update')">
                                    <i class="fas fa-users"></i> Bulk Assign
                                </button>
                            </div>
                        </div>

                        <!-- Training Units Grid -->
                        <div class="training-units-grid">
                            <div v-for="unit in trainingUnits" :key="unit.id" class="training-unit-card">
                                <div class="training-unit-header">
                                    <div>
                                        <div class="training-unit-title">{{ unit.name }}</div>
                                        <div class="training-unit-capacity">{{ unit.current_residents }}/{{ unit.max_capacity }} residents</div>
                                    </div>
                                    <span class="badge" :class="unit.status === 'active' ? 'status-available' : 'status-busy'">
                                        {{ unit.status }}
                                    </span>
                                </div>
                                
                                <div class="text-sm text-gray-600 mb-4">{{ unit.description || 'No description available' }}</div>
                                
                                <div class="training-unit-residents">
                                    <div class="text-sm font-medium mb-2">Assigned Residents:</div>
                                    <div v-if="getUnitResidents(unit.id).length === 0" class="text-sm text-gray-500 italic">
                                        No residents assigned
                                    </div>
                                    <div v-else>
                                        <div v-for="resident in getUnitResidents(unit.id)" :key="resident.id" class="resident-item">
                                            <div>
                                                <div class="resident-name">{{ resident.full_name }}</div>
                                                <div class="resident-level">{{ formatTrainingLevel(resident.training_level) }}</div>
                                            </div>
                                            <button class="btn btn-sm btn-outline-danger" @click="removeResidentFromUnit(resident.id, unit.id)" v-if="hasPermission('training_units', 'update')">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex gap-2 mt-4">
                                    <button class="btn btn-sm btn-primary flex-1" @click="editTrainingUnit(unit)" v-if="hasPermission('training_units', 'update')">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm btn-secondary" @click="assignResidentToUnit(unit)" v-if="hasPermission('training_units', 'update')">
                                        <i class="fas fa-user-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Resident Rotations View -->
                    <div v-if="currentView === 'resident_rotations'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Resident Rotations</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage resident rotations and assignments</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                <i class="fas fa-plus"></i> Add Rotation
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Resident</div>
                                <select class="form-select form-select-sm" v-model="rotationFilter.resident_id">
                                    <option value="">All Residents</option>
                                    <option v-for="resident in residents" :key="resident.id" :value="resident.id">
                                        {{ resident.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Status</div>
                                <select class="form-select form-select-sm" v-model="rotationFilter.status">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetRotationFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyRotationFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Rotations Table -->
                        <div class="card">
                            <div v-if="loadingRotations" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredRotations.length === 0" class="empty-state">
                                <i class="fas fa-calendar-alt empty-state-icon"></i>
                                <div class="empty-state-title">No Rotations Found</div>
                                <div class="empty-state-description">
                                    Try adjusting your filters or add new rotations to get started.
                                </div>
                                <button class="btn btn-primary mt-4" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                    <i class="fas fa-plus"></i> Add Rotation
                                </button>
                            </div>
                            <div v-else class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Resident</th>
                                            <th>Training Unit</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Supervisor</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="rotation in filteredRotations" :key="rotation.id">
                                            <td>{{ getResidentName(rotation.resident_id) }}</td>
                                            <td>{{ getTrainingUnitName(rotation.training_unit_id) }}</td>
                                            <td>{{ formatDate(rotation.start_date) }}</td>
                                            <td>{{ formatDate(rotation.end_date) }}</td>
                                            <td>
                                                <span class="badge" :class="getRotationStatusClass(rotation.status)">
                                                    {{ formatRotationStatus(rotation.status) }}
                                                </span>
                                            </td>
                                            <td>{{ getSupervisorName(rotation.supervisor_id) || 'Not assigned' }}</td>
                                            <td>
                                                <div class="action-dropdown">
                                                    <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Rotation actions">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    <div class="action-menu">
                                                        <div class="action-menu-item" @click="viewRotationDetails(rotation)">
                                                            <i class="fas fa-eye"></i>
                                                            <span>View Details</span>
                                                        </div>
                                                        <div class="action-menu-item" @click="editRotation(rotation)" v-if="hasPermission('resident_rotations', 'update')">
                                                            <i class="fas fa-edit"></i>
                                                            <span>Edit</span>
                                                        </div>
                                                        <div class="action-menu-item danger" @click="deleteRotation(rotation.id)" v-if="hasPermission('resident_rotations', 'delete')">
                                                            <i class="fas fa-trash"></i>
                                                            <span>Delete</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Staff Absence View -->
                    <div v-if="currentView === 'staff_absence'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Staff Absence Management</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Track and manage staff absences and coverage</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddAbsenceModal" v-if="hasPermission('staff_absence', 'create')">
                                <i class="fas fa-plus"></i> Document Absence
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filter-bar" style="display: flex; gap: 12px; align-items: center; padding: 16px; background: white; border-radius: var(--border-radius-md); margin-bottom: 20px; flex-wrap: wrap; border: 1px solid var(--medical-light-blue);">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Staff Member</div>
                                <select class="form-select form-select-sm" v-model="absenceFilter.staff_id">
                                    <option value="">All Staff</option>
                                    <option v-for="staff in medicalStaff" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Status</div>
                                <select class="form-select form-select-sm" v-model="absenceFilter.status">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; min-width: 180px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Date Range</div>
                                <input type="date" class="form-control form-control-sm" v-model="absenceFilter.start_date">
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; margin-left: auto;">
                                <button class="btn btn-sm btn-secondary" @click="resetAbsenceFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyAbsenceFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Absence Calendar View -->
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-calendar"></i>
                                    Absence Calendar
                                </div>
                                <div class="flex gap-2">
                                    <button class="btn btn-sm btn-secondary" @click="showAbsenceCalendar('month')">Month</button>
                                    <button class="btn btn-sm btn-secondary" @click="showAbsenceCalendar('week')">Week</button>
                                    <button class="btn btn-sm btn-secondary" @click="showAbsenceCalendar('list')">List</button>
                                </div>
                            </div>
                            <div class="p-4">
                                <div v-if="loadingAbsences" class="loading-overlay">
                                    <div class="loading-spinner"></div>
                                </div>
                                <div v-else-if="filteredAbsences.length === 0" class="empty-state">
                                    <i class="fas fa-calendar-times empty-state-icon"></i>
                                    <div class="empty-state-title">No Absences Found</div>
                                    <div class="empty-state-description">
                                        No staff absences have been documented yet.
                                    </div>
                                </div>
                                <div v-else class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Staff Member</th>
                                                <th>Absence Reason</th>
                                                <th>Start Date</th>
                                                <th>End Date</th>
                                                <th>Duration</th>
                                                <th>Coverage</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="absence in filteredAbsences" :key="absence.id">
                                                <td>{{ getStaffName(absence.staff_member_id) }}</td>
                                                <td>{{ formatAbsenceReason(absence.absence_reason) }}</td>
                                                <td>{{ formatDate(absence.start_date) }}</td>
                                                <td>{{ formatDate(absence.end_date) }}</td>
                                                <td>{{ calculateAbsenceDuration(absence.start_date, absence.end_date) }} days</td>
                                                <td>{{ getStaffName(absence.replacement_staff_id) || 'No coverage' }}</td>
                                                <td>
                                                    <span class="badge" :class="getAbsenceStatusClass(absence.status)">
                                                        {{ formatAbsenceStatus(absence.status) }}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div class="action-dropdown">
                                                        <button class="btn btn-sm btn-secondary" @click="toggleActionMenu($event)" aria-label="Absence actions">
                                                            <i class="fas fa-ellipsis-v"></i>
                                                        </button>
                                                        <div class="action-menu">
                                                            <div class="action-menu-item" @click="viewAbsenceDetails(absence)">
                                                                <i class="fas fa-eye"></i>
                                                                <span>View Details</span>
                                                            </div>
                                                            <div class="action-menu-item" @click="editAbsence(absence)" v-if="hasPermission('staff_absence', 'update')">
                                                                <i class="fas fa-edit"></i>
                                                                <span>Edit</span>
                                                            </div>
                                                            <div class="action-menu-item" @click="assignCoverage(absence)" v-if="hasPermission('staff_absence', 'update') && !absence.replacement_staff_id">
                                                                <i class="fas fa-user-md"></i>
                                                                <span>Assign Coverage</span>
                                                            </div>
                                                            <div class="action-menu-item danger" @click="deleteAbsence(absence.id)" v-if="hasPermission('staff_absence', 'delete')">
                                                                <i class="fas fa-trash"></i>
                                                                <span>Delete</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Communications View -->
                    <div v-if="currentView === 'communications'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Department Communications</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Announcements, capacity planning, and quick updates</p>
                            </div>
                            <button class="btn btn-primary" @click="showCommunicationsModal" 
                                    v-if="hasPermission('communications', 'create')">
                                <i class="fas fa-plus"></i> New Communication
                            </button>
                        </div>

                        <!-- Communications Feed -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6" style="display: grid; grid-template-columns: 1fr; gap: 24px;">
                            <div class="lg:col-span-2">
                                <div class="card mb-6">
                                    <div class="card-header">
                                        <div class="card-title">
                                            <i class="fas fa-bullhorn"></i>
                                            Recent Announcements
                                        </div>
                                    </div>
                                    <div class="activity-feed" style="background: white; border-radius: var(--border-radius-lg); padding: 24px;">
                                        <div v-for="announcement in recentAnnouncements" :key="announcement.id" style="display: flex; gap: 16px; padding: 16px 0; border-bottom: 1px solid var(--medical-light-blue);">
                                            <div :class="`bg-${getPriorityColor(announcement.priority_level)}`" style="width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 14px; flex-shrink: 0;">
                                                <i class="fas fa-bullhorn"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div style="font-weight: 600; margin-bottom: 4px;">{{ announcement.announcement_title }}</div>
                                                <div style="font-size: 14px; color: var(--gray-800); margin-bottom: 4px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">{{ announcement.announcement_content }}</div>
                                                <div style="font-size: 12px; color: var(--gray-500);">
                                                    {{ formatDateTime(announcement.publish_start_date) }}  
                                                    <span class="badge badge-sm" :class="`badge-${getPriorityColor(announcement.priority_level)}`">
                                                        {{ announcement.priority_level }}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <div class="card mb-6">
                                    <div class="card-header">
                                        <div class="card-title">
                                            <i class="fas fa-bed"></i>
                                            Today's Capacity
                                        </div>
                                        <span class="updated-timestamp" style="font-size: 11px; color: var(--medical-gray); display: flex; align-items: center; gap: 4px;">
                                            <i class="fas fa-sync"></i> Just now
                                        </span>
                                    </div>
                                    <div class="p-4">
                                        <div class="capacity-grid">
                                            <div class="capacity-card">
                                                <div class="capacity-card-header">
                                                    <div class="capacity-unit">Emergency Room</div>
                                                    <div class="capacity-status" :class="currentCapacity.er.status">
                                                        {{ currentCapacity.er.status }}
                                                    </div>
                                                </div>
                                                <div class="capacity-input-group">
                                                    <input type="number" class="capacity-input" v-model="currentCapacity.er.current" min="0" :max="currentCapacity.er.max" aria-label="ER current patients">
                                                    <span class="capacity-slash">/</span>
                                                    <input type="number" class="capacity-input" v-model="currentCapacity.er.max" min="1" aria-label="ER max capacity">
                                                </div>
                                            </div>
                                            
                                            <div class="capacity-card">
                                                <div class="capacity-card-header">
                                                    <div class="capacity-unit">Pulmo ICU</div>
                                                    <div class="capacity-status" :class="currentCapacity.icu.status">
                                                        {{ currentCapacity.icu.status }}
                                                    </div>
                                                </div>
                                                <div class="capacity-input-group">
                                                    <input type="number" class="capacity-input" v-model="currentCapacity.icu.current" min="0" :max="currentCapacity.icu.max" aria-label="ICU current patients">
                                                    <span class="capacity-slash">/</span>
                                                    <input type="number" class="capacity-input" v-model="currentCapacity.icu.max" min="1" aria-label="ICU max capacity">
                                                </div>
                                            </div>
                                        </div>
                                        <button class="btn btn-primary w-full mt-4" @click="updateCapacity" v-if="hasPermission('communications', 'update')">
                                            <i class="fas fa-save"></i> Update Capacity
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Audit Logs View -->
                    <div v-if="currentView === 'audit_logs'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Audit Logs</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">System activity and user action tracking</p>
                            </div>
                            <button class="btn btn-primary" @click="exportAuditLogs" v-if="hasPermission('audit', 'export')">
                                <i class="fas fa-download"></i> Export Logs
                            </button>
                        </div>

                        <!-- Audit Filters -->
                        <div class="audit-filters">
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Date Range</div>
                                <input type="date" class="form-control form-control-sm" v-model="auditFilters.dateRange">
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">Action Type</div>
                                <select class="form-select form-select-sm" v-model="auditFilters.actionType">
                                    <option value="">All Actions</option>
                                    <option value="create">Create</option>
                                    <option value="update">Update</option>
                                    <option value="delete">Delete</option>
                                    <option value="login">Login</option>
                                    <option value="logout">Logout</option>
                                </select>
                            </div>
                            <div class="filter-group" style="display: flex; flex-direction: column; gap: 4px; flex: 1;">
                                <div class="filter-label" style="font-size: 12px; color: var(--medical-gray); font-weight=500;">User</div>
                                <select class="form-select form-select-sm" v-model="auditFilters.userId">
                                    <option value="">All Users</option>
                                    <option v-for="user in users" :key="user.id" :value="user.id">
                                        {{ user.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="filter-actions" style="display: flex; gap: 8px; align-items: flex-end;">
                                <button class="btn btn-sm btn-secondary" @click="resetAuditFilters">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-sm btn-primary" @click="applyAuditFilters">
                                    <i class="fas fa-filter"></i> Apply
                                </button>
                            </div>
                        </div>

                        <!-- Audit Logs List -->
                        <div class="card">
                            <div v-if="loadingAuditLogs" class="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                            <div v-else-if="filteredAuditLogs.length === 0" class="empty-state">
                                <i class="fas fa-history empty-state-icon"></i>
                                <div class="empty-state-title">No Audit Logs Found</div>
                                <div class="empty-state-description">
                                    No audit logs match your filter criteria.
                                </div>
                            </div>
                            <div v-else>
                                <div v-for="log in filteredAuditLogs" :key="log.id" class="audit-log-item">
                                    <div class="audit-action">{{ formatAuditAction(log.action) }}</div>
                                    <div class="audit-details">
                                        <span>User: {{ getUserName(log.user_id) }}</span>
                                        <span>Module: {{ log.module }}</span>
                                        <span>IP: {{ log.ip_address }}</span>
                                    </div>
                                    <div class="audit-timestamp">
                                        <i class="fas fa-clock"></i> {{ formatDateTime(log.created_at) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Permission Manager View -->
                    <div v-if="currentView === 'permission_manager'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">Permission Manager</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Manage user permissions and access controls</p>
                            </div>
                            <button class="btn btn-primary" @click="showAddRoleModal" v-if="hasPermission('permissions', 'manage')">
                                <i class="fas fa-plus"></i> Add Role
                            </button>
                        </div>

                        <!-- Permission Grid -->
                        <div class="permission-grid">
                            <div v-for="role in userRoles" :key="role.id" class="permission-card">
                                <div class="permission-header">
                                    <div class="permission-role">{{ role.name }}</div>
                                    <div class="flex gap-2">
                                        <button class="btn btn-sm btn-primary" @click="editRole(role)" v-if="hasPermission('permissions', 'manage')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-danger" @click="deleteRole(role.id)" v-if="hasPermission('permissions', 'manage') && role.name !== 'Administrator'">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="permission-checkboxes">
                                    <div v-for="permission in availablePermissions" :key="permission.id" class="form-check">
                                        <input type="checkbox" class="form-check-input" 
                                               :checked="roleHasPermission(role.id, permission.id)"
                                               @change="toggleRolePermission(role.id, permission.id)"
                                               :id="`role-${role.id}-permission-${permission.id}`">
                                        <label class="form-check-label" :for="`role-${role.id}-permission-${permission.id}`">
                                            {{ formatPermissionName(permission.name) }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- User Permissions Table -->
                        <div class="card mt-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-users"></i>
                                    User Permissions
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Role</th>
                                            <th>Permissions</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="user in users" :key="user.id">
                                            <td>{{ user.full_name }}</td>
                                            <td>{{ user.user_role }}</td>
                                            <td>
                                                <span class="badge badge-sm" v-for="permission in getUserPermissions(user.id)" :key="permission">
                                                    {{ permission }}
                                                </span>
                                            </td>
                                            <td>
                                                <button class="btn btn-sm btn-primary" @click="editUserPermissions(user)" v-if="hasPermission('permissions', 'manage')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- System Settings View -->
                    <div v-if="currentView === 'system_settings'">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                            <div>
                                <h2 class="section-title" style="font-size: 24px; font-weight: 600; color: var(--medical-dark-blue);">System Settings</h2>
                                <p class="text-muted" style="color: var(--medical-gray);">Configure system preferences and behavior</p>
                            </div>
                            <button class="btn btn-primary" @click="saveSystemSettings">
                                <i class="fas fa-save"></i> Save Settings
                            </button>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="modal-section">
                                    <div class="modal-section-title">
                                        <i class="fas fa-hospital"></i>
                                        Hospital Information
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="form-group">
                                            <label class="form-label">Hospital Name</label>
                                            <input type="text" class="form-control" v-model="systemSettings.hospital_name">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Default Department</label>
                                            <select class="form-select" v-model="systemSettings.default_department_id">
                                                <option value="">Select Default Department</option>
                                                <option v-for="department in departments" :key="department.id" :value="department.id">
                                                    {{ department.name }}
                                                </option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Max Residents per Training Unit</label>
                                            <input type="number" class="form-control" v-model="systemSettings.max_residents_per_unit" min="1" max="50">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Default Rotation Duration (weeks)</label>
                                            <input type="number" class="form-control" v-model="systemSettings.default_rotation_duration" min="1" max="52">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="modal-section">
                                    <div class="modal-section-title">
                                        <i class="fas fa-shield-alt"></i>
                                        Security Settings
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.enable_audit_logging">
                                            <span class="form-check-label">Enable Audit Logging</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.require_mfa">
                                            <span class="form-check-label">Require MFA Authentication</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.maintenance_mode">
                                            <span class="form-check-label">Maintenance Mode</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="modal-section">
                                    <div class="modal-section-title">
                                        <i class="fas fa-bell"></i>
                                        Notification Settings
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.notifications_enabled">
                                            <span class="form-check-label">Enable Email Notifications</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.absence_notifications">
                                            <span class="form-check-label">Staff Absence Notifications</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" v-model="systemSettings.announcement_notifications">
                                            <span class="form-check-label">Announcement Notifications</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

        <!-- ============ MODALS ============ -->
        
        <!-- MODAL 1: Staff Details Modal -->
        <div v-if="staffDetailsModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="staff-details-title">
            <div class="modal-container modal-xwide">
                <div class="modal-header">
                    <div class="modal-title" id="staff-details-title">
                        <i class="fas fa-user-md"></i>
                        Staff Profile
                    </div>
                    <button class="modal-close" @click="staffDetailsModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="staff-profile-header">
                        <div class="staff-avatar-large" aria-hidden="true">{{ getInitials(staffDetailsModal.staff.full_name) }}</div>
                        <div class="staff-basic-info">
                            <div class="staff-name">{{ staffDetailsModal.staff.full_name }}</div>
                            <div class="staff-title">{{ formatStaffType(staffDetailsModal.staff.staff_type) }}</div>
                            <span class="staff-status" :class="staffDetailsModal.staff.employment_status">
                                {{ formatEmploymentStatus(staffDetailsModal.staff.employment_status) }}
                            </span>
                        </div>
                    </div>

                    <div class="staff-stats">
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ staffDetailsModal.stats.completedRotations || 0 }}</div>
                            <div class="staff-stat-label">Completed Rotations</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ staffDetailsModal.stats.oncallShifts || 0 }}</div>
                            <div class="staff-stat-label">On-call Shifts</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ staffDetailsModal.stats.absenceDays || 0 }}</div>
                            <div class="staff-stat-label">Absence Days</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ staffDetailsModal.stats.supervisionCount || 0 }}</div>
                            <div class="staff-stat-label">Residents Supervised</div>
                        </div>
                    </div>

                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'personal' }" 
                                @click="staffDetailsModal.activeTab = 'personal'" role="tab" aria-selected="staffDetailsModal.activeTab === 'personal'">
                            <i class="fas fa-user"></i> Personal Info
                        </button>
                        <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'professional' }" 
                                @click="staffDetailsModal.activeTab = 'professional'" role="tab" aria-selected="staffDetailsModal.activeTab === 'professional'">
                            <i class="fas fa-briefcase"></i> Professional Info
                        </button>
                        <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'contact' }" 
                                @click="staffDetailsModal.activeTab = 'contact'" role="tab" aria-selected="staffDetailsModal.activeTab === 'contact'">
                            <i class="fas fa-address-book"></i> Contact & Schedule
                        </button>
                        <button class="modal-tab" :class="{ active: staffDetailsModal.activeTab === 'history' }" 
                                @click="staffDetailsModal.activeTab = 'history'" role="tab" aria-selected="staffDetailsModal.activeTab === 'history'">
                            <i class="fas fa-history"></i> Activity History
                        </button>
                    </div>

                    <!-- Personal Info Tab -->
                    <div v-if="staffDetailsModal.activeTab === 'personal'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-id-card"></i>
                                Personal Information
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">Date of Birth</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.date_of_birth ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.date_of_birth || 'Information unavailable' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Medical License</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.medical_license ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.medical_license || 'Information unavailable' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Years of Experience</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.years_experience ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.years_experience || 'Information unavailable' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Biography</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.biography ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.biography || 'No biography available' }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Professional Info Tab -->
                    <div v-if="staffDetailsModal.activeTab === 'professional'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-graduation-cap"></i>
                                Professional Information
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">Staff ID</div>
                                    <div class="info-value">{{ staffDetailsModal.staff.staff_id }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Professional Email</div>
                                    <div class="info-value">{{ staffDetailsModal.staff.professional_email }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Department</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.department_id ? '' : 'unavailable'">
                                        {{ getDepartmentName(staffDetailsModal.staff.department_id) || 'Department information unavailable' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Specialization</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.specialization ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.specialization || 'Specialization information unavailable' }}
                                    </div>
                                </div>
                                <div v-if="staffDetailsModal.staff.staff_type === 'medical_resident'" class="info-item">
                                    <div class="info-label">Resident Category</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.resident_category ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.resident_category ? formatResidentCategory(staffDetailsModal.staff.resident_category) : 'Resident category unavailable' }}
                                    </div>
                                </div>
                                <div v-if="staffDetailsModal.staff.staff_type === 'medical_resident'" class="info-item">
                                    <div class="info-label">Training Level</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.training_level ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.training_level ? formatTrainingLevel(staffDetailsModal.staff.training_level) : 'Training level unavailable' }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact & Schedule Tab -->
                    <div v-if="staffDetailsModal.activeTab === 'contact'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-calendar-alt"></i>
                                Schedule Information
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">Current Rotation</div>
                                    <div class="info-value" :class="staffDetailsModal.currentRotation ? '' : 'unavailable'">
                                        {{ staffDetailsModal.currentRotation || 'No active rotation' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Next On-call</div>
                                    <div class="info-value" :class="staffDetailsModal.nextOncall ? '' : 'unavailable'">
                                        {{ staffDetailsModal.nextOncall || 'No upcoming on-call scheduled' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Office Phone</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.office_phone ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.office_phone || 'Office phone unavailable' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Mobile Phone</div>
                                    <div class="info-value" :class="staffDetailsModal.staff.mobile_phone ? '' : 'unavailable'">
                                        {{ staffDetailsModal.staff.mobile_phone || 'Mobile phone unavailable' }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Activity History Tab -->
                    <div v-if="staffDetailsModal.activeTab === 'history'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-history"></i>
                                Activity History
                            </div>
                            <div v-if="staffDetailsModal.activityHistory.length === 0" class="empty-state">
                                <i class="fas fa-history empty-state-icon"></i>
                                <div class="empty-state-title">No Activity History</div>
                                <div class="empty-state-description">
                                    No activity history found for this staff member.
                                </div>
                            </div>
                            <div v-else>
                                <div v-for="activity in staffDetailsModal.activityHistory" :key="activity.id" class="audit-log-item">
                                    <div class="audit-action">{{ formatAuditAction(activity.action) }}</div>
                                    <div class="audit-details">
                                        <span>Module: {{ activity.module }}</span>
                                        <span>Details: {{ activity.details }}</span>
                                    </div>
                                    <div class="audit-timestamp">
                                        <i class="fas fa-clock"></i> {{ formatDateTime(activity.created_at) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="staffDetailsModal.show = false">Close</button>
                    <button class="btn btn-primary" @click="editMedicalStaff(staffDetailsModal.staff)"
                            v-if="hasPermission('medical_staff', 'update')">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 2: Add/Edit Medical Staff Modal -->
        <div v-if="medicalStaffModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="medical-staff-title">
            <div class="modal-container modal-wide">
                <div class="modal-header">
                    <div class="modal-title" id="medical-staff-title">
                        <i class="fas fa-user-md"></i>
                        {{ medicalStaffModal.mode === 'add' ? 'Add Medical Staff' : 'Edit Medical Staff' }}
                    </div>
                    <button class="modal-close" @click="medicalStaffModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'basic' }" 
                                @click="medicalStaffModal.activeTab = 'basic'" role="tab" aria-selected="medicalStaffModal.activeTab === 'basic'">
                            <i class="fas fa-user"></i> Basic Information
                        </button>
                        <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'professional' }" 
                                @click="medicalStaffModal.activeTab = 'professional'" role="tab" aria-selected="medicalStaffModal.activeTab === 'professional'">
                            <i class="fas fa-graduation-cap"></i> Professional Details
                        </button>
                        <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'contact' }" 
                                @click="medicalStaffModal.activeTab = 'contact'" role="tab" aria-selected="medicalStaffModal.activeTab === 'contact'">
                            <i class="fas fa-address-book"></i> Contact Information
                        </button>
                    </div>

                    <!-- Basic Information Tab -->
                    <div v-if="medicalStaffModal.activeTab === 'basic'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-id-card"></i>
                                Basic Information
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Full Name *</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.full_name" aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Staff Type *</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.staff_type" aria-required="true">
                                        <option value="medical_resident">Medical Resident</option>
                                        <option value="attending_physician">Attending Physician</option>
                                        <option value="fellow">Fellow</option>
                                        <option value="nurse_practitioner">Nurse Practitioner</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Staff ID</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.staff_id">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Employment Status</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.employment_status">
                                        <option value="active">Active</option>
                                        <option value="on_leave">On Leave</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Professional Details Tab -->
                    <div v-if="medicalStaffModal.activeTab === 'professional'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-graduation-cap"></i>
                                Professional Details
                            </div>
                            
                            <div v-if="medicalStaffModal.form.staff_type === 'medical_resident'">
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Resident Category</label>
                                        <select class="form-select" v-model="medicalStaffModal.form.resident_category">
                                            <option value="">Select Category</option>
                                            <option value="department_internal">Department Internal</option>
                                            <option value="rotating_other_dept">Rotating Other Dept</option>
                                            <option value="external_institution">External Institution</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Training Level</label>
                                        <select class="form-select" v-model="medicalStaffModal.form.training_level">
                                            <option value="">Select Level</option>
                                            <option value="pgy1">PGY-1</option>
                                            <option value="pgy2">PGY-2</option>
                                            <option value="pgy3">PGY-3</option>
                                            <option value="pgy4">PGY-4</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div v-if="medicalStaffModal.form.staff_type === 'attending_physician'">
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Specialization</label>
                                        <input type="text" class="form-control" v-model="medicalStaffModal.form.specialization">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Years of Experience</label>
                                        <input type="number" class="form-control" v-model="medicalStaffModal.form.years_experience" min="0" max="50">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Biography</label>
                                <textarea class="form-control" v-model="medicalStaffModal.form.biography" rows="4"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Information Tab -->
                    <div v-if="medicalStaffModal.activeTab === 'contact'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-envelope"></i>
                                Contact Information
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Professional Email *</label>
                                    <input type="email" class="form-control" v-model="medicalStaffModal.form.professional_email" aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Department</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.department_id">
                                        <option value="">Select Department</option>
                                        <option v-for="department in departments" :key="department.id" :value="department.id">
                                            {{ department.name }}
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Office Phone</label>
                                    <input type="tel" class="form-control" v-model="medicalStaffModal.form.office_phone">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Mobile Phone</label>
                                    <input type="tel" class="form-control" v-model="medicalStaffModal.form.mobile_phone">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Medical License Number</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.medical_license">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Date of Birth</label>
                                    <input type="date" class="form-control" v-model="medicalStaffModal.form.date_of_birth">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="medicalStaffModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveMedicalStaff" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ medicalStaffModal.mode === 'add' ? 'Add Staff' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 3: Add/Edit Department Modal -->
        <div v-if="departmentModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="department-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="department-title">
                        <i class="fas fa-hospital"></i>
                        {{ departmentModal.mode === 'add' ? 'Add Department' : 'Edit Department' }}
                    </div>
                    <button class="modal-close" @click="departmentModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-info-circle"></i>
                            Department Information
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Department Name *</label>
                                <input type="text" class="form-control" v-model="departmentModal.form.name" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Department Code *</label>
                                <input type="text" class="form-control" v-model="departmentModal.form.code" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" v-model="departmentModal.form.status">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="archived">Archived</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Head of Department</label>
                                <select class="form-select" v-model="departmentModal.form.head_of_department_id">
                                    <option value="">Select Head</option>
                                    <option v-for="staff in availableHeadsOfDepartment" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" v-model="departmentModal.form.description" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="departmentModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveDepartment" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ departmentModal.mode === 'add' ? 'Add Department' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 4: Add/Edit Clinical Unit Modal -->
        <div v-if="clinicalUnitModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="clinical-unit-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="clinical-unit-title">
                        <i class="fas fa-clinic-medical"></i>
                        {{ clinicalUnitModal.mode === 'add' ? 'Add Clinical Unit' : 'Edit Clinical Unit' }}
                    </div>
                    <button class="modal-close" @click="clinicalUnitModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-info-circle"></i>
                            Clinical Unit Information
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Unit Name *</label>
                                <input type="text" class="form-control" v-model="clinicalUnitModal.form.name" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Unit Code *</label>
                                <input type="text" class="form-control" v-model="clinicalUnitModal.form.code" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Department *</label>
                                <select class="form-select" v-model="clinicalUnitModal.form.department_id" aria-required="true">
                                    <option value="">Select Department</option>
                                    <option v-for="department in departments" :key="department.id" :value="department.id">
                                        {{ department.name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Unit Type</label>
                                <select class="form-select" v-model="clinicalUnitModal.form.unit_type">
                                    <option value="clinical">Clinical</option>
                                    <option value="administrative">Administrative</option>
                                    <option value="support">Support</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" v-model="clinicalUnitModal.form.status">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Supervisor</label>
                                <select class="form-select" v-model="clinicalUnitModal.form.supervisor_id">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="staff in availableSupervisors" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" v-model="clinicalUnitModal.form.description" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="clinicalUnitModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveClinicalUnit" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ clinicalUnitModal.mode === 'add' ? 'Add Clinical Unit' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 5: Add/Edit Training Unit Modal -->
        <div v-if="trainingUnitModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="training-unit-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="training-unit-title">
                        <i class="fas fa-clinic-medical"></i>
                        {{ trainingUnitModal.mode === 'add' ? 'Add Training Unit' : 'Edit Training Unit' }}
                    </div>
                    <button class="modal-close" @click="trainingUnitModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-info-circle"></i>
                            Training Unit Information
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Unit Name *</label>
                                <input type="text" class="form-control" v-model="trainingUnitModal.form.name" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Department *</label>
                                <select class="form-select" v-model="trainingUnitModal.form.department_id" aria-required="true">
                                    <option value="">Select Department</option>
                                    <option v-for="department in departments" :key="department.id" :value="department.id">
                                        {{ department.name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Supervisor</label>
                                <select class="form-select" v-model="trainingUnitModal.form.supervisor_id">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="staff in availableAttendings" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Max Capacity</label>
                                <input type="number" class="form-control" v-model="trainingUnitModal.form.max_capacity" min="1" max="50">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" v-model="trainingUnitModal.form.status">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" v-model="trainingUnitModal.form.description" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="trainingUnitModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveTrainingUnit" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ trainingUnitModal.mode === 'add' ? 'Add Training Unit' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 6: Add/Edit Rotation Modal -->
        <div v-if="rotationModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="rotation-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="rotation-title">
                        <i class="fas fa-calendar-alt"></i>
                        {{ rotationModal.mode === 'add' ? 'Add Rotation' : 'Edit Rotation' }}
                    </div>
                    <button class="modal-close" @click="rotationModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-user-graduate"></i>
                            Rotation Details
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Resident *</label>
                                <select class="form-select" v-model="rotationModal.form.resident_id" aria-required="true">
                                    <option value="">Select Resident</option>
                                    <option v-for="resident in availableResidents" :key="resident.id" :value="resident.id">
                                        {{ resident.full_name }} ({{ formatTrainingLevel(resident.training_level) }})
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Training Unit *</label>
                                <select class="form-select" v-model="rotationModal.form.training_unit_id" aria-required="true">
                                    <option value="">Select Unit</option>
                                    <option v-for="unit in availableTrainingUnits" :key="unit.id" :value="unit.id">
                                        {{ unit.name }} ({{ unit.current_residents }}/{{ unit.max_capacity }})
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Start Date *</label>
                                <input type="date" class="form-control" v-model="rotationModal.form.start_date" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">End Date *</label>
                                <input type="date" class="form-control" v-model="rotationModal.form.end_date" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Supervisor</label>
                                <select class="form-select" v-model="rotationModal.form.supervisor_id">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="supervisor in availableSupervisors" :key="supervisor.id" :value="supervisor.id">
                                        {{ supervisor.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" v-model="rotationModal.form.status">
                                    <option value="active">Active</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Rotation Goals</label>
                            <textarea class="form-control" v-model="rotationModal.form.goals" rows="3"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Notes</label>
                            <textarea class="form-control" v-model="rotationModal.form.notes" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="rotationModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveRotation" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ rotationModal.mode === 'add' ? 'Add Rotation' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 7: Add/Edit On-call Schedule Modal -->
        <div v-if="onCallModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="oncall-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="oncall-title">
                        <i class="fas fa-phone-alt"></i>
                        {{ onCallModal.mode === 'add' ? 'Add On-call Schedule' : 'Edit On-call Schedule' }}
                    </div>
                    <button class="modal-close" @click="onCallModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-calendar"></i>
                            Schedule Details
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                                                            <div class="form-group">
                                    <label class="form-label">Duty Date *</label>
                                    <input type="date" class="form-control" v-model="onCallModal.form.duty_date" aria-required="true">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Physician *</label>
                                    <select class="form-select" v-model="onCallModal.form.physician_id" aria-required="true">
                                        <option value="">Select Physician</option>
                                        <option v-for="physician in availablePhysicians" :key="physician.id" :value="physician.id">
                                            {{ physician.full_name }} ({{ formatStaffType(physician.staff_type) }})
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Role *</label>
                                    <select class="form-select" v-model="onCallModal.form.role" aria-required="true">
                                        <option value="primary">Primary On-call</option>
                                        <option value="secondary">Secondary On-call</option>
                                        <option value="backup">Backup</option>
                                        <option value="supervisor">Supervisor</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Start Time *</label>
                                    <input type="time" class="form-control" v-model="onCallModal.form.start_time" aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">End Time *</label>
                                    <input type="time" class="form-control" v-model="onCallModal.form.end_time" aria-required="true">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Coverage Area</label>
                                <select class="form-select" v-model="onCallModal.form.coverage_area">
                                    <option value="emergency">Emergency Department</option>
                                    <option value="icu">Intensive Care Unit</option>
                                    <option value="ward">General Ward</option>
                                    <option value="consultation">Consultations</option>
                                    <option value="all">All Areas</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Contact Number</label>
                                <input type="tel" class="form-control" v-model="onCallModal.form.contact_number">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Notes</label>
                                <textarea class="form-control" v-model="onCallModal.form.notes" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="onCallModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveOnCallSchedule" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ onCallModal.mode === 'add' ? 'Add Schedule' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 8: Add/Edit Staff Absence Modal -->
        <div v-if="absenceModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="absence-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="absence-title">
                        <i class="fas fa-calendar-times"></i>
                        {{ absenceModal.mode === 'add' ? 'Document Staff Absence' : 'Edit Absence Record' }}
                    </div>
                    <button class="modal-close" @click="absenceModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: absenceModal.activeTab === 'basic' }" 
                                @click="absenceModal.activeTab = 'basic'" role="tab" aria-selected="absenceModal.activeTab === 'basic'">
                            <i class="fas fa-info-circle"></i> Basic Information
                        </button>
                        <button class="modal-tab" :class="{ active: absenceModal.activeTab === 'coverage' }" 
                                @click="absenceModal.activeTab = 'coverage'" role="tab" aria-selected="absenceModal.activeTab === 'coverage'">
                            <i class="fas fa-user-md"></i> Coverage Arrangements
                        </button>
                        <button class="modal-tab" :class="{ active: absenceModal.activeTab === 'notes' }" 
                                @click="absenceModal.activeTab = 'notes'" role="tab" aria-selected="absenceModal.activeTab === 'notes'">
                            <i class="fas fa-sticky-note"></i> Notes & Documentation
                        </button>
                    </div>

                    <!-- Basic Information Tab -->
                    <div v-if="absenceModal.activeTab === 'basic'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-user"></i>
                                Staff Information
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Staff Member *</label>
                                    <select class="form-select" v-model="absenceModal.form.staff_member_id" aria-required="true">
                                        <option value="">Select Staff Member</option>
                                        <option v-for="staff in availableStaff" :key="staff.id" :value="staff.id">
                                            {{ staff.full_name }} ({{ formatStaffType(staff.staff_type) }})
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Absence Reason *</label>
                                    <select class="form-select" v-model="absenceModal.form.absence_reason" aria-required="true">
                                        <option value="">Select Reason</option>
                                        <option value="vacation">Vacation</option>
                                        <option value="sick_leave">Sick Leave</option>
                                        <option value="family_emergency">Family Emergency</option>
                                        <option value="conference">Conference/Training</option>
                                        <option value="maternity_paternity">Maternity/Paternity Leave</option>
                                        <option value="personal">Personal Leave</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-calendar-alt"></i>
                                Dates & Duration
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Start Date *</label>
                                    <input type="date" class="form-control" v-model="absenceModal.form.start_date" aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">End Date *</label>
                                    <input type="date" class="form-control" v-model="absenceModal.form.end_date" aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" v-model="absenceModal.form.status">
                                        <option value="upcoming">Upcoming</option>
                                        <option value="active">Active</option>
                                        <option value="completed">Completed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Total Days</label>
                                    <input type="number" class="form-control" v-model="absenceModal.form.total_days" readonly>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Coverage Arrangements Tab -->
                    <div v-if="absenceModal.activeTab === 'coverage'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-user-friends"></i>
                                Coverage Information
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Needs Coverage?</label>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="absenceModal.form.needs_coverage" 
                                           :id="'needs-coverage-' + absenceModal.mode">
                                    <label class="form-check-label" :for="'needs-coverage-' + absenceModal.mode">
                                        This absence requires coverage arrangements
                                    </label>
                                </div>
                            </div>

                            <div v-if="absenceModal.form.needs_coverage" class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Replacement Staff</label>
                                    <select class="form-select" v-model="absenceModal.form.replacement_staff_id">
                                        <option value="">Select Replacement</option>
                                        <option v-for="staff in availableCoverageStaff" :key="staff.id" :value="staff.id">
                                            {{ staff.full_name }} ({{ formatStaffType(staff.staff_type) }})
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Coverage Type</label>
                                    <select class="form-select" v-model="absenceModal.form.coverage_type">
                                        <option value="">Select Type</option>
                                        <option value="full">Full Coverage</option>
                                        <option value="partial">Partial Coverage</option>
                                        <option value="emergency">Emergency Only</option>
                                        <option value="shared">Shared Responsibility</option>
                                    </select>
                                </div>
                            </div>

                            <div v-if="absenceModal.form.needs_coverage && absenceModal.form.replacement_staff_id" class="form-group">
                                <label class="form-label">Coverage Notes</label>
                                <textarea class="form-control" v-model="absenceModal.form.coverage_notes" rows="3" 
                                          placeholder="Details about coverage arrangements, responsibilities, etc."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Notes & Documentation Tab -->
                    <div v-if="absenceModal.activeTab === 'notes'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-file-medical"></i>
                                Documentation
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Documentation</label>
                                <textarea class="form-control" v-model="absenceModal.form.documentation" rows="4"
                                          placeholder="Detailed description of the absence, any supporting documentation, etc."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Contact During Absence</label>
                                <input type="text" class="form-control" v-model="absenceModal.form.contact_during_absence"
                                       placeholder="Emergency contact information if needed">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Approval Status</label>
                                <select class="form-select" v-model="absenceModal.form.approval_status">
                                    <option value="pending">Pending Approval</option>
                                    <option value="approved">Approved</option>
                                    <option value="rejected">Rejected</option>
                                    <option value="auto">Auto-Approved</option>
                                </select>
                            </div>
                            
                            <div v-if="absenceModal.form.approval_status === 'approved'" class="form-group">
                                <label class="form-label">Approved By</label>
                                <input type="text" class="form-control" v-model="absenceModal.form.approved_by" 
                                       :value="currentUser.full_name" readonly>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="absenceModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveAbsence" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ absenceModal.mode === 'add' ? 'Document Absence' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 9: Quick Placement Modal -->
        <div v-if="quickPlacementModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="quick-placement-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="quick-placement-title">
                        <i class="fas fa-user-md"></i>
                        Quick Resident Placement
                    </div>
                    <button class="modal-close" @click="quickPlacementModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-user-graduate"></i>
                            Placement Details
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Resident *</label>
                                <select class="form-select" v-model="quickPlacementModal.form.resident_id" aria-required="true">
                                    <option value="">Select Resident</option>
                                    <option v-for="resident in availableUnassignedResidents" :key="resident.id" :value="resident.id">
                                        {{ resident.full_name }} ({{ formatTrainingLevel(resident.training_level) }})
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Training Unit *</label>
                                <select class="form-select" v-model="quickPlacementModal.form.training_unit_id" aria-required="true">
                                    <option value="">Select Unit</option>
                                    <option v-for="unit in availableTrainingUnitsWithCapacity" :key="unit.id" :value="unit.id">
                                        {{ unit.name }} ({{ unit.current_residents }}/{{ unit.max_capacity }} available)
                                    </option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Start Date *</label>
                                <input type="date" class="form-control" v-model="quickPlacementModal.form.start_date" aria-required="true">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Duration (weeks) *</label>
                                <select class="form-select" v-model="quickPlacementModal.form.duration_weeks" aria-required="true">
                                    <option value="4">4 weeks</option>
                                    <option value="6">6 weeks</option>
                                    <option value="8">8 weeks</option>
                                    <option value="12">12 weeks</option>
                                    <option value="custom">Custom</option>
                                </select>
                            </div>
                        </div>
                        
                        <div v-if="quickPlacementModal.form.duration_weeks === 'custom'" class="form-group">
                            <label class="form-label">Custom Duration (weeks)</label>
                            <input type="number" class="form-control" v-model="quickPlacementModal.form.custom_duration" min="1" max="52">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Supervisor</label>
                            <select class="form-select" v-model="quickPlacementModal.form.supervisor_id">
                                <option value="">Select Supervisor</option>
                                <option v-for="supervisor in availableSupervisors" :key="supervisor.id" :value="supervisor.id">
                                    {{ supervisor.full_name }}
                                </option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Quick Notes</label>
                            <textarea class="form-control" v-model="quickPlacementModal.form.notes" rows="3" 
                                      placeholder="Brief notes about this placement..."></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="quickPlacementModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveQuickPlacement" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else><i class="fas fa-check"></i> Place Resident</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 10: Bulk Assign Modal -->
        <div v-if="bulkAssignModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="bulk-assign-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="bulk-assign-title">
                        <i class="fas fa-users"></i>
                        Bulk Resident Assignment
                    </div>
                    <button class="modal-close" @click="bulkAssignModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-user-graduate"></i>
                            Assignment Settings
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Training Unit *</label>
                                <select class="form-select" v-model="bulkAssignModal.form.training_unit_id" aria-required="true">
                                    <option value="">Select Unit</option>
                                    <option v-for="unit in availableTrainingUnits" :key="unit.id" :value="unit.id">
                                        {{ unit.name }} ({{ unit.current_residents }}/{{ unit.max_capacity }})
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Start Date *</label>
                                <input type="date" class="form-control" v-model="bulkAssignModal.form.start_date" aria-required="true">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Duration (weeks) *</label>
                                <select class="form-select" v-model="bulkAssignModal.form.duration_weeks" aria-required="true">
                                    <option value="4">4 weeks</option>
                                    <option value="6">6 weeks</option>
                                    <option value="8">8 weeks</option>
                                    <option value="12">12 weeks</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Supervisor</label>
                                <select class="form-select" v-model="bulkAssignModal.form.supervisor_id">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="supervisor in availableSupervisors" :key="supervisor.id" :value="supervisor.id">
                                        {{ supervisor.full_name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-list-check"></i>
                            Select Residents
                        </div>
                        
                        <div v-if="loadingResidents" class="loading-overlay">
                            <div class="loading-spinner"></div>
                        </div>
                        
                        <div v-else-if="availableResidents.length === 0" class="empty-state">
                            <i class="fas fa-user-graduate empty-state-icon"></i>
                            <div class="empty-state-title">No Residents Available</div>
                            <div class="empty-state-description">
                                There are no residents available for bulk assignment.
                            </div>
                        </div>
                        
                        <div v-else>
                            <div class="form-group">
                                <div class="flex justify-between mb-2">
                                    <span class="form-label">Available Residents</span>
                                    <button type="button" class="btn btn-sm btn-secondary" @click="toggleSelectAllResidents">
                                        {{ bulkAssignModal.allSelected ? 'Deselect All' : 'Select All' }}
                                    </button>
                                </div>
                                
                                <div class="resident-selection-list" style="max-height: 300px; overflow-y: auto; border: 1px solid var(--medical-light-blue); border-radius: var(--border-radius-md); padding: 12px;">
                                    <div v-for="resident in availableResidents" :key="resident.id" 
                                         class="form-check resident-selection-item" style="padding: 12px; border-bottom: 1px solid var(--gray-200);">
                                        <input type="checkbox" class="form-check-input" 
                                               :id="'resident-' + resident.id"
                                               :checked="isResidentSelected(resident.id)"
                                               @change="toggleResidentSelection(resident.id)">
                                        <label class="form-check-label" :for="'resident-' + resident.id" style="display: flex; align-items: center; gap: 12px; width: 100%;">
                                            <div class="user-avatar">{{ getInitials(resident.full_name) }}</div>
                                            <div>
                                                <div style="font-weight: 500;">{{ resident.full_name }}</div>
                                                <div style="font-size: 12px; color: var(--medical-gray);">
                                                    {{ formatTrainingLevel(resident.training_level) }}  {{ getDepartmentName(resident.department_id) }}
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mt-3 text-sm text-gray-600" style="padding: 8px; background: var(--medical-light-blue); border-radius: var(--border-radius-sm);">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    Selected: {{ bulkAssignModal.selectedResidents.length }} residents
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="bulkAssignModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveBulkAssignment" :disabled="saving || bulkAssignModal.selectedResidents.length === 0">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>
                            <i class="fas fa-users"></i> 
                            Assign {{ bulkAssignModal.selectedResidents.length }} Residents
                        </span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 11: Communications Modal -->
        <div v-if="communicationsModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="communications-title">
            <div class="modal-container modal-wide">
                <div class="modal-header">
                    <div class="modal-title" id="communications-title">
                        <i class="fas fa-comments"></i>
                        Department Communications
                    </div>
                    <button class="modal-close" @click="communicationsModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'announcement' }" 
                                @click="communicationsModal.activeTab = 'announcement'" role="tab" aria-selected="communicationsModal.activeTab === 'announcement'">
                            <i class="fas fa-bullhorn"></i> Announcement
                        </button>
                        <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'capacity' }" 
                                @click="communicationsModal.activeTab = 'capacity'" role="tab" aria-selected="communicationsModal.activeTab === 'capacity'">
                            <i class="fas fa-bed"></i> Capacity Update
                        </button>
                        <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'quick_note' }" 
                                @click="communicationsModal.activeTab = 'quick_note'" role="tab" aria-selected="communicationsModal.activeTab === 'quick_note'">
                            <i class="fas fa-sticky-note"></i> Quick Note
                        </button>
                    </div>

                    <!-- Announcement Tab -->
                    <div v-if="communicationsModal.activeTab === 'announcement'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-newspaper"></i>
                                Create Announcement
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Title *</label>
                                <input type="text" class="form-control" v-model="communicationsModal.form.announcement_title" 
                                       placeholder="Enter announcement title" aria-required="true">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Content *</label>
                                <textarea class="form-control" v-model="communicationsModal.form.announcement_content" 
                                          rows="6" placeholder="Enter announcement content" aria-required="true"></textarea>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Priority Level *</label>
                                    <select class="form-select" v-model="communicationsModal.form.priority_level" aria-required="true">
                                        <option value="low">Low Priority</option>
                                        <option value="medium">Medium Priority</option>
                                        <option value="high">High Priority</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Target Audience</label>
                                    <select class="form-select" v-model="communicationsModal.form.target_audience">
                                        <option value="all_staff">All Staff</option>
                                        <option value="medical_staff">Medical Staff Only</option>
                                        <option value="residents">Residents Only</option>
                                        <option value="attendings">Attending Physicians Only</option>
                                        <option value="department">Department Specific</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Publish Start Date *</label>
                                    <input type="datetime-local" class="form-control" v-model="communicationsModal.form.publish_start_date" 
                                           aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Publish End Date</label>
                                    <input type="datetime-local" class="form-control" v-model="communicationsModal.form.publish_end_date">
                                </div>
                            </div>
                            
                            <div v-if="communicationsModal.form.target_audience === 'department'" class="form-group">
                                <label class="form-label">Target Department</label>
                                <select class="form-select" v-model="communicationsModal.form.target_department_id">
                                    <option value="">Select Department</option>
                                    <option v-for="department in departments" :key="department.id" :value="department.id">
                                        {{ department.name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Capacity Update Tab -->
                    <div v-if="communicationsModal.activeTab === 'capacity'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-hospital"></i>
                                Capacity Status Update
                            </div>
                            
                            <div class="capacity-grid">
                                <div class="capacity-card">
                                    <div class="capacity-card-header">
                                        <div class="capacity-unit">Emergency Room</div>
                                        <div class="capacity-status" :class="communicationsModal.form.er_capacity_status">
                                            {{ communicationsModal.form.er_capacity_status }}
                                        </div>
                                    </div>
                                    <div class="capacity-input-group">
                                        <input type="number" class="capacity-input" v-model="communicationsModal.form.er_current" 
                                               min="0" :max="communicationsModal.form.er_max" aria-label="ER current patients">
                                        <span class="capacity-slash">/</span>
                                        <input type="number" class="capacity-input" v-model="communicationsModal.form.er_max" 
                                               min="1" aria-label="ER max capacity">
                                    </div>
                                </div>
                                
                                <div class="capacity-card">
                                    <div class="capacity-card-header">
                                        <div class="capacity-unit">Pulmo ICU</div>
                                        <div class="capacity-status" :class="communicationsModal.form.icu_capacity_status">
                                            {{ communicationsModal.form.icu_capacity_status }}
                                        </div>
                                    </div>
                                    <div class="capacity-input-group">
                                        <input type="number" class="capacity-input" v-model="communicationsModal.form.icu_current" 
                                               min="0" :max="communicationsModal.form.icu_max" aria-label="ICU current patients">
                                        <span class="capacity-slash">/</span>
                                        <input type="number" class="capacity-input" v-model="communicationsModal.form.icu_max" 
                                               min="1" aria-label="ICU max capacity">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Capacity Notes</label>
                                <textarea class="form-control" v-model="communicationsModal.form.capacity_notes" rows="3"
                                          placeholder="Additional notes about capacity, wait times, etc."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Priority Level</label>
                                <select class="form-select" v-model="communicationsModal.form.capacity_priority">
                                    <option value="normal">Normal Operations</option>
                                    <option value="high">High Capacity</option>
                                    <option value="critical">Critical Capacity</option>
                                    <option value="overflow">Overflow Status</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Note Tab -->
                    <div v-if="communicationsModal.activeTab === 'quick_note'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-pen"></i>
                                Quick Department Note
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Note Type</label>
                                <select class="form-select" v-model="communicationsModal.form.note_type">
                                    <option value="info">Information</option>
                                    <option value="reminder">Reminder</option>
                                    <option value="update">Status Update</option>
                                    <option value="alert">Alert</option>
                                    <option value="thanks">Thanks/Recognition</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Note Content *</label>
                                <textarea class="form-control" v-model="communicationsModal.form.note_content" 
                                          rows="4" placeholder="Enter your quick note here..." aria-required="true"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Expires In</label>
                                <select class="form-select" v-model="communicationsModal.form.note_expires_in">
                                    <option value="1">1 hour</option>
                                    <option value="4">4 hours</option>
                                    <option value="8">8 hours</option>
                                    <option value="24">24 hours</option>
                                    <option value="168">1 week</option>
                                    <option value="never">Never</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="communicationsModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveCommunication" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>
                            <i class="fas" :class="getCommunicationIcon(communicationsModal.activeTab)"></i>
                            {{ getCommunicationButtonText(communicationsModal.activeTab) }}
                        </span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 12: Permission Role Modal -->
        <div v-if="roleModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="role-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="role-title">
                        <i class="fas fa-user-shield"></i>
                        {{ roleModal.mode === 'add' ? 'Add Role' : 'Edit Role' }}
                    </div>
                    <button class="modal-close" @click="roleModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-info-circle"></i>
                            Role Information
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Role Name *</label>
                            <input type="text" class="form-control" v-model="roleModal.form.name" 
                                   placeholder="Enter role name" aria-required="true">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" v-model="roleModal.form.description" rows="3"
                                      placeholder="Enter role description"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Default Permissions</label>
                            <div class="permission-checkboxes">
                                <div v-for="permission in availablePermissions" :key="permission.id" class="form-check">
                                    <input type="checkbox" class="form-check-input" 
                                           :id="'role-permission-' + permission.id"
                                           :checked="isPermissionSelected(permission.id)"
                                           @change="togglePermissionSelection(permission.id)">
                                    <label class="form-check-label" :for="'role-permission-' + permission.id">
                                        {{ formatPermissionName(permission.name) }}
                                        <span class="text-xs text-gray-500 ml-2">({{ permission.module }})</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="roleModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveRole" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>{{ roleModal.mode === 'add' ? 'Add Role' : 'Save Changes' }}</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 13: User Profile Modal -->
        <div v-if="userProfileModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="user-profile-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="user-profile-title">
                        <i class="fas fa-user"></i> Profile Settings
                    </div>
                    <button class="modal-close" @click="userProfileModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: userProfileModal.activeTab === 'profile' }" 
                                @click="userProfileModal.activeTab = 'profile'" role="tab" aria-selected="userProfileModal.activeTab === 'profile'">
                            <i class="fas fa-user-circle"></i> Profile
                        </button>
                        <button class="modal-tab" :class="{ active: userProfileModal.activeTab === 'security' }" 
                                @click="userProfileModal.activeTab = 'security'" role="tab" aria-selected="userProfileModal.activeTab === 'security'">
                            <i class="fas fa-shield-alt"></i> Security
                        </button>
                        <button class="modal-tab" :class="{ active: userProfileModal.activeTab === 'notifications' }" 
                                @click="userProfileModal.activeTab = 'notifications'" role="tab" aria-selected="userProfileModal.activeTab === 'notifications'">
                            <i class="fas fa-bell"></i> Notifications
                        </button>
                    </div>

                    <!-- Profile Tab -->
                    <div v-if="userProfileModal.activeTab === 'profile'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-user"></i>
                                Personal Information
                            </div>
                            
                            <div class="flex flex-col items-center mb-6">
                                <div class="user-avatar" style="width: 80px; height: 80px; font-size: 24px;">
                                    {{ getInitials(userProfileModal.form.full_name) }}
                                </div>
                                <button class="btn btn-sm btn-secondary mt-2">
                                    <i class="fas fa-camera"></i> Change Photo
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Full Name *</label>
                                    <input type="text" class="form-control" v-model="userProfileModal.form.full_name" 
                                           aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email *</label>
                                    <input type="email" class="form-control" v-model="userProfileModal.form.email" 
                                           aria-required="true" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" v-model="userProfileModal.form.phone">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Department</label>
                                    <select class="form-select" v-model="userProfileModal.form.department_id">
                                        <option value="">Select Department</option>
                                        <option v-for="department in departments" :key="department.id" :value="department.id">
                                            {{ department.name }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Biography</label>
                                <textarea class="form-control" v-model="userProfileModal.form.biography" rows="4"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Security Tab -->
                    <div v-if="userProfileModal.activeTab === 'security'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-key"></i>
                                Change Password
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Current Password</label>
                                <input type="password" class="form-control" v-model="userProfileModal.form.current_password">
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">New Password</label>
                                    <input type="password" class="form-control" v-model="userProfileModal.form.new_password">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Confirm Password</label>
                                    <input type="password" class="form-control" v-model="userProfileModal.form.confirm_password">
                                </div>
                            </div>
                            
                            <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded" v-if="userProfileModal.form.new_password">
                                <div class="text-sm text-blue-700">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    Password must contain at least 8 characters including uppercase, lowercase, and numbers.
                                </div>
                            </div>
                        </div>
                        
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-shield-alt"></i>
                                Security Settings
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.enable_2fa">
                                    <span class="form-check-label">Enable Two-Factor Authentication</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.email_notifications">
                                    <span class="form-check-label">Email Notifications for Security Events</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Tab -->
                    <div v-if="userProfileModal.activeTab === 'notifications'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-bell"></i>
                                Notification Preferences
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.notify_announcements">
                                    <span class="form-check-label">New Announcements</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.notify_schedule">
                                    <span class="form-check-label">Schedule Changes</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.notify_absence">
                                    <span class="form-check-label">Staff Absence Updates</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.notify_capacity">
                                    <span class="form-check-label">Capacity Alerts</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" v-model="userProfileModal.form.notify_rotations">
                                    <span class="form-check-label">Rotation Assignments</span>
                                </label>
                            </div>
                            
                            <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
                                <div class="text-sm text-blue-700">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    Notifications will be sent via email and in-app notifications.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="userProfileModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="saveUserProfile" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else>Save Profile</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 14: Absence Details Modal -->
        <div v-if="absenceDetailsModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="absence-details-title">
            <div class="modal-container modal-wide">
                <div class="modal-header">
                    <div class="modal-title" id="absence-details-title">
                        <i class="fas fa-calendar-times"></i>
                        Absence Record Details
                    </div>
                    <button class="modal-close" @click="absenceDetailsModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="staff-profile-header">
                        <div class="staff-avatar-large" aria-hidden="true">
                            {{ getInitials(getStaffName(absenceDetailsModal.absence.staff_member_id)) }}
                        </div>
                        <div class="staff-basic-info">
                            <div class="staff-name">{{ getStaffName(absenceDetailsModal.absence.staff_member_id) }}</div>
                            <div class="staff-title">{{ getStaffType(getStaffId(absenceDetailsModal.absence.staff_member_id)) }}</div>
                            <span class="staff-status" :class="absenceDetailsModal.absence.status">
                                {{ formatAbsenceStatus(absenceDetailsModal.absence.status) }}
                            </span>
                        </div>
                    </div>

                    <div class="staff-stats">
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ calculateAbsenceDuration(absenceDetailsModal.absence.start_date, absenceDetailsModal.absence.end_date) }}</div>
                            <div class="staff-stat-label">Total Days</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ formatAbsenceReason(absenceDetailsModal.absence.absence_reason) }}</div>
                            <div class="staff-stat-label">Reason</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value" :class="absenceDetailsModal.absence.replacement_staff_id ? '' : 'unavailable'">
                                {{ absenceDetailsModal.absence.replacement_staff_id ? 'Assigned' : 'Pending' }}
                            </div>
                            <div class="staff-stat-label">Coverage</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value" :class="absenceDetailsModal.absence.approval_status === 'approved' ? 'status-available' : 'status-busy'">
                                {{ absenceDetailsModal.absence.approval_status }}
                            </div>
                            <div class="staff-stat-label">Approval</div>
                        </div>
                    </div>

                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: absenceDetailsModal.activeTab === 'details' }" 
                                @click="absenceDetailsModal.activeTab = 'details'" role="tab" aria-selected="absenceDetailsModal.activeTab === 'details'">
                            <i class="fas fa-info-circle"></i> Details
                        </button>
                        <button class="modal-tab" :class="{ active: absenceDetailsModal.activeTab === 'coverage' }" 
                                @click="absenceDetailsModal.activeTab = 'coverage'" role="tab" aria-selected="absenceDetailsModal.activeTab === 'coverage'">
                            <i class="fas fa-user-md"></i> Coverage
                        </button>
                        <button class="modal-tab" :class="{ active: absenceDetailsModal.activeTab === 'timeline' }" 
                                @click="absenceDetailsModal.activeTab = 'timeline'" role="tab" aria-selected="absenceDetailsModal.activeTab === 'timeline'">
                            <i class="fas fa-history"></i> Timeline
                        </button>
                    </div>

                    <!-- Details Tab -->
                    <div v-if="absenceDetailsModal.activeTab === 'details'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-calendar-alt"></i>
                                Absence Details
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">Start Date</div>
                                    <div class="info-value">{{ formatDate(absenceDetailsModal.absence.start_date) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">End Date</div>
                                    <div class="info-value">{{ formatDate(absenceDetailsModal.absence.end_date) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Duration</div>
                                    <div class="info-value">{{ calculateAbsenceDuration(absenceDetailsModal.absence.start_date, absenceDetailsModal.absence.end_date) }} days</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Reason</div>
                                    <div class="info-value">{{ formatAbsenceReason(absenceDetailsModal.absence.absence_reason) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Status</div>
                                    <div class="info-value">{{ formatAbsenceStatus(absenceDetailsModal.absence.status) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Approval Status</div>
                                    <div class="info-value">{{ absenceDetailsModal.absence.approval_status }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-file-medical"></i>
                                Documentation
                            </div>
                            <div class="info-item">
                                <div class="info-label">Details</div>
                                <div class="info-value" :class="absenceDetailsModal.absence.documentation ? '' : 'unavailable'">
                                    {{ absenceDetailsModal.absence.documentation || 'No additional documentation provided' }}
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Contact During Absence</div>
                                <div class="info-value" :class="absenceDetailsModal.absence.contact_during_absence ? '' : 'unavailable'">
                                    {{ absenceDetailsModal.absence.contact_during_absence || 'No contact information provided' }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Coverage Tab -->
                    <div v-if="absenceDetailsModal.activeTab === 'coverage'" class="modal-tab-content active" role="tabpanel">
                        <div v-if="!absenceDetailsModal.absence.replacement_staff_id" class="empty-state">
                            <i class="fas fa-user-md empty-state-icon"></i>
                            <div class="empty-state-title">No Coverage Assigned</div>
                            <div class="empty-state-description">
                                Coverage has not been arranged for this absence.
                            </div>
                            <button class="btn btn-primary mt-4" @click="assignCoverage(absenceDetailsModal.absence)"
                                    v-if="hasPermission('staff_absence', 'update')">
                                <i class="fas fa-user-plus"></i> Assign Coverage
                            </button>
                        </div>
                        
                        <div v-else>
                            <div class="info-section">
                                <div class="info-section-title">
                                    <i class="fas fa-user-friends"></i>
                                    Coverage Information
                                </div>
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">Coverage Staff</div>
                                        <div class="info-value">{{ getStaffName(absenceDetailsModal.absence.replacement_staff_id) }}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Coverage Type</div>
                                        <div class="info-value">{{ absenceDetailsModal.absence.coverage_type || 'Not specified' }}</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">Notes</div>
                                        <div class="info-value" :class="absenceDetailsModal.absence.coverage_notes ? '' : 'unavailable'">
                                            {{ absenceDetailsModal.absence.coverage_notes || 'No coverage notes provided' }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Timeline Tab -->
                    <div v-if="absenceDetailsModal.activeTab === 'timeline'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-history"></i>
                                Activity Timeline
                            </div>
                            <div v-if="absenceDetailsModal.timeline.length === 0" class="empty-state">
                                <i class="fas fa-history empty-state-icon"></i>
                                <div class="empty-state-title">No Timeline Data</div>
                                <div class="empty-state-description">
                                    No activity timeline available for this absence.
                                </div>
                            </div>
                            <div v-else>
                                <div class="timeline" style="position: relative; padding-left: 30px;">
                                    <div v-for="event in absenceDetailsModal.timeline" :key="event.id" 
                                         class="timeline-event" style="position: relative; padding-bottom: 20px;">
                                        <div style="position: absolute; left: -30px; top: 0; width: 20px; height: 20px; border-radius: 50%; background: var(--medical-blue);"></div>
                                        <div class="timeline-content" style="padding-left: 10px;">
                                            <div style="font-weight: 500; color: var(--medical-dark-blue);">{{ event.action }}</div>
                                            <div style="font-size: 12px; color: var(--medical-gray); margin-top: 4px;">
                                                <i class="fas fa-clock"></i> {{ formatDateTime(event.timestamp) }}
                                                <span v-if="event.user" style="margin-left: 10px;">
                                                    <i class="fas fa-user"></i> {{ event.user }}
                                                </span>
                                            </div>
                                            <div v-if="event.details" style="font-size: 13px; color: var(--gray-700); margin-top: 4px; background: var(--medical-light-blue); padding: 8px; border-radius: var(--border-radius-sm);">
                                                {{ event.details }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="absenceDetailsModal.show = false">Close</button>
                    <button class="btn btn-primary" @click="editAbsence(absenceDetailsModal.absence)"
                            v-if="hasPermission('staff_absence', 'update')">
                        <i class="fas fa-edit"></i> Edit Absence
                    </button>
                    <button class="btn btn-success" @click="assignCoverage(absenceDetailsModal.absence)"
                            v-if="hasPermission('staff_absence', 'update') && !absenceDetailsModal.absence.replacement_staff_id">
                        <i class="fas fa-user-md"></i> Assign Coverage
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 15: Import/Export Modal -->
        <div v-if="importExportModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="import-export-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="import-export-title">
                        <i class="fas" :class="importExportModal.mode === 'import' ? 'fa-upload' : 'fa-download'"></i>
                        {{ importExportModal.mode === 'import' ? 'Import Data' : 'Export Data' }}
                    </div>
                    <button class="modal-close" @click="importExportModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-database"></i>
                            Data Selection
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Select Data Table *</label>
                            <select class="form-select" v-model="importExportModal.selectedTable" aria-required="true">
                                <option value="">Select Table</option>
                                <option value="medical_staff">Medical Staff</option>
                                <option value="resident_rotations">Resident Rotations</option>
                                <option value="oncall_schedule">On-call Schedule</option>
                                <option value="staff_absence">Staff Absence</option>
                                <option value="departments">Departments</option>
                                <option value="clinical_units">Clinical Units</option>
                                <option value="training_units">Training Units</option>
                                <option value="communications">Communications</option>
                                <option value="audit_logs">Audit Logs</option>
                                <option value="users">Users</option>
                            </select>
                        </div>
                        
                        <div v-if="importExportModal.selectedTable" class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
                            <div class="text-sm text-blue-700">
                                <i class="fas fa-info-circle mr-2"></i>
                                <span v-if="importExportModal.mode === 'export'">
                                    This will export all data from the {{ importExportModal.selectedTable.replace('_', ' ') }} table.
                                </span>
                                <span v-else>
                                    Import data must be in CSV format with proper column headers.
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Import Specific Content -->
                    <div v-if="importExportModal.mode === 'import'" class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-file-upload"></i>
                            Upload File
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Select File *</label>
                            <div class="file-upload-area" 
                                 @dragover.prevent 
                                 @drop.prevent="handleFileDrop"
                                 :class="{ 'file-hover': importExportModal.isDragging }"
                                 style="border: 2px dashed var(--medical-light-blue); border-radius: var(--border-radius-md); padding: 40px 20px; text-align: center; cursor: pointer; transition: all var(--transition-fast);">
                                <div v-if="!importExportModal.selectedFile">
                                    <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: var(--medical-blue); margin-bottom: 16px;"></i>
                                    <div style="font-weight: 500; margin-bottom: 8px;">Drag & drop your file here</div>
                                    <div style="font-size: 14px; color: var(--medical-gray); margin-bottom: 16px;">or click to browse</div>
                                    <input type="file" ref="fileInput" @change="handleFileSelect" accept=".csv,.xlsx,.xls" 
                                           style="display: none;">
                                    <button class="btn btn-secondary" @click="triggerFileInput">
                                        <i class="fas fa-folder-open"></i> Browse Files
                                    </button>
                                </div>
                                <div v-else>
                                    <i class="fas fa-file" style="font-size: 48px; color: var(--medical-green); margin-bottom: 16px;"></i>
                                    <div style="font-weight: 500; margin-bottom: 8px;">{{ importExportModal.selectedFile.name }}</div>
                                    <div style="font-size: 14px; color: var(--medical-gray); margin-bottom: 16px;">
                                        {{ formatFileSize(importExportModal.selectedFile.size) }}
                                    </div>
                                    <button class="btn btn-sm btn-danger" @click="removeSelectedFile">
                                        <i class="fas fa-times"></i> Remove File
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="importExportModal.overwriteExisting">
                                <span class="form-check-label">Overwrite existing records with matching IDs</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="importExportModal.skipErrors">
                                <span class="form-check-label">Skip rows with errors and continue import</span>
                            </label>
                        </div>
                    </div>

                    <!-- Export Specific Content -->
                    <div v-if="importExportModal.mode === 'export'" class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-file-export"></i>
                            Export Options
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Export Format</label>
                            <select class="form-select" v-model="importExportModal.exportFormat">
                                <option value="csv">CSV (Comma Separated Values)</option>
                                <option value="excel">Excel (.xlsx)</option>
                                <option value="json">JSON</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Date Range (Optional)</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <input type="date" class="form-control" v-model="importExportModal.startDate" 
                                           placeholder="Start Date">
                                </div>
                                <div>
                                    <input type="date" class="form-control" v-model="importExportModal.endDate" 
                                           placeholder="End Date">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="importExportModal.includeAllColumns">
                                <span class="form-check-label">Include all columns (unchecked for essential columns only)</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="importExportModal.show = false">Cancel</button>
                    <button v-if="importExportModal.mode === 'export'" class="btn btn-primary" @click="exportData" 
                            :disabled="saving || !importExportModal.selectedTable">
                        <span v-if="saving" class="loading"></span>
                        <span v-else><i class="fas fa-download"></i> Export Data</span>
                    </button>
                    <button v-if="importExportModal.mode === 'import'" class="btn btn-primary" @click="importData" 
                            :disabled="saving || !importExportModal.selectedTable || !importExportModal.selectedFile">
                        <span v-if="saving" class="loading"></span>
                        <span v-else><i class="fas fa-upload"></i> Import Data</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 16: Enhanced Rotation Details Modal -->
        <div v-if="rotationDetailsModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="rotation-details-title">
            <div class="modal-container modal-xwide">
                <div class="modal-header">
                    <div class="modal-title" id="rotation-details-title">
                        <i class="fas fa-calendar-alt"></i>
                        Rotation Details
                    </div>
                    <button class="modal-close" @click="rotationDetailsModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="staff-profile-header">
                        <div class="staff-avatar-large" aria-hidden="true">
                            {{ getInitials(getResidentName(rotationDetailsModal.rotation.resident_id)) }}
                        </div>
                        <div class="staff-basic-info">
                            <div class="staff-name">{{ getResidentName(rotationDetailsModal.rotation.resident_id) }}</div>
                            <div class="staff-title">{{ getTrainingUnitName(rotationDetailsModal.rotation.training_unit_id) }}</div>
                            <span class="staff-status" :class="rotationDetailsModal.rotation.status">
                                {{ formatRotationStatus(rotationDetailsModal.rotation.status) }}
                            </span>
                        </div>
                    </div>

                    <div class="staff-stats">
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ formatDate(rotationDetailsModal.rotation.start_date) }}</div>
                            <div class="staff-stat-label">Start Date</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ formatDate(rotationDetailsModal.rotation.end_date) }}</div>
                            <div class="staff-stat-label">End Date</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value">{{ calculateRotationDuration(rotationDetailsModal.rotation.start_date, rotationDetailsModal.rotation.end_date) }}</div>
                            <div class="staff-stat-label">Duration</div>
                        </div>
                        <div class="staff-stat-card">
                            <div class="staff-stat-value" :class="rotationDetailsModal.rotation.supervisor_id ? '' : 'unavailable'">
                                {{ getSupervisorName(rotationDetailsModal.rotation.supervisor_id) || 'Not assigned' }}
                            </div>
                            <div class="staff-stat-label">Supervisor</div>
                        </div>
                    </div>

                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: rotationDetailsModal.activeTab === 'overview' }" 
                                @click="rotationDetailsModal.activeTab = 'overview'" role="tab" aria-selected="rotationDetailsModal.activeTab === 'overview'">
                            <i class="fas fa-chart-line"></i> Overview
                        </button>
                        <button class="modal-tab" :class="{ active: rotationDetailsModal.activeTab === 'evaluations' }" 
                                @click="rotationDetailsModal.activeTab = 'evaluations'" role="tab" aria-selected="rotationDetailsModal.activeTab === 'evaluations'">
                            <i class="fas fa-star"></i> Evaluations
                        </button>
                        <button class="modal-tab" :class="{ active: rotationDetailsModal.activeTab === 'milestones' }" 
                                @click="rotationDetailsModal.activeTab = 'milestones'" role="tab" aria-selected="rotationDetailsModal.activeTab === 'milestones'">
                            <i class="fas fa-flag-checkered"></i> Milestones
                        </button>
                        <button class="modal-tab" :class="{ active: rotationDetailsModal.activeTab === 'documents' }" 
                                @click="rotationDetailsModal.activeTab = 'documents'" role="tab" aria-selected="rotationDetailsModal.activeTab === 'documents'">
                            <i class="fas fa-folder"></i> Documents
                        </button>
                    </div>

                    <!-- Overview Tab -->
                    <div v-if="rotationDetailsModal.activeTab === 'overview'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-info-circle"></i>
                                Rotation Information
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">Resident</div>
                                    <div class="info-value">{{ getResidentName(rotationDetailsModal.rotation.resident_id) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Training Unit</div>
                                    <div class="info-value">{{ getTrainingUnitName(rotationDetailsModal.rotation.training_unit_id) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Supervisor</div>
                                    <div class="info-value" :class="rotationDetailsModal.rotation.supervisor_id ? '' : 'unavailable'">
                                        {{ getSupervisorName(rotationDetailsModal.rotation.supervisor_id) || 'Supervisor not assigned' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Department</div>
                                    <div class="info-value">{{ getDepartmentForRotation(rotationDetailsModal.rotation.id) }}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Progress</div>
                                    <div class="info-value">
                                        <div class="progress-bar" style="width: 100%; height: 8px; background: var(--medical-light-blue); border-radius: 4px; overflow: hidden;">
                                            <div class="progress-fill" :style="{ width: calculateRotationProgress(rotationDetailsModal.rotation) + '%', background: getProgressColor(calculateRotationProgress(rotationDetailsModal.rotation)) }" 
                                                 style="height: 100%; transition: width 0.3s ease;"></div>
                                        </div>
                                        <div class="progress-text" style="font-size: 12px; color: var(--medical-gray); margin-top: 4px;">
                                            {{ calculateRotationProgress(rotationDetailsModal.rotation) }}% complete
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-bullseye"></i>
                                Rotation Goals
                            </div>
                            <div class="info-item">
                                <div class="info-value" :class="rotationDetailsModal.rotation.goals ? '' : 'unavailable'">
                                    {{ rotationDetailsModal.rotation.goals || 'No specific goals defined for this rotation' }}
                                </div>
                            </div>
                        </div>

                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-sticky-note"></i>
                                Notes
                            </div>
                            <div class="info-item">
                                <div class="info-value" :class="rotationDetailsModal.rotation.notes ? '' : 'unavailable'">
                                    {{ rotationDetailsModal.rotation.notes || 'No additional notes provided' }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Evaluations Tab -->
                    <div v-if="rotationDetailsModal.activeTab === 'evaluations'" class="modal-tab-content active" role="tabpanel">
                        <div v-if="rotationDetailsModal.evaluations.length === 0" class="empty-state">
                            <i class="fas fa-star empty-state-icon"></i>
                            <div class="empty-state-title">No Evaluations</div>
                            <div class="empty-state-description">
                                No evaluations have been completed for this rotation yet.
                            </div>
                            <button class="btn btn-primary mt-4" @click="addEvaluation(rotationDetailsModal.rotation)"
                                    v-if="hasPermission('resident_rotations', 'update')">
                                <i class="fas fa-plus"></i> Add Evaluation
                            </button>
                        </div>
                        
                        <div v-else>
                            <div v-for="evaluation in rotationDetailsModal.evaluations" :key="evaluation.id" class="evaluation-card" 
                                 style="background: white; border-radius: var(--border-radius-md); padding: 20px; margin-bottom: 16px; border: 1px solid var(--medical-light-blue);">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
                                    <div>
                                        <div style="font-weight: 600; color: var(--medical-dark-blue);">Evaluation by {{ evaluation.evaluator_name }}</div>
                                        <div style="font-size: 12px; color: var(--medical-gray);">{{ formatDateTime(evaluation.evaluation_date) }}</div>
                                    </div>
                                    <span class="badge" :class="evaluation.overall_rating >= 4 ? 'badge-success' : evaluation.overall_rating >= 3 ? 'badge-warning' : 'badge-danger'">
                                        {{ evaluation.overall_rating }}/5
                                    </span>
                                </div>
                                
                                <div class="evaluation-details" style="margin-top: 12px;">
                                    <div v-for="(rating, category) in evaluation.category_ratings" :key="category" 
                                         class="evaluation-category" style="margin-bottom: 8px;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                            <span style="font-size: 13px; color: var(--medical-gray); text-transform: capitalize;">
                                                {{ category.replace('_', ' ') }}
                                            </span>
                                            <span style="font-size: 12px; font-weight: 500; color: var(--medical-blue);">
                                                {{ rating }}/5
                                            </span>
                                        </div>
                                        <div class="progress-bar" style="width: 100%; height: 4px; background: var(--medical-light-blue); border-radius: 2px;">
                                            <div class="progress-fill" :style="{ width: (rating / 5 * 100) + '%', background: getRatingColor(rating) }" 
                                                 style="height: 100%;"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div v-if="evaluation.comments" class="evaluation-comments" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--medical-light-blue);">
                                    <div style="font-weight: 500; margin-bottom: 4px;">Comments:</div>
                                    <div style="font-size: 13px; color: var(--gray-700);">{{ evaluation.comments }}</div>
                                </div>
                            </div>
                            
                            <div class="flex justify-end mt-4">
                                <button class="btn btn-primary" @click="addEvaluation(rotationDetailsModal.rotation)"
                                        v-if="hasPermission('resident_rotations', 'update')">
                                    <i class="fas fa-plus"></i> Add New Evaluation
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Milestones Tab -->
                    <div v-if="rotationDetailsModal.activeTab === 'milestones'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-flag-checkered"></i>
                                Rotation Milestones
                            </div>
                            
                            <div v-if="rotationDetailsModal.milestones.length === 0" class="empty-state">
                                <i class="fas fa-flag empty-state-icon"></i>
                                <div class="empty-state-title">No Milestones</div>
                                <div class="empty-state-description">
                                    No milestones have been defined for this rotation.
                                </div>
                                <button class="btn btn-primary mt-4" @click="addMilestone(rotationDetailsModal.rotation)"
                                        v-if="hasPermission('resident_rotations', 'update')">
                                    <i class="fas fa-plus"></i> Add Milestone
                                </button>
                            </div>
                            
                            <div v-else>
                                <div class="timeline" style="position: relative; padding-left: 30px;">
                                    <div v-for="milestone in rotationDetailsModal.milestones" :key="milestone.id" 
                                         class="timeline-event" style="position: relative; padding-bottom: 20px;">
                                        <div :style="{ background: milestone.completed ? 'var(--medical-green)' : 'var(--medical-blue)' }" 
                                             style="position: absolute; left: -30px; top: 0; width: 20px; height: 20px; border-radius: 50%;"></div>
                                        <div class="timeline-content" style="padding-left: 10px;">
                                            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                                <div style="font-weight: 500; color: var(--medical-dark-blue);">{{ milestone.title }}</div>
                                                <span class="badge" :class="milestone.completed ? 'badge-success' : 'badge-warning'">
                                                    {{ milestone.completed ? 'Completed' : 'Pending' }}
                                                </span>
                                            </div>
                                            <div style="font-size: 12px; color: var(--medical-gray); margin-top: 4px;">
                                                <i class="fas fa-calendar"></i> Due: {{ formatDate(milestone.due_date) }}
                                                <span v-if="milestone.completed" style="margin-left: 10px;">
                                                    <i class="fas fa-check-circle"></i> Completed: {{ formatDate(milestone.completed_date) }}
                                                </span>
                                            </div>
                                            <div v-if="milestone.description" style="font-size: 13px; color: var(--gray-700); margin-top: 8px;">
                                                {{ milestone.description }}
                                            </div>
                                            <div v-if="milestone.comments" style="font-size: 12px; color: var(--gray-600); margin-top: 4px; font-style: italic;">
                                                {{ milestone.comments }}
                                            </div>
                                            
                                            <div class="mt-3 flex gap-2">
                                                <button class="btn btn-sm btn-primary" @click="toggleMilestoneCompletion(milestone)"
                                                        v-if="hasPermission('resident_rotations', 'update')">
                                                    <i class="fas" :class="milestone.completed ? 'fa-undo' : 'fa-check'"></i>
                                                    {{ milestone.completed ? 'Mark Incomplete' : 'Mark Complete' }}
                                                </button>
                                                <button class="btn btn-sm btn-secondary" @click="editMilestone(milestone)"
                                                        v-if="hasPermission('resident_rotations', 'update')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-end mt-4">
                                    <button class="btn btn-primary" @click="addMilestone(rotationDetailsModal.rotation)"
                                            v-if="hasPermission('resident_rotations', 'update')">
                                        <i class="fas fa-plus"></i> Add New Milestone
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Documents Tab -->
                    <div v-if="rotationDetailsModal.activeTab === 'documents'" class="modal-tab-content active" role="tabpanel">
                        <div class="info-section">
                            <div class="info-section-title">
                                <i class="fas fa-folder"></i>
                                Rotation Documents
                            </div>
                            
                            <div class="flex justify-between items-center mb-4">
                                <div class="text-sm text-gray-600">
                                    {{ rotationDetailsModal.documents.length }} document(s) attached
                                </div>
                                <button class="btn btn-sm btn-primary" @click="uploadDocument(rotationDetailsModal.rotation)"
                                        v-if="hasPermission('resident_rotations', 'update')">
                                    <i class="fas fa-upload"></i> Upload Document
                                </button>
                            </div>
                            
                            <div v-if="rotationDetailsModal.documents.length === 0" class="empty-state">
                                <i class="fas fa-file empty-state-icon"></i>
                                <div class="empty-state-title">No Documents</div>
                                <div class="empty-state-description">
                                    No documents have been uploaded for this rotation.
                                </div>
                            </div>
                            
                            <div v-else class="documents-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 16px;">
                                <div v-for="document in rotationDetailsModal.documents" :key="document.id" class="document-card" 
                                     style="background: white; border-radius: var(--border-radius-md); padding: 16px; border: 1px solid var(--medical-light-blue);">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                        <div :class="getDocumentIconClass(document.type)" 
                                             style="width: 40px; height: 40px; border-radius: var(--border-radius-sm); display: flex; align-items: center; justify-content: center; color: white; font-size: 16px;">
                                            <i :class="getDocumentIcon(document.type)"></i>
                                        </div>
                                        <div style="flex: 1; min-width: 0;">
                                            <div style="font-weight: 500; color: var(--medical-dark-blue); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                                {{ document.title }}
                                            </div>
                                            <div style="font-size: 11px; color: var(--medical-gray);">
                                                {{ formatFileSize(document.size) }}  {{ document.type.toUpperCase() }}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style="font-size: 12px; color: var(--gray-600); margin-bottom: 12px;">
                                        <div>Uploaded by: {{ document.uploaded_by }}</div>
                                        <div>{{ formatDateTime(document.uploaded_at) }}</div>
                                    </div>
                                    
                                    <div class="flex gap-2">
                                        <button class="btn btn-sm btn-primary flex-1" @click="downloadDocument(document)">
                                            <i class="fas fa-download"></i> Download
                                        </button>
                                        <button class="btn btn-sm btn-danger" @click="deleteDocument(document.id)"
                                                v-if="hasPermission('resident_rotations', 'delete')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="rotationDetailsModal.show = false">Close</button>
                    <button class="btn btn-primary" @click="editRotation(rotationDetailsModal.rotation)"
                            v-if="hasPermission('resident_rotations', 'update')">
                        <i class="fas fa-edit"></i> Edit Rotation
                    </button>
                    <button class="btn btn-success" @click="generateRotationReport(rotationDetailsModal.rotation)"
                            v-if="hasPermission('resident_rotations', 'export')">
                        <i class="fas fa-file-pdf"></i> Generate Report
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 17: Drag and Drop Modal for Dashboard Customization -->
        <div v-if="dashboardCustomizeModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="dashboard-customize-title">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-title" id="dashboard-customize-title">
                        <i class="fas fa-th-large"></i>
                        Customize Dashboard
                    </div>
                    <button class="modal-close" @click="dashboardCustomizeModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-columns"></i>
                            Dashboard Layout
                        </div>
                        
                        <div class="mb-6">
                            <p class="text-gray-600 mb-4">Drag and drop widgets to rearrange your dashboard layout. Changes are automatically saved.</p>
                            
                            <div class="dashboard-preview" style="border: 2px dashed var(--medical-light-blue); border-radius: var(--border-radius-md); padding: 20px; min-height: 400px;">
                                <div class="grid grid-cols-2 gap-4 mb-4">
                                    <div v-for="widget in dashboardCustomizeModal.widgets" :key="widget.id" 
                                         class="widget-item" draggable="true"
                                         @dragstart="handleDragStart($event, widget.id)"
                                         @dragover.prevent
                                         @drop="handleDrop($event, widget.id)"
                                         :style="{ order: widget.order }"
                                         style="background: white; border-radius: var(--border-radius-md); padding: 16px; border: 1px solid var(--medical-light-blue); cursor: move;">
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <div style="color: var(--medical-blue);">
                                                <i :class="widget.icon"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div style="font-weight: 500; color: var(--medical-dark-blue);">{{ widget.title }}</div>
                                                <div style="font-size: 12px; color: var(--medical-gray);">{{ widget.description }}</div>
                                            </div>
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input" 
                                                       :id="'widget-' + widget.id"
                                                       v-model="widget.enabled"
                                                       @change="toggleWidget(widget.id)">
                                                <label class="form-check-label" :for="'widget-' + widget.id"></label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-palette"></i>
                            Display Settings
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Default View</label>
                                <select class="form-select" v-model="dashboardCustomizeModal.settings.defaultView">
                                    <option value="daily_operations">Daily Operations</option>
                                    <option value="medical_staff">Medical Staff</option>
                                    <option value="resident_rotations">Resident Rotations</option>
                                    <option value="communications">Communications</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Theme</label>
                                <select class="form-select" v-model="dashboardCustomizeModal.settings.theme">
                                    <option value="light">Light Theme</option>
                                    <option value="dark">Dark Theme</option>
                                    <option value="medical">Medical Blue</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="dashboardCustomizeModal.settings.showQuickActions">
                                <span class="form-check-label">Show Quick Actions Bar</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="dashboardCustomizeModal.settings.showRecentActivity">
                                <span class="form-check-label">Show Recent Activity</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="dashboardCustomizeModal.settings.showStatistics">
                                <span class="form-check-label">Show Statistics Widgets</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-check">
                                <input type="checkbox" class="form-check-input" v-model="dashboardCustomizeModal.settings.autoRefresh">
                                <span class="form-check-label">Auto-refresh Dashboard Data</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="dashboardCustomizeModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="resetDashboardLayout">
                        <i class="fas fa-redo"></i> Reset to Default
                    </button>
                    <button class="btn btn-success" @click="saveDashboardCustomization" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else><i class="fas fa-save"></i> Save Changes</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 18: Advanced Search Modal -->
        <div v-if="advancedSearchModal.show" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="advanced-search-title">
            <div class="modal-container modal-wide">
                <div class="modal-header">
                    <div class="modal-title" id="advanced-search-title">
                        <i class="fas fa-search-plus"></i>
                        Advanced Search
                    </div>
                    <button class="modal-close" @click="advancedSearchModal.show = false" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-tabs" role="tablist">
                        <button class="modal-tab" :class="{ active: advancedSearchModal.activeTab === 'staff' }" 
                                @click="advancedSearchModal.activeTab = 'staff'" role="tab" aria-selected="advancedSearchModal.activeTab === 'staff'">
                            <i class="fas fa-user-md"></i> Staff Search
                        </button>
                        <button class="modal-tab" :class="{ active: advancedSearchModal.activeTab === 'rotations' }" 
                                @click="advancedSearchModal.activeTab = 'rotations'" role="tab" aria-selected="advancedSearchModal.activeTab === 'rotations'">
                            <i class="fas fa-calendar-alt"></i> Rotations Search
                        </button>
                        <button class="modal-tab" :class="{ active: advancedSearchModal.activeTab === 'documents' }" 
                                @click="advancedSearchModal.activeTab = 'documents'" role="tab" aria-selected="advancedSearchModal.activeTab === 'documents'">
                            <i class="fas fa-file"></i> Documents Search
                        </button>
                        <button class="modal-tab" :class="{ active: advancedSearchModal.activeTab === 'schedule' }" 
                                @click="advancedSearchModal.activeTab = 'schedule'" role="tab" aria-selected="advancedSearchModal.activeTab === 'schedule'">
                            <i class="fas fa-calendar"></i> Schedule Search
                        </button>
                    </div>

                    <!-- Staff Search Tab -->
                    <div v-if="advancedSearchModal.activeTab === 'staff'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-filter"></i>
                                Staff Search Criteria
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Name Contains</label>
                                    <input type="text" class="form-control" v-model="advancedSearchModal.filters.staff.name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Staff Type</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.staff.staff_type">
                                        <option value="">All Types</option>
                                        <option value="medical_resident">Medical Resident</option>
                                        <option value="attending_physician">Attending Physician</option>
                                        <option value="fellow">Fellow</option>
                                        <option value="nurse_practitioner">Nurse Practitioner</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Department</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.staff.department_id">
                                        <option value="">All Departments</option>
                                        <option v-for="department in departments" :key="department.id" :value="department.id">
                                            {{ department.name }}
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.staff.status">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="on_leave">On Leave</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Specialization Contains</label>
                                    <input type="text" class="form-control" v-model="advancedSearchModal.filters.staff.specialization">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Years Experience</label>
                                    <div class="flex gap-2">
                                        <input type="number" class="form-control" v-model="advancedSearchModal.filters.staff.min_experience" 
                                               placeholder="Min" min="0" max="50">
                                        <input type="number" class="form-control" v-model="advancedSearchModal.filters.staff.max_experience" 
                                               placeholder="Max" min="0" max="50">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Rotations Search Tab -->
                    <div v-if="advancedSearchModal.activeTab === 'rotations'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-filter"></i>
                                Rotation Search Criteria
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Resident Name</label>
                                    <input type="text" class="form-control" v-model="advancedSearchModal.filters.rotations.resident_name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Training Unit</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.rotations.training_unit_id">
                                        <option value="">All Units</option>
                                        <option v-for="unit in trainingUnits" :key="unit.id" :value="unit.id">
                                            {{ unit.name }}
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.rotations.status">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="upcoming">Upcoming</option>
                                        <option value="completed">Completed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Supervisor</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.rotations.supervisor_id">
                                        <option value="">All Supervisors</option>
                                        <option v-for="supervisor in availableSupervisors" :key="supervisor.id" :value="supervisor.id">
                                            {{ supervisor.full_name }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Start Date Range</label>
                                    <div class="flex gap-2">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.rotations.start_date_from">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.rotations.start_date_to">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">End Date Range</label>
                                    <div class="flex gap-2">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.rotations.end_date_from">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.rotations.end_date_to">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Documents Search Tab -->
                    <div v-if="advancedSearchModal.activeTab === 'documents'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-filter"></i>
                                Document Search Criteria
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Document Title</label>
                                    <input type="text" class="form-control" v-model="advancedSearchModal.filters.documents.title">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Document Type</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.documents.type">
                                        <option value="">All Types</option>
                                        <option value="pdf">PDF</option>
                                        <option value="doc">Word Document</option>
                                        <option value="xls">Excel</option>
                                        <option value="image">Image</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Uploaded By</label>
                                    <input type="text" class="form-control" v-model="advancedSearchModal.filters.documents.uploaded_by">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Associated Module</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.documents.module">
                                        <option value="">All Modules</option>
                                        <option value="medical_staff">Medical Staff</option>
                                        <option value="resident_rotations">Resident Rotations</option>
                                        <option value="training_units">Training Units</option>
                                        <option value="communications">Communications</option>
                                        <option value="audit">Audit</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Upload Date Range</label>
                                    <div class="flex gap-2">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.documents.upload_date_from">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.documents.upload_date_to">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">File Size Range (KB)</label>
                                    <div class="flex gap-2">
                                        <input type="number" class="form-control" v-model="advancedSearchModal.filters.documents.min_size" 
                                               placeholder="Min" min="0">
                                        <input type="number" class="form-control" v-model="advancedSearchModal.filters.documents.max_size" 
                                               placeholder="Max" min="0">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Content Contains</label>
                                <input type="text" class="form-control" v-model="advancedSearchModal.filters.documents.content">
                            </div>
                        </div>
                    </div>

                    <!-- Schedule Search Tab -->
                    <div v-if="advancedSearchModal.activeTab === 'schedule'" class="modal-tab-content active" role="tabpanel">
                        <div class="modal-section">
                            <div class="modal-section-title">
                                <i class="fas fa-filter"></i>
                                Schedule Search Criteria
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Physician Name</label>
                                    <input type="text" class="form-control" v-model="advancedSearchModal.filters.schedule.physician_name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Role</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.schedule.role">
                                        <option value="">All Roles</option>
                                        <option value="primary">Primary On-call</option>
                                        <option value="secondary">Secondary On-call</option>
                                        <option value="backup">Backup</option>
                                        <option value="supervisor">Supervisor</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Coverage Area</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.schedule.coverage_area">
                                        <option value="">All Areas</option>
                                        <option value="emergency">Emergency Department</option>
                                        <option value="icu">Intensive Care Unit</option>
                                        <option value="ward">General Ward</option>
                                        <option value="consultation">Consultations</option>
                                        <option value="all">All Areas</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" v-model="advancedSearchModal.filters.schedule.status">
                                        <option value="">All Status</option>
                                        <option value="scheduled">Scheduled</option>
                                        <option value="active">Active</option>
                                        <option value="completed">Completed</option>
                                        <option value="cancelled">Cancelled</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Date Range</label>
                                    <div class="flex gap-2">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.schedule.date_from">
                                        <input type="date" class="form-control" v-model="advancedSearchModal.filters.schedule.date_to">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Time Range</label>
                                    <div class="flex gap-2">
                                        <input type="time" class="form-control" v-model="advancedSearchModal.filters.schedule.time_from">
                                        <input type="time" class="form-control" v-model="advancedSearchModal.filters.schedule.time_to">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-sort"></i>
                            Sort & Display Options
                        </div>
                        
                        <div class="grid grid-cols-3 gap-4">
                            <div class="form-group">
                                <label class="form-label">Sort By</label>
                                <select class="form-select" v-model="advancedSearchModal.sortBy">
                                    <option value="relevance">Relevance</option>
                                    <option value="name">Name</option>
                                    <option value="date">Date</option>
                                    <option value="status">Status</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Sort Order</label>
                                <select class="form-select" v-model="advancedSearchModal.sortOrder">
                                    <option value="asc">Ascending</option>
                                    <option value="desc">Descending</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Results Per Page</label>
                                <select class="form-select" v-model="advancedSearchModal.resultsPerPage">
                                    <option value="10">10</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <i class="fas fa-search"></i>
                            Search Preview
                        </div>
                        
                        <div class="search-preview" style="background: var(--medical-light-blue); border-radius: var(--border-radius-md); padding: 16px;">
                            <div class="text-sm text-gray-600 mb-2">Search will look for:</div>
                            <div class="text-sm">
                                <div v-if="advancedSearchModal.activeTab === 'staff'">
                                    <span v-if="advancedSearchModal.filters.staff.name">Staff with name containing "{{ advancedSearchModal.filters.staff.name }}"</span>
                                    <span v-if="advancedSearchModal.filters.staff.staff_type">, Type: {{ advancedSearchModal.filters.staff.staff_type }}</span>
                                    <span v-if="advancedSearchModal.filters.staff.department_id">, Department: {{ getDepartmentName(advancedSearchModal.filters.staff.department_id) }}</span>
                                    <span v-if="advancedSearchModal.filters.staff.status">, Status: {{ advancedSearchModal.filters.staff.status }}</span>
                                </div>
                                <div v-if="advancedSearchModal.activeTab === 'rotations'">
                                    <span v-if="advancedSearchModal.filters.rotations.resident_name">Rotations for resident "{{ advancedSearchModal.filters.rotations.resident_name }}"</span>
                                    <span v-if="advancedSearchModal.filters.rotations.training_unit_id">, Unit: {{ getTrainingUnitName(advancedSearchModal.filters.rotations.training_unit_id) }}</span>
                                    <span v-if="advancedSearchModal.filters.rotations.status">, Status: {{ advancedSearchModal.filters.rotations.status }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="advancedSearchModal.show = false">Cancel</button>
                    <button class="btn btn-primary" @click="clearAdvancedSearch">
                        <i class="fas fa-eraser"></i> Clear Filters
                    </button>
                    <button class="btn btn-success" @click="performAdvancedSearch" :disabled="saving">
                        <span v-if="saving" class="loading"></span>
                        <span v-else><i class="fas fa-search"></i> Search</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL 19: Confirmation Modal -->
        <div v-if="confirmationModal && confirmationModal.show" class="modal-overlay" role="dialog" aria-modal="true" 
             aria-labelledby="confirmation-title" aria-describedby="confirmation-message">
            <div class="modal-container" style="max-width: 500px;">
                <div class="modal-header">
                    <div class="modal-title" id="confirmation-title">
                        <i class="fas" :class="confirmationModal.icon || 'fa-question-circle'"></i>
                        {{ confirmationModal.title || 'Confirm Action' }}
                    </div>
                    <button class="modal-close" @click="cancelConfirmation" aria-label="Close confirmation dialog">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p id="confirmation-message" style="text-align: center; margin: 20px 0; font-size: 16px; color: var(--gray-700); line-height: 1.5;">
                        {{ confirmationModal.message || 'Are you sure you want to proceed?' }}
                    </p>
                    <div v-if="confirmationModal.details" style="background: var(--medical-light-blue); padding: 16px; border-radius: var(--border-radius-md); margin-top: 16px; font-size: 14px; color: var(--medical-dark-blue);">
                        <i class="fas fa-info-circle" style="margin-right: 8px;"></i>
                        {{ confirmationModal.details }}
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="cancelConfirmation" :disabled="saving">
                        {{ confirmationModal.cancelButtonText || 'Cancel' }}
                    </button>
                    <button class="btn" :class="confirmationModal.confirmButtonClass || 'btn-danger'" @click="confirmAction" :disabled="saving">
                        <template v-if="saving">
                            <span class="loading-spinner" style="display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite;"></span>
                        </template>
                        <template v-else>
                            <i :class="confirmationModal.confirmButtonIcon || 'fa-check'" style="margin-right: 8px;"></i>
                            {{ confirmationModal.confirmButtonText || 'Confirm' }}
                        </template>
                    </button>
                </div>
            </div>
        </div>
    </div>
            </div>

    <!-- Load your Vue app AFTER Vue is loaded and AFTER the template -->
    <script src="app.js"></script>
    
    <!-- Safety check -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Vue === 'undefined') {
                console.error('Vue.js failed to load!');
                alert('Vue.js failed to load. Please refresh the page.');
            }
        });
    </script>
</body>
</html>
