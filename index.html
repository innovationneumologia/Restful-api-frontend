<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeumoCare | Pulmonology Management System</title>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <style>
        /* ============ NEUMOCARE MEDICAL DESIGN SYSTEM v9.0 ============ */
/* Complete UI/UX Redesign with Mobile-First Responsiveness */
/* ============================================================ */

/* ============ 1. DESIGN SYSTEM TOKENS ============ */
:root {
  /* === MEDICAL COLOR PALETTE === */
  --medical-blue: #0066CC;          /* Primary - Trust, Stability */
  --medical-blue-light: #3399FF;    /* Primary Light - Interactive */
  --medical-blue-dark: #0052A3;     /* Primary Dark - Active States */
  --medical-teal: #0099AA;          /* Secondary - Healing, Calm */
  --medical-teal-light: #33CCCC;    /* Secondary Light */
  --medical-emerald: #00A86B;       /* Success - Healthy, Complete */
  --medical-amber: #FF9900;         /* Warning - Attention Needed */
  --medical-crimson: #CC3333;       /* Danger - Critical, Alert */
  --medical-slate: #334455;         /* Neutral - Professional */
  --medical-mint: #E0F7FA;          /* Background - Clean, Sterile */
  --medical-ivory: #F9F9F7;         /* Surface - Warm White */
  
  /* === SEMANTIC TOKENS === */
  --primary: var(--medical-blue);
  --primary-light: var(--medical-blue-light);
  --primary-dark: var(--medical-blue-dark);
  --secondary: var(--medical-teal);
  --success: var(--medical-emerald);
  --warning: var(--medical-amber);
  --danger: var(--medical-crimson);
  --neutral: var(--medical-slate);
  
  /* === SURFACE & BACKGROUND === */
  --surface: #FFFFFF;
  --surface-alt: #F8FAFC;
  --surface-elevated: #FFFFFF;
  --background: var(--medical-mint);
  --background-alt: #F0F9FF;
  
  /* === BORDERS & DIVIDERS === */
  --border: #E2E8F0;
  --border-light: #F1F5F9;
  --border-dark: #CBD5E1;
  --divider: #E2E8F0;
  
  /* === TEXT COLORS === */
  --text-primary: #1E293B;
  --text-secondary: #475569;
  --text-tertiary: #64748B;
  --text-disabled: #94A3B8;
  --text-on-primary: #FFFFFF;
  --text-on-dark: #FFFFFF;
  
  /* === SHADOWS & ELEVATION === */
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 
               0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 
               0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 
               0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --shadow-inset: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
  
  /* === SPACING SYSTEM (8px Grid) === */
  --space-0: 0px;
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;
  --space-16: 64px;
  --space-20: 80px;
  
  /* === TYPOGRAPHY SCALE === */
  --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-family-heading: 'Poppins', var(--font-family);
  
  --text-xs: 0.75rem;     /* 12px */
  --text-sm: 0.875rem;    /* 14px */
  --text-base: 1rem;      /* 16px */
  --text-lg: 1.125rem;    /* 18px */
  --text-xl: 1.25rem;     /* 20px */
  --text-2xl: 1.5rem;     /* 24px */
  --text-3xl: 1.875rem;   /* 30px */
  --text-4xl: 2.25rem;    /* 36px */
  --text-5xl: 3rem;       /* 48px */
  
  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  
  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;
  
  /* === BORDER RADIUS === */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-2xl: 24px;
  --radius-full: 9999px;
  
  /* === MEDICAL-SPECIFIC === */
  --status-height: 32px;
  --card-radius: var(--radius-lg);
  --modal-radius: var(--radius-xl);
  --input-radius: var(--radius-md);
  --button-radius: var(--radius-md);
  
  /* === ANIMATION & TRANSITIONS === */
  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-bounce: 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
  
  /* === Z-INDEX LAYERS === */
  --z-dropdown: 10;
  --z-sticky: 20;
  --z-fixed: 30;
  --z-modal-backdrop: 40;
  --z-modal: 50;
  --z-popover: 60;
  --z-tooltip: 70;
  --z-toast: 80;
  --z-max: 999;
  
  /* === RESPONSIVE BREAKPOINTS === */
  --screen-xs: 480px;
  --screen-sm: 640px;
  --screen-md: 768px;
  --screen-lg: 1024px;
  --screen-xl: 1280px;
  --screen-2xl: 1536px;
}

/* ============ 2. BASE RESETS & DEFAULTS ============ */
*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: transparent;
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-family);
  font-size: var(--text-base);
  line-height: var(--line-height-normal);
  color: var(--text-primary);
  background-color: var(--background);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  min-height: 100vh;
  overflow-x: hidden;
}

[v-cloak] {
  display: none !important;
}

/* ============ 3. TYPOGRAPHY SYSTEM ============ */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-family-heading);
  font-weight: var(--font-weight-semibold);
  line-height: var(--line-height-tight);
  color: var(--text-primary);
  margin-bottom: var(--space-4);
}

h1 { font-size: var(--text-4xl); }
h2 { font-size: var(--text-3xl); }
h3 { font-size: var(--text-2xl); }
h4 { font-size: var(--text-xl); }
h5 { font-size: var(--text-lg); }
h6 { font-size: var(--text-base); }

p {
  margin-bottom: var(--space-4);
  line-height: var(--line-height-relaxed);
}

.text-xs { font-size: var(--text-xs); }
.text-sm { font-size: var(--text-sm); }
.text-base { font-size: var(--text-base); }
.text-lg { font-size: var(--text-lg); }
.text-xl { font-size: var(--text-xl); }
.text-2xl { font-size: var(--text-2xl); }
.text-3xl { font-size: var(--text-3xl); }
.text-4xl { font-size: var(--text-4xl); }

.text-light { font-weight: var(--font-weight-light); }
.text-normal { font-weight: var(--font-weight-normal); }
.text-medium { font-weight: var(--font-weight-medium); }
.text-semibold { font-weight: var(--font-weight-semibold); }
.text-bold { font-weight: var(--font-weight-bold); }

.text-primary { color: var(--text-primary); }
.text-secondary { color: var(--text-secondary); }
.text-tertiary { color: var(--text-tertiary); }
.text-disabled { color: var(--text-disabled); }

.text-medical-blue { color: var(--medical-blue); }
.text-medical-teal { color: var(--medical-teal); }
.text-medical-emerald { color: var(--medical-emerald); }
.text-medical-amber { color: var(--medical-amber); }
.text-medical-crimson { color: var(--medical-crimson); }

/* ============ 4. LAYOUT & SPACING UTILITIES ============ */
.container {
  width: 100%;
  max-width: var(--screen-xl);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--space-4);
  padding-right: var(--space-4);
}

/* Spacing Utilities */
.m-0 { margin: var(--space-0); }
.m-1 { margin: var(--space-1); }
.m-2 { margin: var(--space-2); }
.m-3 { margin: var(--space-3); }
.m-4 { margin: var(--space-4); }
.m-6 { margin: var(--space-6); }
.m-8 { margin: var(--space-8); }

.mt-0 { margin-top: var(--space-0); }
.mt-1 { margin-top: var(--space-1); }
.mt-2 { margin-top: var(--space-2); }
.mt-3 { margin-top: var(--space-3); }
.mt-4 { margin-top: var(--space-4); }
.mt-6 { margin-top: var(--space-6); }
.mt-8 { margin-top: var(--space-8); }

.mb-0 { margin-bottom: var(--space-0); }
.mb-1 { margin-bottom: var(--space-1); }
.mb-2 { margin-bottom: var(--space-2); }
.mb-3 { margin-bottom: var(--space-3); }
.mb-4 { margin-bottom: var(--space-4); }
.mb-6 { margin-bottom: var(--space-6); }
.mb-8 { margin-bottom: var(--space-8); }

.p-0 { padding: var(--space-0); }
.p-1 { padding: var(--space-1); }
.p-2 { padding: var(--space-2); }
.p-3 { padding: var(--space-3); }
.p-4 { padding: var(--space-4); }
.p-6 { padding: var(--space-6); }
.p-8 { padding: var(--space-8); }

.pt-0 { padding-top: var(--space-0); }
.pt-1 { padding-top: var(--space-1); }
.pt-2 { padding-top: var(--space-2); }
.pt-3 { padding-top: var(--space-3); }
.pt-4 { padding-top: var(--space-4); }
.pt-6 { padding-top: var(--space-6); }
.pt-8 { padding-top: var(--space-8); }

.pb-0 { padding-bottom: var(--space-0); }
.pb-1 { padding-bottom: var(--space-1); }
.pb-2 { padding-bottom: var(--space-2); }
.pb-3 { padding-bottom: var(--space-3); }
.pb-4 { padding-bottom: var(--space-4); }
.pb-6 { padding-bottom: var(--space-6); }
.pb-8 { padding-bottom: var(--space-8); }

/* Flex Utilities */
.flex { display: flex; }
.inline-flex { display: inline-flex; }
.flex-col { flex-direction: column; }
.flex-row { flex-direction: row; }
.flex-wrap { flex-wrap: wrap; }
.flex-nowrap { flex-wrap: nowrap; }

.items-start { align-items: flex-start; }
.items-center { align-items: center; }
.items-end { align-items: flex-end; }
.items-stretch { align-items: stretch; }

.justify-start { justify-content: flex-start; }
.justify-center { justify-content: center; }
.justify-end { justify-content: flex-end; }
.justify-between { justify-content: space-between; }
.justify-around { justify-content: space-around; }

.flex-1 { flex: 1 1 0%; }
.flex-auto { flex: 1 1 auto; }
.flex-none { flex: none; }

.gap-1 { gap: var(--space-1); }
.gap-2 { gap: var(--space-2); }
.gap-3 { gap: var(--space-3); }
.gap-4 { gap: var(--space-4); }
.gap-6 { gap: var(--space-6); }
.gap-8 { gap: var(--space-8); }

/* Grid Utilities */
.grid { display: grid; }
.grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
.grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
.grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
.grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
.grid-cols-5 { grid-template-columns: repeat(5, 1fr); }
.grid-cols-6 { grid-template-columns: repeat(6, 1fr); }
.grid-cols-12 { grid-template-columns: repeat(12, 1fr); }

.col-span-1 { grid-column: span 1; }
.col-span-2 { grid-column: span 2; }
.col-span-3 { grid-column: span 3; }
.col-span-4 { grid-column: span 4; }
.col-span-5 { grid-column: span 5; }
.col-span-6 { grid-column: span 6; }
.col-span-12 { grid-column: span 12; }

/* Display Utilities */
.block { display: block; }
.inline-block { display: inline-block; }
.inline { display: inline; }
.hidden { display: none; }

/* Width & Height */
.w-full { width: 100%; }
.w-screen { width: 100vw; }
.w-auto { width: auto; }
.w-1\/2 { width: 50%; }
.w-1\/3 { width: 33.333333%; }
.w-2\/3 { width: 66.666667%; }
.w-1\/4 { width: 25%; }
.w-3\/4 { width: 75%; }

.h-full { height: 100%; }
.h-screen { height: 100vh; }
.h-auto { height: auto; }
.min-h-screen { min-height: 100vh; }

/* Positioning */
.relative { position: relative; }
.absolute { position: absolute; }
.fixed { position: fixed; }
.sticky { position: sticky; }

.inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
.top-0 { top: 0; }
.right-0 { right: 0; }
.bottom-0 { bottom: 0; }
.left-0 { left: 0; }

.z-0 { z-index: 0; }
.z-10 { z-index: 10; }
.z-20 { z-index: 20; }
.z-30 { z-index: 30; }
.z-40 { z-index: 40; }
.z-50 { z-index: 50; }

/* ============ 5. MEDICAL STATUS SYSTEM ============ */
.status-indicator {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-full);
  font-size: var(--text-xs);
  font-weight: var(--font-weight-semibold);
  line-height: 1;
  text-transform: uppercase;
  letter-spacing: 0.025em;
  border: 1px solid transparent;
  transition: all var(--transition-fast);
}

.status-indicator::before {
  content: '';
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* Status Variants */
.status-active {
  background-color: rgba(0, 168, 107, 0.1);
  color: var(--medical-emerald);
  border-color: rgba(0, 168, 107, 0.2);
}
.status-active::before {
  background-color: var(--medical-emerald);
  animation: pulse-success 2s infinite;
}

.status-busy {
  background-color: rgba(255, 153, 0, 0.1);
  color: var(--medical-amber);
  border-color: rgba(255, 153, 0, 0.2);
}
.status-busy::before {
  background-color: var(--medical-amber);
}

.status-critical {
  background-color: rgba(204, 51, 51, 0.1);
  color: var(--medical-crimson);
  border-color: rgba(204, 51, 51, 0.2);
}
.status-critical::before {
  background-color: var(--medical-crimson);
  animation: pulse-danger 1.5s infinite;
}

.status-oncall {
  background-color: rgba(0, 102, 204, 0.1);
  color: var(--medical-blue);
  border-color: rgba(0, 102, 204, 0.2);
}
.status-oncall::before {
  background-color: var(--medical-blue);
}

.status-available {
  background-color: rgba(0, 153, 170, 0.1);
  color: var(--medical-teal);
  border-color: rgba(0, 153, 170, 0.2);
}
.status-available::before {
  background-color: var(--medical-teal);
}

.status-offline {
  background-color: rgba(148, 163, 184, 0.1);
  color: var(--text-disabled);
  border-color: rgba(148, 163, 184, 0.2);
}
.status-offline::before {
  background-color: var(--text-disabled);
}

/* Status Animations */
@keyframes pulse-success {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes pulse-danger {
  0%, 100% { 
    opacity: 1;
    transform: scale(1);
  }
  50% { 
    opacity: 0.7;
    transform: scale(1.1);
  }
}

/* ============ 6. MEDICAL BADGE SYSTEM ============ */
.badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-full);
  font-size: var(--text-xs);
  font-weight: var(--font-weight-semibold);
  line-height: 1;
  text-transform: uppercase;
  letter-spacing: 0.025em;
  white-space: nowrap;
  transition: all var(--transition-fast);
}

/* Badge Variants */
.badge-primary {
  background-color: var(--medical-blue);
  color: var(--text-on-primary);
}

.badge-secondary {
  background-color: var(--medical-teal);
  color: var(--text-on-primary);
}

.badge-success {
  background-color: var(--medical-emerald);
  color: var(--text-on-primary);
}

.badge-warning {
  background-color: var(--medical-amber);
  color: var(--text-primary);
}

.badge-danger {
  background-color: var(--medical-crimson);
  color: var(--text-on-primary);
}

.badge-neutral {
  background-color: var(--medical-slate);
  color: var(--text-on-primary);
}

.badge-outline-primary {
  background-color: transparent;
  color: var(--medical-blue);
  border: 1px solid var(--medical-blue);
}

.badge-outline-success {
  background-color: transparent;
  color: var(--medical-emerald);
  border: 1px solid var(--medical-emerald);
}

.badge-outline-warning {
  background-color: transparent;
  color: var(--medical-amber);
  border: 1px solid var(--medical-amber);
}

.badge-outline-danger {
  background-color: transparent;
  color: var(--medical-crimson);
  border: 1px solid var(--medical-crimson);
}

/* ============ 7. MEDICAL BUTTON SYSTEM ============ */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-3) var(--space-6);
  border-radius: var(--button-radius);
  font-family: var(--font-family);
  font-size: var(--text-sm);
  font-weight: var(--font-weight-semibold);
  line-height: 1;
  text-decoration: none;
  text-align: center;
  cursor: pointer;
  user-select: none;
  border: 2px solid transparent;
  transition: all var(--transition-normal);
  position: relative;
  overflow: hidden;
  min-height: 44px; /* Minimum touch target size */
}

.btn:focus {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* Button Variants */
.btn-primary {
  background: linear-gradient(135deg, var(--medical-blue) 0%, var(--medical-blue-dark) 100%);
  color: var(--text-on-primary);
  box-shadow: var(--shadow-md);
}

.btn-primary:hover:not(:disabled) {
  background: linear-gradient(135deg, var(--medical-blue-light) 0%, var(--medical-blue) 100%);
  transform: translateY(-1px);
  box-shadow: var(--shadow-lg);
}

.btn-primary:active:not(:disabled) {
  transform: translateY(0);
  box-shadow: var(--shadow-sm);
}

.btn-secondary {
  background: linear-gradient(135deg, var(--medical-teal) 0%, #008899 100%);
  color: var(--text-on-primary);
  box-shadow: var(--shadow-md);
}

.btn-success {
  background: linear-gradient(135deg, var(--medical-emerald) 0%, #008755 100%);
  color: var(--text-on-primary);
  box-shadow: var(--shadow-md);
}

.btn-warning {
  background: linear-gradient(135deg, var(--medical-amber) 0%, #E68A00 100%);
  color: var(--text-primary);
  box-shadow: var(--shadow-md);
}

.btn-danger {
  background: linear-gradient(135deg, var(--medical-crimson) 0%, #B32B2B 100%);
  color: var(--text-on-primary);
  box-shadow: var(--shadow-md);
}

.btn-outline {
  background: transparent;
  color: var(--medical-blue);
  border-color: var(--medical-blue);
}

.btn-outline:hover:not(:disabled) {
  background: var(--medical-blue);
  color: var(--text-on-primary);
}

.btn-ghost {
  background: transparent;
  color: var(--text-secondary);
  border-color: transparent;
}

.btn-ghost:hover:not(:disabled) {
  background: rgba(0, 0, 0, 0.05);
  color: var(--text-primary);
}

/* Button Sizes */
.btn-sm {
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-xs);
  min-height: 36px;
}

.btn-lg {
  padding: var(--space-4) var(--space-8);
  font-size: var(--text-base);
  min-height: 52px;
}

.btn-xl {
  padding: var(--space-5) var(--space-10);
  font-size: var(--text-lg);
  min-height: 60px;
}

.btn-icon {
  width: 44px;
  height: 44px;
  padding: 0;
  border-radius: 50%;
  min-height: auto;
}

.btn-icon.btn-sm {
  width: 36px;
  height: 36px;
}

.btn-icon.btn-lg {
  width: 52px;
  height: 52px;
}

/* Loading State */
.btn-loading {
  pointer-events: none;
  opacity: 0.8;
}

.btn-loading::after {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid currentColor;
  border-right-color: transparent;
  border-radius: 50%;
  animation: button-spin 0.75s linear infinite;
  margin-left: var(--space-2);
}

@keyframes button-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ============ 8. MEDICAL CARD SYSTEM ============ */
.card {
  background-color: var(--surface);
  border-radius: var(--card-radius);
  border: 1px solid var(--border);
  overflow: hidden;
  transition: all var(--transition-normal);
}

.card:hover {
  border-color: var(--border-dark);
  box-shadow: var(--shadow-lg);
}

.card-elevated {
  box-shadow: var(--shadow-md);
  border: none;
}

.card-elevated:hover {
  box-shadow: var(--shadow-lg);
}

.card-interactive {
  cursor: pointer;
}

.card-interactive:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-xl);
}

/* Card Variants */
.card-critical {
  border-left: 4px solid var(--medical-crimson);
  background: linear-gradient(135deg, rgba(204, 51, 51, 0.02) 0%, var(--surface) 50%);
}

.card-warning {
  border-left: 4px solid var(--medical-amber);
  background: linear-gradient(135deg, rgba(255, 153, 0, 0.02) 0%, var(--surface) 50%);
}

.card-success {
  border-left: 4px solid var(--medical-emerald);
  background: linear-gradient(135deg, rgba(0, 168, 107, 0.02) 0%, var(--surface) 50%);
}

.card-info {
  border-left: 4px solid var(--medical-blue);
  background: linear-gradient(135deg, rgba(0, 102, 204, 0.02) 0%, var(--surface) 50%);
}

/* Card Components */
.card-header {
  padding: var(--space-6);
  border-bottom: 1px solid var(--border-light);
  background-color: var(--surface-alt);
}

.card-title {
  font-size: var(--text-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-1);
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.card-subtitle {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-bottom: 0;
}

.card-body {
  padding: var(--space-6);
}

.card-footer {
  padding: var(--space-6);
  border-top: 1px solid var(--border-light);
  background-color: var(--surface-alt);
  display: flex;
  justify-content: flex-end;
  gap: var(--space-3);
}

/* ============ 9. FORM SYSTEM ============ */
.form-group {
  margin-bottom: var(--space-6);
  position: relative;
}

.form-label {
  display: block;
  margin-bottom: var(--space-2);
  font-size: var(--text-sm);
  font-weight: var(--font-weight-medium);
  color: var(--text-primary);
}

.form-label.required::after {
  content: '*';
  color: var(--medical-crimson);
  margin-left: var(--space-1);
}

.form-control {
  display: block;
  width: 100%;
  padding: var(--space-3) var(--space-4);
  font-size: var(--text-base);
  font-family: var(--font-family);
  line-height: var(--line-height-normal);
  color: var(--text-primary);
  background-color: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--input-radius);
  transition: all var(--transition-fast);
  appearance: none;
}

.form-control:focus {
  outline: none;
  border-color: var(--medical-blue);
  box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
}

.form-control::placeholder {
  color: var(--text-tertiary);
}

.form-control:disabled {
  background-color: var(--surface-alt);
  cursor: not-allowed;
  opacity: 0.7;
}

/* Select Styling */
.form-select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right var(--space-4) center;
  background-size: 16px;
  padding-right: var(--space-10);
}

/* Textarea */
.form-textarea {
  min-height: 100px;
  resize: vertical;
}

/* Checkbox & Radio */
.form-check {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-2);
  cursor: pointer;
  user-select: none;
}

.form-check-input {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
  border: 2px solid var(--border);
  border-radius: 4px;
  background-color: var(--surface);
  transition: all var(--transition-fast);
  cursor: pointer;
  appearance: none;
  position: relative;
}

.form-check-input:checked {
  background-color: var(--medical-blue);
  border-color: var(--medical-blue);
}

.form-check-input:checked::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 10px;
  height: 10px;
  background-color: white;
  transform: translate(-50%, -50%);
  border-radius: 2px;
}

.form-check-input:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
}

.form-check-label {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  cursor: pointer;
}

/* Radio */
.form-radio .form-check-input {
  border-radius: 50%;
}

.form-radio .form-check-input:checked::after {
  border-radius: 50%;
}

/* Form Validation */
.form-control.is-valid {
  border-color: var(--medical-emerald);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300A86B' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right var(--space-4) center;
  background-size: 16px;
  padding-right: var(--space-10);
}

.form-control.is-invalid {
  border-color: var(--medical-crimson);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23CC3333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cline x1='15' y1='9' x2='9' y2='15'%3E%3C/line%3E%3Cline x1='9' y1='9' x2='15' y2='15'%3E%3C/line%3E%3C/svg%3E");
}

.invalid-feedback {
  display: block;
  margin-top: var(--space-1);
  font-size: var(--text-sm);
  color: var(--medical-crimson);
}

/* ============ 10. TABLE SYSTEM ============ */
.table-responsive {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  border-radius: var(--card-radius);
  border: 1px solid var(--border);
}

.table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  min-width: 640px;
}

.table thead th {
  position: sticky;
  top: 0;
  background-color: var(--surface-alt);
  padding: var(--space-4) var(--space-6);
  text-align: left;
  font-size: var(--text-xs);
  font-weight: var(--font-weight-semibold);
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border-bottom: 2px solid var(--border);
  white-space: nowrap;
  z-index: 1;
}

.table tbody tr {
  transition: all var(--transition-fast);
}

.table tbody tr:hover {
  background-color: rgba(0, 102, 204, 0.03);
}

.table tbody td {
  padding: var(--space-4) var(--space-6);
  font-size: var(--text-sm);
  color: var(--text-primary);
  border-bottom: 1px solid var(--border-light);
  vertical-align: middle;
}

.table tbody tr:last-child td {
  border-bottom: none;
}

/* Table Variants */
.table-striped tbody tr:nth-child(odd) {
  background-color: var(--surface-alt);
}

.table-striped tbody tr:nth-child(odd):hover {
  background-color: rgba(0, 102, 204, 0.05);
}

.table-compact thead th,
.table-compact tbody td {
  padding: var(--space-2) var(--space-4);
}

.table-borderless {
  border: none;
}

.table-borderless thead th {
  border-bottom: 1px solid var(--border);
}

.table-borderless tbody td {
  border-bottom: 1px solid var(--border-light);
}

/* ============ 11. MODAL SYSTEM ============ */
.modal-overlay {
  position: fixed;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-4);
  z-index: var(--z-modal-backdrop);
  animation: fade-in var(--transition-normal);
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.modal-container {
  background-color: var(--surface);
  border-radius: var(--modal-radius);
  max-width: 90%;
  max-height: 90vh;
  overflow: hidden;
  animation: modal-slide-up var(--transition-normal) cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-2xl);
}

@keyframes modal-slide-up {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Modal Sizes */
.modal-sm { max-width: 400px; }
.modal-md { max-width: 600px; }
.modal-lg { max-width: 800px; }
.modal-xl { max-width: 1000px; }
.modal-full { max-width: 100vw; }

/* Modal Header */
.modal-header {
  padding: var(--space-6);
  border-bottom: 1px solid var(--border);
  background: linear-gradient(135deg, var(--medical-blue) 0%, var(--medical-blue-dark) 100%);
  color: var(--text-on-primary);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-4);
}

.modal-title {
  font-size: var(--text-xl);
  font-weight: var(--font-weight-semibold);
  margin: 0;
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.modal-close {
  background: none;
  border: none;
  color: var(--text-on-primary);
  cursor: pointer;
  padding: var(--space-2);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition-fast);
  flex-shrink: 0;
}

.modal-close:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

/* Modal Body */
.modal-body {
  padding: var(--space-6);
  overflow-y: auto;
  flex: 1;
}

/* Modal Footer */
.modal-footer {
  padding: var(--space-6);
  border-top: 1px solid var(--border);
  background-color: var(--surface-alt);
  display: flex;
  justify-content: flex-end;
  gap: var(--space-3);
}

/* Modal Tabs */
.modal-tabs {
  display: flex;
  border-bottom: 1px solid var(--border);
  margin-bottom: var(--space-6);
  overflow-x: auto;
}

.modal-tab {
  padding: var(--space-3) var(--space-6);
  background: none;
  border: none;
  font-family: var(--font-family);
  font-size: var(--text-sm);
  font-weight: var(--font-weight-medium);
  color: var(--text-secondary);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  white-space: nowrap;
  transition: all var(--transition-fast);
}

.modal-tab:hover {
  color: var(--text-primary);
}

.modal-tab.active {
  color: var(--medical-blue);
  border-bottom-color: var(--medical-blue);
}

/* ============ 12. TOAST SYSTEM ============ */
.toast-container {
  position: fixed;
  top: var(--space-4);
  right: var(--space-4);
  z-index: var(--z-toast);
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  max-width: 400px;
  width: 100%;
}

.toast {
  background-color: var(--surface);
  border-radius: var(--card-radius);
  padding: var(--space-4);
  box-shadow: var(--shadow-lg);
  border-left: 4px solid var(--medical-blue);
  animation: toast-slide-in 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  gap: var(--space-3);
  align-items: flex-start;
}

@keyframes toast-slide-in {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.toast-icon {
  flex-shrink: 0;
  font-size: var(--text-lg);
  color: var(--medical-blue);
  margin-top: var(--space-1);
}

.toast-content {
  flex: 1;
  min-width: 0;
}

.toast-title {
  font-size: var(--text-sm);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-1);
}

.toast-message {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  line-height: var(--line-height-relaxed);
}

.toast-close {
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: var(--space-1);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all var(--transition-fast);
}

.toast-close:hover {
  background-color: rgba(0, 0, 0, 0.05);
  color: var(--text-primary);
}

/* Toast Variants */
.toast-success {
  border-left-color: var(--medical-emerald);
}
.toast-success .toast-icon {
  color: var(--medical-emerald);
}

.toast-warning {
  border-left-color: var(--medical-amber);
}
.toast-warning .toast-icon {
  color: var(--medical-amber);
}

.toast-danger {
  border-left-color: var(--medical-crimson);
}
.toast-danger .toast-icon {
  color: var(--medical-crimson);
}

.toast-info {
  border-left-color: var(--medical-teal);
}
.toast-info .toast-icon {
  color: var(--medical-teal);
}

/* ============ 13. LOGIN SCREEN ============ */
.login-container {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-4);
  background: linear-gradient(135deg, var(--medical-blue) 0%, var(--medical-teal) 100%);
}

.login-card {
  background-color: var(--surface);
  border-radius: var(--modal-radius);
  padding: var(--space-8);
  width: 100%;
  max-width: 440px;
  box-shadow: var(--shadow-xl);
  animation: fade-in-up var(--transition-normal);
}

@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.login-header {
  text-align: center;
  margin-bottom: var(--space-8);
}

.login-logo {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-3);
  margin-bottom: var(--space-4);
}

.login-logo i {
  font-size: var(--text-4xl);
  color: var(--medical-blue);
}

.login-title {
  font-size: var(--text-3xl);
  font-weight: var(--font-weight-bold);
  color: var(--medical-blue);
  margin-bottom: var(--space-2);
}

.login-subtitle {
  font-size: var(--text-base);
  color: var(--text-secondary);
}

/* ============ 14. MAIN LAYOUT ============ */
.app-layout {
  display: flex;
  min-height: 100vh;
  background-color: var(--background);
}

/* ============ 15. SIDEBAR ============ */
.sidebar {
  width: 280px;
  background: linear-gradient(180deg, var(--medical-blue) 0%, var(--medical-blue-dark) 100%);
  color: var(--text-on-primary);
  display: flex;
  flex-direction: column;
  transition: all var(--transition-normal);
  position: fixed;
  height: 100vh;
  z-index: var(--z-fixed);
  box-shadow: var(--shadow-lg);
}

.sidebar-collapsed {
  width: 72px;
}

.sidebar-header {
  padding: var(--space-6);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 80px;
}

.sidebar-logo {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  font-weight: var(--font-weight-semibold);
  font-size: var(--text-lg);
  white-space: nowrap;
  overflow: hidden;
}

.sidebar-logo i {
  font-size: var(--text-xl);
  color: var(--text-on-primary);
  flex-shrink: 0;
}

.sidebar-toggle {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: var(--text-on-primary);
  font-size: var(--text-sm);
  cursor: pointer;
  padding: var(--space-2);
  border-radius: var(--radius-md);
  transition: all var(--transition-fast);
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.sidebar-toggle:hover {
  background: rgba(255, 255, 255, 0.2);
}

.sidebar-nav {
  flex: 1;
  padding: var(--space-4) 0;
  overflow-y: auto;
  overflow-x: hidden;
}

.sidebar-section {
  margin-bottom: var(--space-6);
}

.sidebar-section-title {
  padding: 0 var(--space-6) var(--space-2);
  font-size: var(--text-xs);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: rgba(255, 255, 255, 0.6);
  font-weight: var(--font-weight-semibold);
  white-space: nowrap;
  overflow: hidden;
}

.sidebar-menu {
  list-style: none;
}

.sidebar-menu-item {
  margin: var(--space-1) 0;
}

.sidebar-menu-link {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-6);
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  transition: all var(--transition-fast);
  font-size: var(--text-sm);
  font-weight: var(--font-weight-medium);
  border-left: 3px solid transparent;
  white-space: nowrap;
  overflow: hidden;
}

.sidebar-menu-link:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text-on-primary);
  border-left-color: var(--medical-teal-light);
}

.sidebar-menu-link.active {
  background: rgba(255, 255, 255, 0.15);
  color: var(--text-on-primary);
  border-left-color: var(--medical-teal-light);
}

.sidebar-menu-link i {
  font-size: var(--text-base);
  width: 20px;
  text-align: center;
  flex-shrink: 0;
}

.sidebar-footer {
  padding: var(--space-4);
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(0, 0, 0, 0.1);
}

.sidebar-user {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--medical-teal) 0%, var(--medical-blue) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-on-primary);
  font-weight: var(--font-weight-semibold);
  font-size: var(--text-sm);
  flex-shrink: 0;
}

.user-info {
  flex: 1;
  min-width: 0;
}

.user-name {
  font-size: var(--text-sm);
  font-weight: var(--font-weight-semibold);
  color: var(--text-on-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-role {
  font-size: var(--text-xs);
  color: rgba(255, 255, 255, 0.7);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Collapsed Sidebar States */
.sidebar-collapsed .sidebar-header {
  justify-content: center;
  padding: var(--space-4);
}

.sidebar-collapsed .sidebar-logo span,
.sidebar-collapsed .sidebar-section-title,
.sidebar-collapsed .sidebar-menu-link span,
.sidebar-collapsed .user-info,
.sidebar-collapsed .sidebar-toggle span {
  display: none;
}

.sidebar-collapsed .sidebar-logo {
  justify-content: center;
}

.sidebar-collapsed .sidebar-menu-link {
  justify-content: center;
  padding: var(--space-3);
}

.sidebar-collapsed .sidebar-menu-link i {
  font-size: var(--text-lg);
}

/* ============ 16. MAIN CONTENT ============ */
.main-content {
  flex: 1;
  margin-left: 280px;
  transition: all var(--transition-normal);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.main-content-expanded {
  margin-left: 72px;
}

/* ============ 17. TOP NAVBAR ============ */
.top-navbar {
  background-color: var(--surface);
  padding: var(--space-4) var(--space-6);
  box-shadow: var(--shadow-sm);
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: var(--z-sticky);
  min-height: 72px;
}

.navbar-left {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.navbar-title {
  font-size: var(--text-xl);
  font-weight: var(--font-weight-semibold);
  color: var(--medical-blue);
}

.navbar-subtitle {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-left: var(--space-2);
  font-weight: var(--font-weight-medium);
}

.mobile-menu-toggle {
  display: none;
  background: none;
  border: none;
  font-size: var(--text-lg);
  color: var(--medical-blue);
  cursor: pointer;
  padding: var(--space-2);
  border-radius: var(--radius-md);
  width: 44px;
  height: 44px;
  flex-shrink: 0;
}

.mobile-menu-toggle:hover {
  background-color: var(--surface-alt);
}

.navbar-right {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

/* ============ 18. SEARCH ============ */
.search-container {
  position: relative;
  width: 280px;
}

.search-box {
  position: relative;
}

.search-input {
  width: 100%;
  padding: var(--space-3) var(--space-4) var(--space-3) var(--space-10);
  border: 1px solid var(--border);
  border-radius: var(--radius-md);
  font-size: var(--text-sm);
  font-family: var(--font-family);
  color: var(--text-primary);
  background-color: var(--surface);
  transition: all var(--transition-fast);
}

.search-input:focus {
  outline: none;
  border-color: var(--medical-blue);
  box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
}

.search-input::placeholder {
  color: var(--text-tertiary);
}

.search-icon {
  position: absolute;
  left: var(--space-4);
  top: 50%;
  transform: translateY(-50%);
  color: var(--medical-blue);
  font-size: var(--text-sm);
  pointer-events: none;
}

/* ============ 19. CONTENT AREA ============ */
.content-area {
  flex: 1;
  padding: var(--space-6);
  overflow-y: auto;
  background-color: var(--background);
}

/* ============ 20. DASHBOARD ENHANCEMENTS ============ */
.quick-actions-bar {
  display: flex;
  background-color: var(--surface);
  border-radius: var(--card-radius);
  padding: var(--space-6);
  margin-bottom: var(--space-6);
  border: 1px solid var(--border);
  gap: var(--space-4);
  flex-wrap: wrap;
  align-items: center;
}

.action-btn {
  padding: var(--space-3) var(--space-4);
  background-color: var(--surface-alt);
  border: none;
  border-radius: var(--radius-md);
  color: var(--medical-blue);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all var(--transition-fast);
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  white-space: nowrap;
}

.action-btn:hover {
  background-color: var(--medical-blue);
  color: var(--text-on-primary);
  transform: translateY(-1px);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-6);
  margin-bottom: var(--space-6);
}

.stat-card {
  background-color: var(--surface);
  border-radius: var(--card-radius);
  padding: var(--space-6);
  border: 1px solid var(--border);
  border-top: 4px solid var(--medical-blue);
}

.stat-header {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-4);
  padding-bottom: var(--space-3);
  border-bottom: 1px solid var(--border-light);
}

.stat-header i {
  font-size: var(--text-lg);
  color: var(--medical-blue);
}

.stat-header h3 {
  flex: 1;
  margin: 0;
  font-size: var(--text-base);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
}

.stat-main-value {
  font-size: var(--text-3xl);
  font-weight: var(--font-weight-bold);
  color: var(--medical-blue);
  margin-bottom: var(--space-4);
}

.stat-breakdown {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.breakdown-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-2) 0;
  border-bottom: 1px solid var(--border-light);
}

.breakdown-item:last-child {
  border-bottom: none;
}

.breakdown-item .label {
  color: var(--text-secondary);
  font-size: var(--text-sm);
}

.breakdown-item .value {
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  font-size: var(--text-sm);
}

/* ============ 21. LIVE STATS SIDEBAR ============ */
.live-stats-sidebar {
  position: fixed;
  right: 0;
  top: 72px;
  width: 320px;
  height: calc(100vh - 72px);
  background-color: var(--surface);
  border-left: 1px solid var(--border);
  box-shadow: -4px 0 20px rgba(0, 0, 0, 0.08);
  z-index: var(--z-sticky);
  overflow-y: auto;
  padding: var(--space-6);
  transform: translateX(100%);
  transition: transform var(--transition-normal) cubic-bezier(0.4, 0, 0.2, 1);
}

.live-stats-sidebar.open {
  transform: translateX(0);
}

.stats-toggle-btn {
  position: fixed;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  background: linear-gradient(135deg, var(--medical-blue) 0%, var(--medical-blue-dark) 100%);
  color: var(--text-on-primary);
  border: none;
  border-radius: var(--radius-md) 0 0 var(--radius-md);
  padding: var(--space-4) var(--space-2);
  cursor: pointer;
  z-index: calc(var(--z-sticky) + 1);
  box-shadow: -2px 0 8px rgba(0, 102, 204, 0.25);
  width: 40px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition-normal);
}

.stats-toggle-btn:hover {
  background: linear-gradient(135deg, var(--medical-blue-light) 0%, var(--medical-blue) 100%);
  width: 44px;
}

.live-stats-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-6);
  padding-bottom: var(--space-4);
  border-bottom: 2px solid var(--border-light);
}

.live-stats-title {
  font-size: var(--text-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.live-stats-title i {
  font-size: var(--text-lg);
  color: var(--medical-blue);
}

.live-stats-close {
  background-color: var(--surface-alt);
  border: none;
  color: var(--medical-blue);
  cursor: pointer;
  padding: var(--space-2);
  border-radius: var(--radius-md);
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.live-stats-close:hover {
  background-color: var(--medical-blue);
  color: var(--text-on-primary);
}

/* ============ 22. PROFILE SPECIFIC STYLES ============ */
.profile-header {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: var(--space-6);
  margin-bottom: var(--space-6);
  padding-bottom: var(--space-6);
  border-bottom: 2px solid var(--border-light);
  align-items: start;
}

.profile-avatar-large {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--medical-blue) 0%, var(--medical-teal) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-on-primary);
  font-weight: var(--font-weight-bold);
  font-size: var(--text-3xl);
  flex-shrink: 0;
  box-shadow: var(--shadow-lg);
}

.profile-basic-info {
  flex: 1;
  min-width: 0;
}

.profile-name {
  font-size: var(--text-2xl);
  font-weight: var(--font-weight-bold);
  color: var(--text-primary);
  margin-bottom: var(--space-1);
}

.profile-title {
  font-size: var(--text-base);
  color: var(--text-secondary);
  margin-bottom: var(--space-3);
  font-weight: var(--font-weight-medium);
}

.profile-meta-row {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  flex-wrap: wrap;
  margin-bottom: var(--space-3);
}

.profile-meta-item {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.profile-meta-item i {
  width: 16px;
  color: var(--medical-blue);
  flex-shrink: 0;
}

.profile-status-row {
  display: flex;
  gap: var(--space-3);
  align-items: center;
  flex-wrap: wrap;
}

.profile-department-badge {
  background-color: var(--surface-alt);
  color: var(--medical-blue);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-full);
  font-size: var(--text-sm);
  font-weight: var(--font-weight-medium);
  border: 1px solid var(--border);
}

/* ============ 23. RESPONSIVE DESIGN ============ */

/* Mobile (up to 480px) */
@media (max-width: 480px) {
  :root {
    --space-6: 16px;
    --space-8: 24px;
  }
  
  .login-card {
    padding: var(--space-6);
  }
  
  .modal-container {
    max-width: 100%;
    max-height: 100vh;
    border-radius: 0;
    margin: 0;
  }
  
  .modal-overlay {
    padding: 0;
  }
  
  .top-navbar {
    padding: var(--space-3);
    min-height: 64px;
  }
  
  .navbar-title {
    font-size: var(--text-lg);
  }
  
  .content-area {
    padding: var(--space-4);
  }
  
  .profile-header {
    grid-template-columns: 1fr;
    text-align: center;
    gap: var(--space-4);
  }
  
  .profile-meta-row {
    justify-content: center;
  }
  
  .sidebar {
    transform: translateX(-100%);
  }
  
  .sidebar.mobile-open {
    transform: translateX(0);
  }
  
  .main-content {
    margin-left: 0 !important;
  }
  
  .mobile-menu-toggle {
    display: flex;
  }
  
  .stats-grid,
  .dynamic-status-grid,
  .assignments-grid {
    grid-template-columns: 1fr;
  }
}

/* Tablet (481px to 768px) */
@media (min-width: 481px) and (max-width: 768px) {
  .sidebar {
    transform: translateX(-100%);
  }
  
  .sidebar.mobile-open {
    transform: translateX(0);
  }
  
  .main-content {
    margin-left: 0 !important;
  }
  
  .mobile-menu-toggle {
    display: flex;
  }
  
  .search-container {
    width: 200px;
  }
  
  .live-stats-sidebar {
    width: 100%;
  }
  
  .modal-container {
    max-width: 95%;
    margin: var(--space-2);
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .dynamic-status-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Small Desktop (769px to 1024px) */
@media (min-width: 769px) and (max-width: 1024px) {
  .sidebar {
    width: 240px;
  }
  
  .main-content {
    margin-left: 240px;
  }
  
  .main-content-expanded {
    margin-left: 72px;
  }
  
  .search-container {
    width: 240px;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .dynamic-status-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Large Desktop (1025px to 1280px) */
@media (min-width: 1025px) and (max-width: 1280px) {
  .sidebar {
    width: 260px;
  }
  
  .main-content {
    margin-left: 260px;
  }
  
  .main-content-expanded {
    margin-left: 72px;
  }
}

/* Extra Large Desktop (1281px and up) */
@media (min-width: 1281px) {
  .container {
    max-width: var(--screen-2xl);
  }
}

/* Print Styles */
@media print {
  .sidebar,
  .top-navbar,
  .live-stats-sidebar,
  .stats-toggle-btn,
  .modal-overlay,
  .toast-container {
    display: none !important;
  }
  
  .main-content {
    margin-left: 0 !important;
  }
  
  body {
    background: white !important;
    color: black !important;
  }
  
  .card {
    border: 1px solid #ddd !important;
    box-shadow: none !important;
  }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* High Contrast Mode */
@media (prefers-contrast: high) {
  :root {
    --border: #000000;
    --border-light: #000000;
    --border-dark: #000000;
    --text-primary: #000000;
    --text-secondary: #000000;
    --medical-blue: #0000FF;
    --medical-crimson: #FF0000;
    --medical-emerald: #008000;
  }
  
  .btn,
  .form-control,
  .card,
  .modal-container {
    border: 2px solid var(--border);
  }
}

/* Dark Mode (Future Enhancement) */
@media (prefers-color-scheme: dark) {
  :root {
    --surface: #1E293B;
    --surface-alt: #0F172A;
    --surface-elevated: #334155;
    --background: #0F172A;
    --background-alt: #1E293B;
    
    --border: #334155;
    --border-light: #475569;
    --border-dark: #64748B;
    
    --text-primary: #F1F5F9;
    --text-secondary: #CBD5E1;
    --text-tertiary: #94A3B8;
    --text-disabled: #64748B;
    
    --medical-mint: #0F172A;
    --medical-ivory: #1E293B;
  }
  
  .login-container {
    background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
  }
  
  .sidebar {
    background: linear-gradient(180deg, #0F172A 0%, #1E293B 100%);
  }
}

/* ============ 24. CUSTOM SCROLLBARS ============ */
@media (min-width: 768px) {
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  ::-webkit-scrollbar-track {
    background: var(--surface-alt);
    border-radius: 4px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: var(--medical-blue);
    border-radius: 4px;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    background: var(--medical-blue-light);
  }
  
  /* Firefox */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--medical-blue) var(--surface-alt);
  }
}

/* ============ 25. UTILITY CLASSES FOR JS INTERACTIONS ============ */
.dragging {
  opacity: 0.5;
  cursor: grabbing !important;
}

.resizing {
  cursor: ew-resize;
}

.loading {
  position: relative;
  pointer-events: none;
  opacity: 0.7;
}

.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  border: 2px solid var(--medical-blue);
  border-right-color: transparent;
  border-radius: 50%;
  animation: loading-spin 0.75s linear infinite;
  margin-top: -10px;
  margin-left: -10px;
}

@keyframes loading-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ============ 26. MEDICAL VISUALIZATION COMPONENTS ============ */
.capacity-meter {
  display: flex;
  height: 8px;
  background-color: var(--surface-alt);
  border-radius: 4px;
  overflow: hidden;
  margin: var(--space-2) 0;
}

.capacity-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--medical-emerald) 0%, var(--medical-amber) 50%, var(--medical-crimson) 100%);
  transition: width var(--transition-normal);
}

.timeline-visual {
  display: flex;
  height: 40px;
  background-color: var(--surface-alt);
  border-radius: var(--radius-md);
  overflow: hidden;
  margin: var(--space-3) 0;
}

.timeline-slot {
  flex: 1;
  border-right: 1px solid var(--surface);
  position: relative;
}

.timeline-slot.active {
  background-color: var(--medical-blue);
}

.timeline-slot.current::after {
  content: '';
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 2px;
  height: 100%;
  background-color: var(--medical-crimson);
}

.heatmap-grid {
  display: grid;
  gap: 2px;
  margin: var(--space-3) 0;
}

.heatmap-cell {
  aspect-ratio: 1;
  border-radius: 2px;
  background-color: var(--surface-alt);
  transition: all var(--transition-fast);
}

.heatmap-cell.low { background-color: var(--medical-emerald); }
.heatmap-cell.medium { background-color: var(--medical-amber); }
.heatmap-cell.high { background-color: var(--medical-crimson); }
.heatmap-cell.active { transform: scale(1.1); }

/* ============ 27. ANIMATION KEYFRAMES ============ */
@keyframes slide-in-left {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slide-in-right {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

/* ============ 28. ACCESSIBILITY UTILITIES ============ */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.skip-to-content {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--medical-blue);
  color: white;
  padding: var(--space-3);
  text-decoration: none;
  z-index: var(--z-max);
}

.skip-to-content:focus {
  top: 0;
}

.focus-visible {
  outline: 2px solid var(--medical-blue);
  outline-offset: 2px;
}

/* ============ 29. MEDICAL ICON SET ============ */
.medical-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: var(--radius-md);
  background-color: var(--surface-alt);
  color: var(--medical-blue);
  flex-shrink: 0;
}

.medical-icon-lg {
  width: 32px;
  height: 32px;
  font-size: var(--text-lg);
}

.medical-icon-primary {
  background-color: var(--medical-blue);
  color: var(--text-on-primary);
}

.medical-icon-success {
  background-color: var(--medical-emerald);
  color: var(--text-on-primary);
}

.medical-icon-warning {
  background-color: var(--medical-amber);
  color: var(--text-primary);
}

.medical-icon-danger {
  background-color: var(--medical-crimson);
  color: var(--text-on-primary);
}

/* ============ 30. EMPTY STATES ============ */
.empty-state {
  text-align: center;
  padding: var(--space-12) var(--space-6);
  color: var(--text-secondary);
}

.empty-state-icon {
  font-size: var(--text-4xl);
  color: var(--border);
  margin-bottom: var(--space-4);
  opacity: 0.5;
}

.empty-state-title {
  font-size: var(--text-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-2);
}

.empty-state-description {
  font-size: var(--text-base);
  color: var(--text-secondary);
  max-width: 400px;
  margin: 0 auto var(--space-6);
}

/* ============ 31. PROGRESS INDICATORS ============ */
.progress-bar {
  height: 8px;
  background-color: var(--surface-alt);
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--medical-blue) 0%, var(--medical-teal) 100%);
  border-radius: 4px;
  transition: width var(--transition-normal);
}

.progress-fill.success {
  background: linear-gradient(90deg, var(--medical-emerald) 0%, #00CC88 100%);
}

.progress-fill.warning {
  background: linear-gradient(90deg, var(--medical-amber) 0%, #FFCC00 100%);
}

.progress-fill.danger {
  background: linear-gradient(90deg, var(--medical-crimson) 0%, #FF6666 100%);
}

/* ============ 32. FINAL TOUCHES ============ */
*:focus {
  outline: 2px solid var(--medical-blue);
  outline-offset: 2px;
}

*:focus:not(:focus-visible) {
  outline: none;
}

*:focus-visible {
  outline: 2px solid var(--medical-blue);
  outline-offset: 2px;
}

.selection\:bg-medical-blue *::selection {
  background-color: var(--medical-blue);
  color: var(--text-on-primary);
}

.hover\:lift:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.transition-all {
  transition: all var(--transition-normal);
}

.transition-transform {
  transition: transform var(--transition-normal);
}

.transition-opacity {
  transition: opacity var(--transition-normal);
}

.transition-colors {
  transition: background-color var(--transition-normal), 
              border-color var(--transition-normal), 
              color var(--transition-normal);
}

.duration-150 { transition-duration: 150ms; }
.duration-250 { transition-duration: 250ms; }
.duration-350 { transition-duration: 350ms; }

.ease-in-out { transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); }
.ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1); }
.ease-in { transition-timing-function: cubic-bezier(0.4, 0, 1, 1); }

.rounded-t-lg { border-top-left-radius: var(--radius-lg); border-top-right-radius: var(--radius-lg); }
.rounded-b-lg { border-bottom-left-radius: var(--radius-lg); border-bottom-right-radius: var(--radius-lg); }

.border-t { border-top: 1px solid var(--border); }
.border-r { border-right: 1px solid var(--border); }
.border-b { border-bottom: 1px solid var(--border); }
.border-l { border-left: 1px solid var(--border); }

.shadow-inner { box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06); }

.rotate-90 { transform: rotate(90deg); }
.rotate-180 { transform: rotate(180deg); }
.-rotate-90 { transform: rotate(-90deg); }

.scale-90 { transform: scale(0.9); }
.scale-110 { transform: scale(1.1); }

.opacity-0 { opacity: 0; }
.opacity-25 { opacity: 0.25; }
.opacity-50 { opacity: 0.5; }
.opacity-75 { opacity: 0.75; }
.opacity-100 { opacity: 1; }

.pointer-events-none { pointer-events: none; }
.pointer-events-auto { pointer-events: auto; }

.select-none { user-select: none; }
.select-text { user-select: text; }

.cursor-pointer { cursor: pointer; }
.cursor-default { cursor: default; }
.cursor-not-allowed { cursor: not-allowed; }
.cursor-move { cursor: move; }

.whitespace-nowrap { white-space: nowrap; }
.whitespace-pre-wrap { white-space: pre-wrap; }

.break-words { overflow-wrap: break-word; }

.overflow-hidden { overflow: hidden; }
.overflow-visible { overflow: visible; }
.overflow-scroll { overflow: scroll; }

.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ============ NEUMOCARE v9.0 COMPLETE ============ */
    </style>
</head>
<body>
    <div id="app" v-cloak>

        <!-- ============ TOAST CONTAINER ============ -->
        <div class="toast-container">
            <div v-for="toast in toasts" :key="toast.id" 
                 :class="['toast', `toast-${toast.type}`]" 
                 role="alert" aria-live="polite" aria-atomic="true">
                <div class="toast-icon">
                    <i :class="toast.icon"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-title">{{ toast.title }}</div>
                    <div class="toast-message">{{ toast.message }}</div>
                </div>
                <button class="toast-close" @click="removeToast(toast.id)" aria-label="Close notification">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- ============ LOGIN SCREEN ============ -->
        <div v-if="!currentUser" class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="login-logo">
                        <i class="fas fa-lungs"></i>
                        <span class="login-title">NeumoCare</span>
                    </div>
                    <p class="login-subtitle">Pulmonology Management System</p>
                </div>
                
                <div class="form-group">
                    <label for="login-email" class="form-label">Email Address</label>
                    <input type="email" id="login-email" class="form-control" 
                           v-model="loginForm.email" placeholder="admin@neumocare.org" 
                           required aria-required="true" name="email" autocomplete="email">
                </div>

                <div class="form-group">
                    <label for="login-password" class="form-label">Password</label>
                    <input type="password" id="login-password" class="form-control" 
                           v-model="loginForm.password" placeholder="" 
                           required aria-required="true" name="password" autocomplete="current-password">
                </div>
                
                <button class="btn btn-primary btn-lg w-full" @click="handleLogin" 
                        :disabled="loginLoading" aria-label="Login to NeumoCare system">
                    <span v-if="loginLoading">
                        <i class="fas fa-spinner fa-spin"></i> Authenticating...
                    </span>
                    <span v-else>
                        <i class="fas fa-sign-in-alt"></i> Login
                    </span>
                </button>
            </div>
        </div>

        <!-- ============ MAIN APPLICATION ============ -->
        <div v-else class="app-layout">
            
            <!-- Medical Sidebar -->
            <aside class="sidebar" :class="{ 'sidebar-collapsed': sidebarCollapsed, 'mobile-open': mobileMenuOpen }" 
                   aria-label="Main navigation">
                <div class="sidebar-header">
                    <div class="sidebar-logo">
                        <i class="fas fa-lungs"></i>
                        <span v-if="!sidebarCollapsed">NeumoCare</span>
                    </div>
                    <button class="sidebar-toggle" @click="sidebarCollapsed = !sidebarCollapsed" 
                            :aria-label="sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'">
                        <i class="fas" :class="sidebarCollapsed ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
                        <span v-if="!sidebarCollapsed">{{ sidebarCollapsed ? 'Expand' : 'Collapse' }}</span>
                    </button>
                </div>
                
                <nav class="sidebar-nav" aria-label="Primary navigation">
                    <div class="sidebar-section">
                        <div class="sidebar-section-title" v-if="!sidebarCollapsed">Dashboard</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'dashboard' }" 
                                   @click.prevent="switchView('dashboard'); mobileMenuOpen = false"
                                   :aria-label="sidebarCollapsed ? 'Dashboard overview' : ''"
                                   :aria-current="currentView === 'dashboard' ? 'page' : null">
                                    <i class="fas fa-chart-line"></i>
                                    <span v-if="!sidebarCollapsed">Overview</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title" v-if="!sidebarCollapsed">Clinical Operations</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'medical_staff' }" 
                                   @click.prevent="switchView('medical_staff'); mobileMenuOpen = false" 
                                   v-if="hasPermission('medical_staff', 'read')"
                                   :aria-label="sidebarCollapsed ? 'Medical Staff' : ''"
                                   :aria-current="currentView === 'medical_staff' ? 'page' : null">
                                    <i class="fas fa-stethoscope"></i>
                                    <span v-if="!sidebarCollapsed">Medical Staff</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'oncall_schedule' }" 
                                   @click.prevent="switchView('oncall_schedule'); mobileMenuOpen = false" 
                                   v-if="hasPermission('oncall_schedule', 'read')"
                                   :aria-label="sidebarCollapsed ? 'On-call Schedule' : ''"
                                   :aria-current="currentView === 'oncall_schedule' ? 'page' : null">
                                    <i class="fas fa-phone-medical"></i>
                                    <span v-if="!sidebarCollapsed">On-call</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title" v-if="!sidebarCollapsed">Training & Education</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'resident_rotations' }" 
                                   @click.prevent="switchView('resident_rotations'); mobileMenuOpen = false" 
                                   v-if="hasPermission('resident_rotations', 'read')"
                                   :aria-label="sidebarCollapsed ? 'Resident Rotations' : ''"
                                   :aria-current="currentView === 'resident_rotations' ? 'page' : null">
                                    <i class="fas fa-calendar-check"></i>
                                    <span v-if="!sidebarCollapsed">Rotations</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'training_units' }" 
                                   @click.prevent="switchView('training_units'); mobileMenuOpen = false" 
                                   v-if="hasPermission('training_units', 'read')"
                                   :aria-label="sidebarCollapsed ? 'Training Units' : ''"
                                   :aria-current="currentView === 'training_units' ? 'page' : null">
                                    <i class="fas fa-hospital-user"></i>
                                    <span v-if="!sidebarCollapsed">Units</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <div class="sidebar-section-title" v-if="!sidebarCollapsed">Administration</div>
                        <ul class="sidebar-menu">
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'staff_absence' }" 
                                   @click.prevent="switchView('staff_absence'); mobileMenuOpen = false" 
                                   v-if="hasPermission('staff_absence', 'read')"
                                   :aria-label="sidebarCollapsed ? 'Staff Absence' : ''"
                                   :aria-current="currentView === 'staff_absence' ? 'page' : null">
                                    <i class="fas fa-user-clock"></i>
                                    <span v-if="!sidebarCollapsed">Absence</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'department_management' }" 
                                   @click.prevent="switchView('department_management'); mobileMenuOpen = false" 
                                   v-if="hasPermission('system', 'manage_departments')"
                                   :aria-label="sidebarCollapsed ? 'Department Management' : ''"
                                   :aria-current="currentView === 'department_management' ? 'page' : null">
                                    <i class="fas fa-sitemap"></i>
                                    <span v-if="!sidebarCollapsed">Departments</span>
                                </a>
                            </li>
                            <li class="sidebar-menu-item">
                                <a href="#" class="sidebar-menu-link" :class="{ active: currentView === 'communications' }" 
                                   @click.prevent="switchView('communications'); mobileMenuOpen = false" 
                                   v-if="hasPermission('communications', 'read')"
                                   :aria-label="sidebarCollapsed ? 'Communications' : ''"
                                   :aria-current="currentView === 'communications' ? 'page' : null">
                                    <i class="fas fa-bullhorn"></i>
                                    <span v-if="!sidebarCollapsed">Communications</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
                
                <div class="sidebar-footer">
                    <div class="sidebar-user">
                        <div class="user-avatar" aria-hidden="true">{{ getInitials(currentUser.full_name) }}</div>
                        <div class="user-info" v-if="!sidebarCollapsed">
                            <div class="user-name">{{ currentUser.full_name }}</div>
                            <div class="user-role">{{ getUserRoleDisplay(currentUser.user_role) }}</div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Live Stats Sidebar Toggle -->
            <button class="stats-toggle-btn" @click="toggleStatsSidebar" 
                    :aria-label="statsSidebarOpen ? 'Close live statistics sidebar' : 'Open live statistics sidebar'">
                <i class="fas" :class="statsSidebarOpen ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
            </button>
            
            <!-- Live Statistics Sidebar -->
            <div class="live-stats-sidebar" :class="{ open: statsSidebarOpen }" role="complementary" aria-label="Live department statistics">
                <div class="live-stats-header">
                    <div class="live-stats-title">
                        <i class="fas fa-chart-line"></i>
                        Live Department Updates
                        <span class="badge badge-primary ml-2" v-if="unreadLiveUpdates > 0">{{ unreadLiveUpdates }}</span>
                    </div>
                    <button class="live-stats-close" @click="statsSidebarOpen = false" aria-label="Close statistics sidebar">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <!-- EDIT MODE - Department Head Only -->
                <div v-if="hasPermission('system', 'manage_updates') && liveStatsEditMode" class="live-stats-edit-mode">
                    <div class="live-stats-edit-header">
                        <h4>Edit Live Updates</h4>
                        <button class="btn btn-sm btn-success" @click="saveLiveStatsUpdates">
                            <i class="fas fa-save"></i> Publish
                        </button>
                    </div>
                    
                    <!-- Daily Status Update -->
                    <div class="form-group">
                        <label class="form-label">Daily Status Update *</label>
                        <textarea class="form-control form-textarea" v-model="liveStatsData.dailyUpdate" 
                                  rows="3" placeholder="Enter today's department status (e.g., ER: 3 critical cases, ICU: 90% capacity, Ward A full...)"
                                  required></textarea>
                        <small class="text-muted">Visible to all staff in real-time</small>
                    </div>
                    
                    <!-- Key Metrics Input -->
                    <div class="form-group">
                        <label class="form-label">Key Metrics (Optional)</label>
                        <div class="live-metric-input">
                            <div class="metric-input-row">
                                <input type="text" class="form-control" v-model="liveStatsData.metric1.label" 
                                       placeholder="Metric name (e.g., ER Wait Time)">
                                <input type="text" class="form-control" v-model="liveStatsData.metric1.value" 
                                       placeholder="Value (e.g., 15 mins)">
                            </div>
                        </div>
                        <div class="live-metric-input">
                            <div class="metric-input-row">
                                <input type="text" class="form-control" v-model="liveStatsData.metric2.label" 
                                       placeholder="Metric name (e.g., ICU Bed Availability)">
                                <input type="text" class="form-control" v-model="liveStatsData.metric2.value" 
                                       placeholder="Value (e.g., 2 beds)">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status Flags -->
                    <div class="form-group">
                        <label class="form-label">Status Alerts</label>
                        <div class="status-flags-grid">
                            <label class="status-flag-item">
                                <input type="checkbox" v-model="liveStatsData.alerts.erBusy">
                                <span class="status-flag-label">ER Busy</span>
                            </label>
                            <label class="status-flag-item">
                                <input type="checkbox" v-model="liveStatsData.alerts.icuFull">
                                <span class="status-flag-label">ICU Full</span>
                            </label>
                            <label class="status-flag-item">
                                <input type="checkbox" v-model="liveStatsData.alerts.wardFull">
                                <span class="status-flag-label">Ward Full</span>
                            </label>
                            <label class="status-flag-item">
                                <input type="checkbox" v-model="liveStatsData.alerts.staffShortage">
                                <span class="status-flag-label">Staff Shortage</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="flex gap-2 mt-4">
                        <button class="btn btn-sm btn-outline flex-1" @click="liveStatsEditMode = false">
                            Cancel
                        </button>
                        <button class="btn btn-sm btn-primary flex-1" @click="saveLiveStatsUpdates">
                            <i class="fas fa-paper-plane"></i> Update All Staff
                        </button>
                    </div>
                </div>
                
                <!-- VIEW MODE - All Staff -->
                <div v-else>
                    <!-- Edit Toggle for Department Head -->
                    <div v-if="hasPermission('system', 'manage_updates')" class="mb-4">
                        <button class="btn btn-sm btn-outline w-full" @click="liveStatsEditMode = true">
                            <i class="fas fa-edit"></i> Update Live Stats
                        </button>
                    </div>
                    
                    <!-- Daily Update Display -->
                    <div class="live-update-display">
                        <div v-if="liveStatsData.dailyUpdate" class="live-update-card">
                            <div class="live-update-header">
                                <h4>Current Department Status</h4>
                                <span class="live-update-time">{{ formatRelativeTime(liveStatsData.lastUpdated) }}</span>
                            </div>
                            <div class="live-update-content">
                                {{ liveStatsData.dailyUpdate }}
                            </div>
                            <div class="live-update-author" v-if="liveStatsData.updatedBy">
                                <i class="fas fa-user-md text-xs"></i>
                                <small>Updated by: {{ liveStatsData.updatedBy }}</small>
                            </div>
                        </div>
                        <div v-else class="p-4 text-center text-gray-500 bg-gray-50 rounded-md">
                            <i class="fas fa-info-circle mb-2"></i>
                            <p class="text-sm">No status update available</p>
                        </div>
                    </div>
                    
                    <!-- Key Metrics Display -->
                    <div class="live-metrics-display" v-if="liveStatsData.metric1.label || liveStatsData.metric2.label">
                        <div class="live-metric-card" v-if="liveStatsData.metric1.label">
                            <div class="live-metric-label">{{ liveStatsData.metric1.label }}</div>
                            <div class="live-metric-value">{{ liveStatsData.metric1.value }}</div>
                        </div>
                        <div class="live-metric-card" v-if="liveStatsData.metric2.label">
                            <div class="live-metric-label">{{ liveStatsData.metric2.label }}</div>
                            <div class="live-metric-value">{{ liveStatsData.metric2.value }}</div>
                        </div>
                    </div>
                    
                    <!-- Active Clinicians Count -->
                    <div class="active-clinicians-card">
                        <h4 class="text-sm font-semibold text-gray-700 mb-3">Active Clinicians</h4>
                        <div class="clinician-count-grid">
                            <div class="clinician-count-item">
                                <div class="clinician-count-value">{{ systemStats.activeAttending || 0 }}</div>
                                <div class="clinician-count-label">Attending</div>
                            </div>
                            <div class="clinician-count-item">
                                <div class="clinician-count-value">{{ systemStats.activeResidents || 0 }}</div>
                                <div class="clinician-count-label">Residents</div>
                            </div>
                            <div class="clinician-count-item">
                                <div class="clinician-count-value">{{ systemStats.onCallNow || 0 }}</div>
                                <div class="clinician-count-label">On-call</div>
                            </div>
                            <div class="clinician-count-item">
                                <div class="clinician-count-value">{{ systemStats.inSurgery || 0 }}</div>
                                <div class="clinician-count-label">In Surgery</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- System Information -->
                    <div class="bg-gray-50 rounded-md p-4">
                        <h4 class="text-sm font-semibold text-gray-700 mb-3">System Information</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-gray-600">Next Shift Change:</span>
                                <span class="text-xs font-medium">{{ formatTime(systemStats.nextShiftChange) }}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-gray-600">Pending Approvals:</span>
                                <span class="text-xs font-medium">{{ systemStats.pendingApprovals || 0 }}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-gray-600">Unread Announcements:</span>
                                <span class="text-xs font-medium">{{ unreadAnnouncements || 0 }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Area -->
            <main class="main-content" :class="{ 'main-content-expanded': sidebarCollapsed }">
                
                <!-- Top Navigation Bar -->
                <header class="top-navbar">
                    <div class="navbar-left">
                        <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen" 
                                :aria-label="mobileMenuOpen ? 'Close mobile menu' : 'Open mobile menu'">
                            <i class="fas fa-bars"></i>
                        </button>
                        <div>
                            <span class="navbar-title">{{ getCurrentViewTitle() }}</span>
                            <span class="navbar-subtitle" v-if="getCurrentViewSubtitle()">{{ getCurrentViewSubtitle() }}</span>
                        </div>
                    </div>
                    
                    <div class="navbar-right">
                        <!-- Enhanced Search -->
                        <div class="search-container">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" :placeholder="getSearchPlaceholder()" 
                                       v-model="globalSearchQuery" @keyup.enter="handleGlobalSearch"
                                       aria-label="Search across system">
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-3">
                            <!-- Communications Button -->
                            <button class="btn btn-icon btn-secondary" @click="showCommunicationsModal" 
                                    v-if="hasPermission('communications', 'create')" 
                                    aria-label="Create communication or announcement">
                                <i class="fas fa-bullhorn"></i>
                            </button>
                            
                            <!-- User Menu -->
                            <div class="relative">
                                <button class="flex items-center gap-2 p-2 rounded-md hover:bg-gray-100 transition" 
                                        @click="userMenuOpen = !userMenuOpen" 
                                        :aria-label="`${currentUser.full_name} profile menu`"
                                        :aria-expanded="userMenuOpen">
                                    <div class="user-avatar">{{ getInitials(currentUser.full_name) }}</div>
                                    <i class="fas fa-chevron-down text-xs"></i>
                                </button>
                                
                                <div v-if="userMenuOpen" class="absolute right-0 top-full mt-1 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50">
                                    <div class="py-1">
                                        <button class="w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center gap-2" 
                                                @click="showUserProfileModal">
                                            <i class="fas fa-user text-gray-500"></i>
                                            <span>Profile Settings</span>
                                        </button>
                                        <button class="w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center gap-2" 
                                                @click="handleLogout">
                                            <i class="fas fa-sign-out-alt text-gray-500"></i>
                                            <span>Logout</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Content Area -->
                <div class="content-area">
                    
                    <!-- System Alert Banner -->
                    <div v-if="systemAlerts.length > 0" class="mb-6">
                        <div v-for="alert in systemAlerts.slice(0, 1)" :key="alert.id" 
                             class="p-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg flex items-center justify-between shadow-md">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span class="font-medium">
                                    {{ alert.message }}
                                    <span v-if="systemAlerts.length > 1" class="text-sm opacity-90">
                                        (and {{ systemAlerts.length - 1 }} more)
                                    </span>
                                </span>
                            </div>
                            <button class="p-1 hover:bg-white/10 rounded transition" 
                                    @click="dismissAlert(alert.id)" 
                                    aria-label="Dismiss alert">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Breadcrumb Navigation -->
                    <nav class="flex items-center gap-2 mb-6 pb-4 border-b border-gray-200" aria-label="Breadcrumb">
                        <button class="flex items-center gap-2 text-gray-600 hover:text-blue-600 text-sm transition" 
                                @click="switchView('dashboard')">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </button>
                        <span class="text-gray-400">/</span>
                        <span class="text-blue-600 font-medium text-sm">{{ getCurrentViewTitle() }}</span>
                    </nav>

                    <!-- ============ DASHBOARD VIEW ============ -->
                    <div v-if="currentView === 'dashboard'">
                        
                        <!-- Quick Actions Toolbar -->
                        <div class="quick-actions-bar">
                            <button class="action-btn" @click="showAddMedicalStaffModal" v-if="hasPermission('medical_staff', 'create')">
                                <i class="fas fa-user-plus"></i> Add Staff
                            </button>
                            <button class="action-btn" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                <i class="fas fa-phone-medical"></i> Schedule On-call
                            </button>
                            <button class="action-btn" @click="showAddAbsenceModal" v-if="hasPermission('staff_absence', 'create')">
                                <i class="fas fa-user-clock"></i> Record Absence
                            </button>
                            <button class="action-btn" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                <i class="fas fa-calendar-check"></i> Add Rotation
                            </button>
                            <div class="ml-auto">
                                <button class="btn btn-primary btn-sm" @click="showCommunicationsModal" v-if="hasPermission('communications', 'create')">
                                    <i class="fas fa-bullhorn"></i> New Announcement
                                </button>
                            </div>
                        </div>

                        <!-- Real-time Stats Grid -->
                        <div class="stats-grid">
                            
                            <!-- Medical Staff Stats -->
                            <div class="stat-card">
                                <div class="stat-header">
                                    <i class="fas fa-stethoscope"></i>
                                    <h3>Medical Staff</h3>
                                    <button class="btn btn-sm btn-outline" @click="switchView('medical_staff')">View All</button>
                                </div>
                                <div class="stat-main-value">{{ systemStats.totalStaff || 0 }}</div>
                                <div class="stat-breakdown">
                                    <div class="breakdown-item">
                                        <span class="label">Attending Physicians</span>
                                        <span class="value">{{ systemStats.activeAttending || 0 }}</span>
                                        <span class="status-indicator status-active">Active</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span class="label">Residents</span>
                                        <span class="value">{{ systemStats.activeResidents || 0 }}</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span class="label">On Leave</span>
                                        <span class="value">{{ systemStats.onLeaveStaff || 0 }}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Rotations Stats -->
                            <div class="stat-card">
                                <div class="stat-header">
                                    <i class="fas fa-calendar-check"></i>
                                    <h3>Active Rotations</h3>
                                    <button class="btn btn-sm btn-outline" @click="switchView('resident_rotations')">Manage</button>
                                </div>
                                <div class="stat-main-value">{{ systemStats.activeRotations || 0 }}</div>
                                <div class="stat-breakdown">
                                    <div class="breakdown-item">
                                        <span class="label">Currently Active</span>
                                        <span class="value">{{ systemStats.activeRotations || 0 }}</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span class="label">Ending This Week</span>
                                        <span class="value">{{ systemStats.endingThisWeek || 0 }}</span>
                                        <span class="status-indicator status-busy">Alert</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span class="label">Starting Next Week</span>
                                        <span class="value">{{ systemStats.startingNextWeek || 0 }}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Today's On-call -->
                            <div class="stat-card">
                                <div class="stat-header">
                                    <i class="fas fa-phone-medical"></i>
                                    <h3>Today's On-call</h3>
                                    <button class="btn btn-sm btn-outline" @click="switchView('oncall_schedule')">Schedule</button>
                                </div>
                                <div class="stat-main-value">{{ todaysOnCallCount || 0 }}</div>
                                <div class="stat-breakdown">
                                    <div v-for="shift in todaysOnCall.slice(0, 3)" :key="shift.id" class="breakdown-item">
                                        <span class="label">{{ shift.physicianName }}</span>
                                        <span class="value">{{ shift.startTime }}</span>
                                        <span class="status-indicator status-oncall">On-call</span>
                                    </div>
                                    <div v-if="todaysOnCall.length === 0" class="breakdown-item">
                                        <span class="label text-gray-500">No on-call scheduled today</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Department Status -->
                            <div class="stat-card">
                                <div class="stat-header">
                                    <i class="fas fa-hospital"></i>
                                    <h3>Department Status</h3>
                                </div>
                                <div class="stat-main-value" :class="{'text-green-600': systemStats.departmentStatus === 'normal', 'text-red-600': systemStats.departmentStatus === 'busy'}">
                                    {{ systemStats.departmentStatus === 'normal' ? 'Normal' : 'Busy' }}
                                </div>
                                <div class="stat-breakdown">
                                    <div class="breakdown-item">
                                        <span class="label">Active Patients</span>
                                        <span class="value">{{ systemStats.activePatients || 0 }}</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span class="label">ICU Occupancy</span>
                                        <span class="value">{{ systemStats.icuOccupancy || '0' }}%</span>
                                    </div>
                                    <div class="breakdown-item">
                                        <span class="label">Ward Occupancy</span>
                                        <span class="value">{{ systemStats.wardOccupancy || '0' }}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Today's Schedule -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-phone-medical"></i>
                                    Today's On-call Schedule
                                </div>
                                <button class="btn btn-sm btn-primary" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                    <i class="fas fa-plus"></i> Add Schedule
                                </button>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Time</th>
                                            <th>Physician</th>
                                            <th>Type</th>
                                            <th>Coverage Area</th>
                                            <th>Backup</th>
                                            <th>Contact</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="loadingSchedule">
                                            <td colspan="6" class="text-center py-8">
                                                <i class="fas fa-spinner fa-spin text-blue-600"></i>
                                                <span class="ml-2 text-gray-600">Loading schedule...</span>
                                            </td>
                                        </tr>
                                        <tr v-else-if="todaysOnCall.length === 0">
                                            <td colspan="6" class="text-center py-8 text-gray-500">
                                                <i class="fas fa-phone-slash text-2xl mb-2"></i>
                                                <p>No on-call scheduled today</p>
                                            </td>
                                        </tr>
                                      <tr v-else v-for="shift in todaysOnCall" :key="shift.id">
    <td>{{ shift.startTime }} - {{ shift.endTime }}</td>
    <td>
        <div class="flex items-center gap-3">
            <div class="user-avatar">{{ getInitials(shift.physicianName) }}</div>
            <div>
                <div class="font-medium">{{ shift.physicianName }}</div>
                <div class="text-xs text-gray-500">{{ shift.staffType }}</div>
            </div>
        </div>
    </td>
    <td>
        <span class="badge" :class="shift.shiftTypeClass">
            {{ shift.shiftType }}
        </span>
    </td>
    <td>{{ shift.coverageArea }}</td>
    <td>
        <span v-if="shift.backupPhysician">{{ shift.backupPhysician }}</span>
        <span v-else class="text-gray-500 text-xs">None</span>
    </td>
    <td>
        <button class="btn btn-sm btn-outline" 
                @click="contactPhysician(shift)"
                :disabled="!shift.contactInfo || shift.contactInfo === 'No contact info'"
                aria-label="Contact physician">
            <i class="fas" :class="shift.contactInfo && shift.contactInfo.includes('@') ? 'fa-envelope' : 'fa-phone'"></i> 
            {{ shift.contactInfo && shift.contactInfo.includes('@') ? 'Email' : 'Contact' }}
        </button>
    </td>
</tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ============ MEDICAL STAFF VIEW ============ -->
                    <div v-if="currentView === 'medical_staff'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-stethoscope"></i>
                                    Medical Staff Management
                                </div>
                                <button class="btn btn-primary" @click="showAddMedicalStaffModal" 
                                        v-if="hasPermission('medical_staff', 'create')">
                                    <i class="fas fa-plus"></i> Add Staff Member
                                </button>
                            </div>
                            
                            <!-- Filters -->
                            <div class="p-4 border-b border-gray-200 bg-gray-50">
                                <div class="grid grid-cols-4 gap-4">
                                    <div>
                                        <input type="text" class="form-control" v-model="staffFilters.search" 
                                               placeholder="Search name, ID, or email..." aria-label="Search staff">
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="staffFilters.staffType" aria-label="Filter by staff type">
                                            <option value="">All Types</option>
                                            <option value="attending_physician">Attending Physician</option>
                                            <option value="medical_resident">Medical Resident</option>
                                            <option value="fellow">Fellow</option>
                                            <option value="nurse_practitioner">Nurse Practitioner</option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="staffFilters.department" aria-label="Filter by department">
                                            <option value="">All Departments</option>
                                            <option v-for="dept in departments" :key="dept.id" :value="dept.id">
                                                {{ dept.name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="staffFilters.status" aria-label="Filter by status">
                                            <option value="">All Status</option>
                                            <option value="active">Active</option>
                                            <option value="on_leave">On Leave</option>
                                            <option value="inactive">Inactive</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Staff Table -->
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Staff Member</th>
                                            <th>Type</th>
                                            <th>Staff ID</th>
                                            <th>Department</th>
                                            <th>Current Rotation</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="staff in filteredMedicalStaff" :key="staff.id">
                                            <td>
                                                <div class="flex items-center gap-3">
                                                    <div class="user-avatar">{{ getInitials(staff.full_name) }}</div>
                                                    <div>
                                                        <div class="font-medium">{{ staff.full_name }}</div>
                                                        <div class="text-xs text-gray-500">{{ staff.professional_email }}</div>
                                                        <div v-if="staff.resident_year" class="text-xs text-blue-600">
                                                            {{ staff.resident_year }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="badge" :class="getStaffTypeClass(staff.staff_type)">
                                                    {{ formatStaffType(staff.staff_type) }}
                                                </span>
                                            </td>
                                            <td class="font-mono text-sm">{{ staff.staff_id }}</td>
                                            <td>
                                                <span v-if="getDepartmentName(staff.department_id)">
                                                    {{ getDepartmentName(staff.department_id) }}
                                                </span>
                                                <span v-else class="text-gray-500 text-xs">Not assigned</span>
                                            </td>
                                            <td>
    <span v-if="getCurrentRotationForStaff(staff.id)">
        {{ getTrainingUnitName(getCurrentRotationForStaff(staff.id).training_unit_id) }}
    </span>
    <span v-else class="text-gray-500 text-xs">Not assigned</span>
</td>
                                            
                                            <td>
                                                <span class="status-indicator" :class="'status-' + staff.employment_status">
                                                    {{ formatEmploymentStatus(staff.employment_status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="flex gap-2">
                                                    <button class="btn btn-sm btn-outline" @click="viewStaffDetails(staff)"
                                                            aria-label="View staff details">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline" @click="editMedicalStaff(staff)" 
                                                            v-if="hasPermission('medical_staff', 'update')"
                                                            aria-label="Edit staff">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="filteredMedicalStaff.length === 0">
                                            <td colspan="7" class="text-center py-8 text-gray-500">
                                                <i class="fas fa-user-md text-2xl mb-2"></i>
                                                <p>No medical staff found matching your criteria</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ============ ON-CALL SCHEDULE VIEW ============ -->
                    <div v-if="currentView === 'oncall_schedule'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-phone-medical"></i>
                                    On-call Schedule Management
                                </div>
                                <button class="btn btn-primary" @click="showAddOnCallModal" v-if="hasPermission('oncall_schedule', 'create')">
                                    <i class="fas fa-plus"></i> Add Schedule
                                </button>
                            </div>
                            
                            <!-- Filters -->
                            <div class="p-4 border-b border-gray-200 bg-gray-50">
                                <div class="grid grid-cols-4 gap-4">
                                    <div>
                                        <input type="date" class="form-control" v-model="onCallFilters.date" 
                                               aria-label="Filter by date">
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="onCallFilters.shiftType" aria-label="Filter by shift type">
                                            <option value="">All Shift Types</option>
                                            <option value="primary">Primary</option>
                                            <option value="backup">Backup</option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="onCallFilters.physician" aria-label="Filter by physician">
                                            <option value="">All Physicians</option>
                                            <option v-for="physician in availablePhysicians" :key="physician.id" :value="physician.id">
                                                {{ physician.full_name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="onCallFilters.coverageArea" aria-label="Filter by coverage area">
                                            <option value="">All Areas</option>
                                            <option value="emergency">Emergency</option>
                                            <option value="icu">ICU</option>
                                            <option value="ward">Ward</option>
                                            <option value="consultation">Consultation</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Schedule Table -->
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Physician</th>
                                            <th>Shift Time</th>
                                            <th>Type</th>
                                            <th>Coverage Area</th>
                                            <th>Backup Physician</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="schedule in filteredOnCallSchedules" :key="schedule.id">
                                            <td>{{ formatDate(schedule.duty_date) }}</td>
                                            <td>{{ getPhysicianName(schedule.primary_physician_id) }}</td>
                                            <td>{{ schedule.start_time }} - {{ schedule.end_time }}</td>
                                            <td>
                                                <span class="badge" :class="schedule.shift_type === 'primary' ? 'badge-primary' : 'badge-secondary'">
                                                    {{ schedule.shift_type === 'primary' ? 'Primary' : 'Backup' }}
                                                </span>
                                            </td>
                                            <td>{{ schedule.coverage_area }}</td>
                                            <td>
                                                <span v-if="schedule.backup_physician_id">
                                                    {{ getPhysicianName(schedule.backup_physician_id) }}
                                                </span>
                                                <span v-else class="text-gray-500 text-xs">No backup</span>
                                            </td>
                                            <td>
                                                <div class="flex gap-2">
                                                    <button class="btn btn-sm btn-outline" @click="editOnCallSchedule(schedule)" 
                                                            v-if="hasPermission('oncall_schedule', 'update')"
                                                            aria-label="Edit schedule">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="filteredOnCallSchedules.length === 0">
                                            <td colspan="7" class="text-center py-8 text-gray-500">
                                                <i class="fas fa-phone-medical text-2xl mb-2"></i>
                                                <p>No on-call schedules found</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ============ RESIDENT ROTATIONS VIEW ============ -->
                    <div v-if="currentView === 'resident_rotations'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-calendar-check"></i>
                                    Resident Rotations Management
                                </div>
                                <button class="btn btn-primary" @click="showAddRotationModal" v-if="hasPermission('resident_rotations', 'create')">
                                    <i class="fas fa-plus"></i> Add Rotation
                                </button>
                            </div>
                            
                            <!-- Filters -->
                            <div class="p-4 border-b border-gray-200 bg-gray-50">
                                <div class="grid grid-cols-4 gap-4">
                                    <div>
                                        <select class="form-select" v-model="rotationFilters.resident" aria-label="Filter by resident">
                                            <option value="">All Residents</option>
                                            <option v-for="resident in availableResidents" :key="resident.id" :value="resident.id">
                                                {{ resident.full_name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="rotationFilters.status" aria-label="Filter by status">
                                            <option value="">All Status</option>
                                            <option value="active">Active</option>
                                            <option value="upcoming">Upcoming</option>
                                            <option value="completed">Completed</option>
                                            <option value="cancelled">Cancelled</option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="rotationFilters.trainingUnit" aria-label="Filter by training unit">
                                            <option value="">All Units</option>
                                            <option v-for="unit in trainingUnits" :key="unit.id" :value="unit.id">
                                                {{ unit.unit_name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="rotationFilters.supervisor" aria-label="Filter by supervisor">
                                            <option value="">All Supervisors</option>
                                            <option v-for="supervisor in availableAttendings" :key="supervisor.id" :value="supervisor.id">
                                                {{ supervisor.full_name }}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Rotations Table -->
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Rotation ID</th>
                                            <th>Resident</th>
                                            <th>Training Unit</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Supervisor</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="rotation in filteredRotations" :key="rotation.id">
                                            <td class="font-mono text-sm">{{ rotation.rotation_id }}</td>
                                            <td>{{ getResidentName(rotation.resident_id) }}</td>
                                            <td>{{ getTrainingUnitName(rotation.training_unit_id) }}</td>
                                            <td>{{ formatDate(rotation.start_date) }}</td>
                                            <td>{{ formatDate(rotation.end_date) }}</td>
                                           
                                            <td>
                                                <span class="status-indicator" :class="'status-' + rotation.rotation_status">
                                                    {{ formatRotationStatus(rotation.rotation_status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <span v-if="rotation.supervising_attending_id">
                                                    {{ getSupervisorName(rotation.supervising_attending_id) }}
                                                </span>
                                                <span v-else class="text-gray-500 text-xs">Not assigned</span>
                                            </td>
                                            <td>
                                                <div class="flex gap-2">
                                                    <button class="btn btn-sm btn-outline" @click="editRotation(rotation)" 
                                                            v-if="hasPermission('resident_rotations', 'update')"
                                                            aria-label="Edit rotation">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="filteredRotations.length === 0">
                                            <td colspan="8" class="text-center py-8 text-gray-500">
                                                <i class="fas fa-calendar-alt text-2xl mb-2"></i>
                                                <p>No rotations found</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ============ TRAINING UNITS VIEW ============ -->
                    <div v-if="currentView === 'training_units'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-hospital-user"></i>
                                    Training Units Management
                                </div>
                                <button class="btn btn-primary" @click="showAddTrainingUnitModal" v-if="hasPermission('training_units', 'create')">
                                    <i class="fas fa-plus"></i> Add Unit
                                </button>
                            </div>
                            
                            <!-- Training Units Grid -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6">
                                <div v-for="unit in trainingUnits" :key="unit.id" class="card hover:shadow-lg transition-shadow">
                                    <div class="card-header">
                                        <div class="card-title">
                                            <i class="fas fa-clinic-medical"></i>
                                            {{ unit.unit_name }}
                                        </div>
                                        <span class="status-indicator" :class="'status-' + unit.unit_status">
                                            {{ unit.unit_status }}
                                        </span>
                                    </div>
                                    
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Code:</span>
                                            <span class="font-mono text-sm">{{ unit.unit_code }}</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Department:</span>
                                            <span class="text-sm">{{ getDepartmentName(unit.department_id) }}</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Current Capacity:</span>
                                            <span class="text-sm">{{ unit.current_residents || 0 }}/{{ unit.maximum_residents }}</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Supervisor:</span>
                                            <span class="text-sm">{{ getSupervisorName(unit.supervising_attending_id) || 'Not assigned' }}</span>
                                        </div>
                                        <div v-if="unit.specialty" class="mt-2">
                                            <span class="badge badge-info">{{ unit.specialty }}</span>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-4 flex gap-2">
                                        <button class="btn btn-sm btn-outline flex-1" @click="editTrainingUnit(unit)" 
                                                v-if="hasPermission('training_units', 'update')"
                                                aria-label="Edit training unit">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="btn btn-sm btn-primary flex-1" @click="viewUnitResidents(unit)"
                                                aria-label="View unit residents">
                                            <i class="fas fa-users"></i> Residents
                                        </button>
                                    </div>
                                </div>
                                
                                <div v-if="trainingUnits.length === 0" class="col-span-full text-center py-12 text-gray-500">
                                    <i class="fas fa-hospital-user text-3xl mb-3"></i>
                                    <p class="text-lg">No training units found</p>
                                    <p class="text-sm mt-1">Add a training unit to get started</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ============ STAFF ABSENCE VIEW ============ -->
                    <div v-if="currentView === 'staff_absence'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-user-clock"></i>
                                    Staff Absence Management
                                </div>
                                <button class="btn btn-primary" @click="showAddAbsenceModal" v-if="hasPermission('staff_absence', 'create')">
                                    <i class="fas fa-plus"></i> Record Absence
                                </button>
                            </div>
                            
                            <!-- Filters -->
                            <div class="p-4 border-b border-gray-200 bg-gray-50">
                                <div class="grid grid-cols-4 gap-4">
                                    <div>
                                        <select class="form-select" v-model="absenceFilters.staff" aria-label="Filter by staff">
                                            <option value="">All Staff</option>
                                            <option v-for="staff in medicalStaff" :key="staff.id" :value="staff.id">
                                                {{ staff.full_name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="absenceFilters.status" aria-label="Filter by status">
                                            <option value="">All Status</option>
                                            <option value="active">Active</option>
                                            <option value="upcoming">Upcoming</option>
                                            <option value="completed">Completed</option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select" v-model="absenceFilters.reason" aria-label="Filter by reason">
                                            <option value="">All Reasons</option>
                                            <option value="vacation">Vacation</option>
                                            <option value="sick_leave">Sick Leave</option>
                                            <option value="conference">Conference</option>
                                            <option value="training">Training</option>
                                            <option value="personal">Personal</option>
                                        </select>
                                    </div>
                                    <div>
                                        <input type="date" class="form-control" v-model="absenceFilters.startDate" 
                                               aria-label="Filter by start date">
                                    </div>
                                </div>
                            </div>

                            <!-- Absences Table -->
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Staff Member</th>
                                            <th>Reason</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Duration</th>
                                            <th>Replacement</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="absence in filteredAbsences" :key="absence.id">
                                            <td>{{ getStaffName(absence.staff_member_id) }}</td>
                                            <td>{{ formatAbsenceReason(absence.absence_reason) }}</td>
                                            <td>{{ formatDate(absence.start_date) }}</td>
                                            <td>{{ formatDate(absence.end_date) }}</td>
                                            <td>{{ calculateAbsenceDuration(absence.start_date, absence.end_date) }} days</td>
                                            <td>
                                                <span v-if="absence.replacement_staff_id">
                                                    {{ getStaffName(absence.replacement_staff_id) }}
                                                </span>
                                                <span v-else class="text-gray-500 text-xs">No coverage</span>
                                            </td>
                                            <td>
                                                <span class="status-indicator" :class="'status-' + absence.status">
                                                    {{ formatAbsenceStatus(absence.status) }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="flex gap-2">
                                                    <button class="btn btn-sm btn-outline" @click="editAbsence(absence)" 
                                                            v-if="hasPermission('staff_absence', 'update')"
                                                            aria-label="Edit absence">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="filteredAbsences.length === 0">
                                            <td colspan="8" class="text-center py-8 text-gray-500">
                                                <i class="fas fa-user-clock text-2xl mb-2"></i>
                                                <p>No absences found</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ============ DEPARTMENT MANAGEMENT VIEW ============ -->
                    <div v-if="currentView === 'department_management'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-sitemap"></i>
                                    Department Management
                                </div>
                                <button class="btn btn-primary" @click="showAddDepartmentModal" 
                                        v-if="hasPermission('system', 'manage_departments')">
                                    <i class="fas fa-plus"></i> Add Department
                                </button>
                            </div>
                            
                            <!-- Departments Grid -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-6">
                                <div v-for="department in departments" :key="department.id" class="card hover:shadow-lg transition-shadow">
                                    <div class="card-header">
                                        <div class="card-title">
                                            <i class="fas fa-hospital"></i>
                                            {{ department.name }}
                                        </div>
                                        <span class="status-indicator" :class="'status-' + department.status">
                                            {{ department.status }}
                                        </span>
                                    </div>
                                    
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Code:</span>
                                            <span class="font-mono text-sm">{{ department.code }}</span>
                                        </div>
                                        <div v-if="department.head_of_department_id" class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Head of Department:</span>
                                            <span class="text-sm">{{ getStaffName(department.head_of_department_id) }}</span>
                                        </div>
                                        <div class="mt-2">
                                            <div class="text-xs text-gray-600 mb-1">Clinical Units:</div>
                                            <div class="flex flex-wrap gap-1">
                                                <span v-for="unit in getDepartmentUnits(department.id)" :key="unit.id" 
                                                      class="px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded">
                                                    {{ unit.name }}
                                                </span>
                                                <span v-if="getDepartmentUnits(department.id).length === 0" 
                                                      class="text-gray-500 text-xs">No units</span>
                                            </div>
                                        </div>
                                        <div class="mt-2">
                                            <div class="text-xs text-gray-600 mb-1">Staff Count:</div>
                                            <div class="text-sm">{{ getDepartmentStaffCount(department.id) }} staff members</div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-4 flex gap-2">
                                        <button class="btn btn-sm btn-outline flex-1" @click="editDepartment(department)" 
                                                v-if="hasPermission('system', 'manage_departments')"
                                                aria-label="Edit department">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="btn btn-sm btn-primary flex-1" @click="viewDepartmentStaff(department)"
                                                aria-label="View department staff">
                                            <i class="fas fa-users"></i> Staff
                                        </button>
                                    </div>
                                </div>
                                
                                <div v-if="departments.length === 0" class="col-span-full text-center py-12 text-gray-500">
                                    <i class="fas fa-sitemap text-3xl mb-3"></i>
                                    <p class="text-lg">No departments found</p>
                                    <p class="text-sm mt-1">Add a department to get started</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ============ COMMUNICATIONS VIEW ============ -->
                    <div v-if="currentView === 'communications'">
                        <div class="card mb-6">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-bullhorn"></i>
                                    Communications Center
                                </div>
                                <button class="btn btn-primary" @click="showCommunicationsModal" 
                                        v-if="hasPermission('communications', 'create')">
                                    <i class="fas fa-plus"></i> New Communication
                                </button>
                            </div>
                            
                            <!-- Communications List -->
                            <div class="space-y-4">
                                <div v-for="announcement in recentAnnouncements" :key="announcement.id" 
                                     class="card hover:shadow-md transition-shadow">
                                    <div class="flex justify-between items-start mb-3">
                                        <div>
                                            <h4 class="font-semibold text-gray-900">{{ announcement.title }}</h4>
                                            <div class="flex items-center gap-2 mt-1">
                                                <span class="text-xs text-gray-600">{{ announcement.author }}</span>
                                                <span class="text-xs text-gray-500"></span>
                                                <span class="text-xs text-gray-600">{{ formatTimeAgo(announcement.created_at) }}</span>
                                            </div>
                                        </div>
                                        <span class="badge" :class="'badge-' + announcement.priority_level">
                                            {{ announcement.priority_level }}
                                        </span>
                                    </div>
                                    
                                    <p class="text-sm text-gray-700 mb-3">{{ announcement.content }}</p>
                                    
                                    <div class="flex items-center justify-between text-xs text-gray-500">
                                        <div class="flex items-center gap-4">
                                            <span>{{ announcement.target_audience }}</span>
                                            <span v-if="announcement.type === 'stats_update'">
                                                <i class="fas fa-chart-line"></i> Live Stats Update
                                            </span>
                                        </div>
                                        <button class="btn btn-sm btn-outline" @click="viewAnnouncement(announcement)"
                                                aria-label="View announcement">
                                            <i class="fas fa-eye"></i> View Details
                                        </button>
                                    </div>
                                </div>
                                
                                <div v-if="recentAnnouncements.length === 0" class="text-center py-12 text-gray-500">
                                    <i class="fas fa-bullhorn text-3xl mb-3"></i>
                                    <p class="text-lg">No communications found</p>
                                    <p class="text-sm mt-1">Post an announcement to get started</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </main>

            <!-- ============ MODALS ============ -->
            
            <!-- MODAL 1: Dynamic Staff Profile (NO PHONE NUMBERS) -->
            <div v-if="staffProfileModal.show" class="modal-overlay">
                <div class="modal-container modal-wide">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-user-md"></i>
                            Staff Profile: {{ staffProfileModal.staff.full_name }}
                        </div>
                        <button class="modal-close" @click="staffProfileModal.show = false" aria-label="Close profile">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <!-- Profile Header -->
                        <div class="profile-header">
                            <div class="profile-avatar-large">{{ getInitials(staffProfileModal.staff.full_name) }}</div>
                            <div class="profile-basic-info">
                                <div class="profile-name">{{ staffProfileModal.staff.full_name }}</div>
                                <div class="profile-title">{{ formatStaffType(staffProfileModal.staff.staff_type) }}</div>
                                <div class="profile-meta-row">
                                    <div class="profile-meta-item">
                                        <i class="fas fa-id-badge"></i>
                                        <span>{{ staffProfileModal.staff.staff_id }}</span>
                                    </div>
                                    <div class="profile-meta-item">
                                        <i class="fas fa-envelope"></i>
                                        <span>{{ staffProfileModal.staff.professional_email }}</span>
                                    </div>
                                    <span class="status-indicator" :class="'status-' + staffProfileModal.staff.employment_status">
                                        {{ formatEmploymentStatus(staffProfileModal.staff.employment_status) }}
                                    </span>
                                </div>
                                <div class="profile-status-row">
                                    <span class="profile-department-badge" v-if="getDepartmentName(staffProfileModal.staff.department_id)">
                                        {{ getDepartmentName(staffProfileModal.staff.department_id) }}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Academic Information -->
                        <div class="education-section">
                            <div class="education-grid">
                                <div class="education-item">
                                    <span class="education-label">Academic Degree</span>
                                    <span class="education-value">{{ staffProfileModal.staff.academic_degree || 'MD' }}</span>
                                </div>
                                <div class="education-item" v-if="staffProfileModal.staff.specialization">
                                    <span class="education-label">Specialization</span>
                                    <span class="education-value">{{ staffProfileModal.staff.specialization }}</span>
                                </div>
                                <div class="education-item" v-if="staffProfileModal.staff.resident_year">
                                    <span class="education-label">Resident Year</span>
                                    <span class="education-value">{{ staffProfileModal.staff.resident_year }}</span>
                                </div>
                                <div class="education-item" v-if="staffProfileModal.staff.clinical_certificate">
                                    <span class="education-label">Clinical Certificate</span>
                                    <span class="education-value">{{ staffProfileModal.staff.clinical_certificate }}</span>
                                    <span class="text-xs" :class="staffProfileModal.staff.certificate_status === 'expired' ? 'text-red-600' : 'text-green-600'">
                                        {{ staffProfileModal.staff.certificate_status === 'expired' ? 'Expired' : 'Current' }}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Dynamic Tabs -->
                        <div class="modal-tabs">
                            <button class="modal-tab" :class="{ active: staffProfileModal.activeTab === 'clinical' }" 
                                    @click="staffProfileModal.activeTab = 'clinical'">
                                <i class="fas fa-stethoscope"></i> Clinical Status
                            </button>
                            <button class="modal-tab" :class="{ active: staffProfileModal.activeTab === 'assignments' }" 
                                    @click="staffProfileModal.activeTab = 'assignments'">
                                <i class="fas fa-tasks"></i> Current Assignments
                            </button>
                            <button class="modal-tab" :class="{ active: staffProfileModal.activeTab === 'activity' }" 
                                    @click="staffProfileModal.activeTab = 'activity'">
                                <i class="fas fa-history"></i> Recent Activity
                            </button>
                        </div>

                        <!-- Clinical Status Tab -->
                        <div v-if="staffProfileModal.activeTab === 'clinical'" class="mt-6">
                            <div class="dynamic-status-grid">
                                <!-- Current Location -->
                                <div class="dynamic-status-card">
                                    <div class="dynamic-status-header">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <h4>Current Location</h4>
                                    </div>
                                    <div class="dynamic-status-content">
                                        <div class="status-data-row">
                                            <span class="status-data-label">Clinical Unit</span>
                                            <span class="status-data-value">{{ getCurrentUnit(staffProfileModal.staff.id) || 'Not assigned' }}</span>
                                        </div>
                                        <div class="status-data-row">
                                            <span class="status-data-label">Ward/Floor</span>
                                            <span class="status-data-value">{{ getCurrentWard(staffProfileModal.staff.id) || 'General' }}</span>
                                        </div>
                                        <div class="status-data-row">
                                            <span class="status-data-label">Current Activity</span>
                                            <span class="status-data-value">
                                                <span class="status-indicator" :class="'status-' + getCurrentActivityStatus(staffProfileModal.staff.id)">
                                                    {{ getCurrentActivityStatus(staffProfileModal.staff.id) || 'Available' }}
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Patient Load -->
                                <div class="dynamic-status-card">
                                    <div class="dynamic-status-header">
                                        <i class="fas fa-procedures"></i>
                                        <h4>Patient Load</h4>
                                    </div>
                                    <div class="dynamic-status-content">
                                        <div class="status-data-row">
                                            <span class="status-data-label">Total Active</span>
                                            <span class="status-data-value status-data-value-large">
                                                {{ getCurrentPatientCount(staffProfileModal.staff.id) || 0 }}
                                            </span>
                                        </div>
                                        <div class="status-data-row">
                                            <span class="status-data-label">ICU Patients</span>
                                            <span class="status-data-value">{{ getICUPatientCount(staffProfileModal.staff.id) || 0 }}</span>
                                        </div>
                                        <div class="status-data-row">
                                            <span class="status-data-label">Ward Patients</span>
                                            <span class="status-data-value">{{ getWardPatientCount(staffProfileModal.staff.id) || 0 }}</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- On-call Status -->
                                <div class="dynamic-status-card">
                                    <div class="dynamic-status-header">
                                        <i class="fas fa-phone-medical"></i>
                                        <h4>On-call Status</h4>
                                    </div>
                                    <div class="dynamic-status-content">
                                        <div class="status-data-row">
                                            <span class="status-data-label">Today's On-call</span>
                                            <span class="status-data-value">
                                                <span v-if="isOnCallToday(staffProfileModal.staff.id)" class="status-indicator status-oncall">
                                                    On-call
                                                </span>
                                                <span v-else class="text-gray-500">Not scheduled</span>
                                            </span>
                                        </div>
                                        <div class="status-data-row" v-if="isOnCallToday(staffProfileModal.staff.id)">
                                            <span class="status-data-label">Shift Time</span>
                                            <span class="status-data-value">{{ getOnCallShiftTime(staffProfileModal.staff.id) }}</span>
                                        </div>
                                        <div class="status-data-row" v-if="isOnCallToday(staffProfileModal.staff.id)">
                                            <span class="status-data-label">Coverage Area</span>
                                            <span class="status-data-value">{{ getOnCallCoverage(staffProfileModal.staff.id) }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Current Assignments Tab -->
                        <div v-if="staffProfileModal.activeTab === 'assignments'" class="mt-6">
                            <div class="assignments-section">
                                <div class="assignments-grid">
                                    <!-- Current Rotation -->
                                    <div class="assignment-card" v-if="getCurrentRotationForStaff(staffProfileModal.staff.id)">
                                        <div class="assignment-header">
                                            <i class="fas fa-calendar-check"></i>
                                            <h4>Current Rotation</h4>
                                        </div>
                                        <div class="assignment-list">
                                            <div class="assignment-item">
                                                <span class="assignment-details">
                                                    {{ getCurrentRotationForStaff(staffProfileModal.staff.id).unitName }}
                                                </span>
                                                <span class="assignment-time">
                                                    {{ getRotationDaysLeft(staffProfileModal.staff.id) }} days left
                                                </span>
                                            </div>
                                            <div class="assignment-item" v-if="getCurrentRotationForStaff(staffProfileModal.staff.id).supervisor">
                                                <span class="assignment-details">
                                                    Supervisor: {{ getCurrentRotationForStaff(staffProfileModal.staff.id).supervisor }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Today's Schedule -->
                                    <div class="assignment-card">
                                        <div class="assignment-header">
                                            <i class="fas fa-clock"></i>
                                            <h4>Today's Schedule</h4>
                                        </div>
                                        <div class="assignment-list">
                                            <div v-for="item in getTodaysSchedule(staffProfileModal.staff.id)" :key="item.id" 
                                                 class="assignment-item">
                                                <span class="assignment-details">{{ item.activity }}</span>
                                                <span class="assignment-time">{{ item.time }}</span>
                                            </div>
                                            <div v-if="getTodaysSchedule(staffProfileModal.staff.id).length === 0" 
                                                 class="text-center py-4 text-gray-500 text-sm">
                                                No scheduled activities today
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity Tab -->
                        <div v-if="staffProfileModal.activeTab === 'activity'" class="mt-6">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-history"></i>
                                        Recent Clinical Activity
                                    </div>
                                </div>
                                <div class="space-y-2">
                                    <div v-for="activity in getRecentActivities(staffProfileModal.staff.id)" :key="activity.id" 
                                         class="flex items-center justify-between p-3 border-b border-gray-100 hover:bg-gray-50">
                                        <div>
                                            <div class="font-medium text-sm">{{ activity.description }}</div>
                                            <div class="text-xs text-gray-600">{{ activity.location }}</div>
                                        </div>
                                        <div class="text-xs text-gray-500">{{ formatTime(activity.timestamp) }}</div>
                                    </div>
                                    <div v-if="getRecentActivities(staffProfileModal.staff.id).length === 0" 
                                         class="text-center py-4 text-gray-500 text-sm">
                                        No recent activities recorded
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="staffProfileModal.show = false">Close</button>
                        <button class="btn btn-primary" @click="editMedicalStaff(staffProfileModal.staff)"
                                v-if="hasPermission('medical_staff', 'update')">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 2: Add/Edit Medical Staff (NO PHONE FIELD) -->
            <div v-if="medicalStaffModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-user-md"></i>
                            {{ medicalStaffModal.mode === 'add' ? 'Add Medical Staff' : 'Edit Medical Staff' }}
                        </div>
                        <button class="modal-close" @click="medicalStaffModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-tabs">
                            <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'basic' }" 
                                    @click="medicalStaffModal.activeTab = 'basic'">
                                <i class="fas fa-user"></i> Basic Information
                            </button>
                            <button class="modal-tab" :class="{ active: medicalStaffModal.activeTab === 'professional' }" 
                                    @click="medicalStaffModal.activeTab = 'professional'">
                                <i class="fas fa-graduation-cap"></i> Professional Details
                            </button>
                        </div>

                        <!-- Basic Info Tab -->
                        <div v-if="medicalStaffModal.activeTab === 'basic'" class="mt-6">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Full Name *</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.full_name" 
                                           required aria-required="true">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Staff Type *</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.staff_type" 
                                            required aria-required="true" aria-label="Staff type">
                                        <option value="medical_resident">Medical Resident</option>
                                        <option value="attending_physician">Attending Physician</option>
                                        <option value="fellow">Fellow</option>
                                        <option value="nurse_practitioner">Nurse Practitioner</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Staff ID</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.staff_id" 
                                           aria-label="Staff ID">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Employment Status</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.employment_status" 
                                            aria-label="Employment status">
                                        <option value="active">Active</option>
                                        <option value="on_leave">On Leave</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Professional Email *</label>
                                    <input type="email" class="form-control" v-model="medicalStaffModal.form.professional_email" 
                                           required aria-required="true" aria-label="Professional email">
                                </div>
                            </div>
                        </div>

                        <!-- Professional Details Tab -->
                        <div v-if="medicalStaffModal.activeTab === 'professional'" class="mt-6">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Academic Degree</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.academic_degree" 
                                            aria-label="Academic degree">
                                        <option value="">Select Degree</option>
                                        <option value="MD">MD</option>
                                        <option value="MD-PhD">MD-PhD</option>
                                        <option value="MD-MSc">MD-MSc</option>
                                        <option value="DO">DO</option>
                                        <option value="MBBS">MBBS</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Specialization</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.specialization" 
                                           placeholder="e.g., Pulmonology, Critical Care" aria-label="Specialization">
                                </div>
                                <div v-if="medicalStaffModal.form.staff_type === 'medical_resident'" class="form-group">
                                    <label class="form-label">Resident Year</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.resident_year" 
                                            aria-label="Resident year">
                                        <option value="">Select Year</option>
                                        <option value="PGY-1">PGY-1</option>
                                        <option value="PGY-2">PGY-2</option>
                                        <option value="PGY-3">PGY-3</option>
                                        <option value="PGY-4">PGY-4</option>
                                        <option value="PGY-5">PGY-5</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Clinical Certificate</label>
                                    <input type="text" class="form-control" v-model="medicalStaffModal.form.clinical_certificate" 
                                           placeholder="e.g., Board Certified" aria-label="Clinical certificate">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Certificate Status</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.certificate_status" 
                                            aria-label="Certificate status">
                                        <option value="current">Current</option>
                                        <option value="expired">Expired</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Department</label>
                                    <select class="form-select" v-model="medicalStaffModal.form.department_id" 
                                            aria-label="Department">
                                        <option value="">Select Department</option>
                                        <option v-for="department in departments" :key="department.id" :value="department.id">
                                            {{ department.name }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="medicalStaffModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveMedicalStaff">
                            <i class="fas fa-save"></i> {{ medicalStaffModal.mode === 'add' ? 'Add Staff' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 3: Communications with Stats Update Tab -->
            <div v-if="communicationsModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-bullhorn"></i>
                            Department Communications
                        </div>
                        <button class="modal-close" @click="communicationsModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="modal-tabs">
                            <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'announcement' }" 
                                    @click="communicationsModal.activeTab = 'announcement'">
                                <i class="fas fa-bullhorn"></i> Announcement
                            </button>
                            <button class="modal-tab" :class="{ active: communicationsModal.activeTab === 'stats_update' }" 
                                    @click="communicationsModal.activeTab = 'stats_update'" v-if="hasPermission('system', 'manage_updates')">
                                <i class="fas fa-chart-line"></i> Live Stats Update
                            </button>
                        </div>

                        <!-- Announcement Tab -->
                        <div v-if="communicationsModal.activeTab === 'announcement'" class="mt-6">
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">Title *</label>
                                    <input type="text" class="form-control" v-model="communicationsModal.form.title" 
                                           required aria-required="true" aria-label="Announcement title">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Content *</label>
                                    <textarea class="form-control form-textarea" v-model="communicationsModal.form.content" 
                                              rows="4" required aria-required="true" aria-label="Announcement content"></textarea>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label class="form-label">Priority Level</label>
                                        <select class="form-select" v-model="communicationsModal.form.priority" aria-label="Priority level">
                                            <option value="normal">Normal</option>
                                            <option value="high">High</option>
                                            <option value="urgent">Urgent</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Target Audience</label>
                                        <select class="form-select" v-model="communicationsModal.form.target_audience" 
                                                aria-label="Target audience">
                                            <option value="all_staff">All Staff</option>
                                            <option value="medical_staff">Medical Staff Only</option>
                                            <option value="residents">Residents Only</option>
                                            <option value="attendings">Attending Physicians Only</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Stats Update Tab -->
                        <div v-if="communicationsModal.activeTab === 'stats_update'" class="mt-6">
                            <div class="stats-update-section">
                                <div class="update-type-buttons">
                                    <button class="update-type-btn" :class="{ active: communicationsModal.form.updateType === 'daily' }"
                                            @click="communicationsModal.form.updateType = 'daily'">
                                        <i class="fas fa-sun"></i>
                                        Daily Status
                                    </button>
                                    <button class="update-type-btn" :class="{ active: communicationsModal.form.updateType === 'metric' }"
                                            @click="communicationsModal.form.updateType = 'metric'">
                                        <i class="fas fa-chart-bar"></i>
                                        Metric Update
                                    </button>
                                    <button class="update-type-btn" :class="{ active: communicationsModal.form.updateType === 'alert' }"
                                            @click="communicationsModal.form.updateType = 'alert'">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        Alert Status
                                    </button>
                                </div>

                                <!-- Daily Status Update -->
                                <div v-if="communicationsModal.form.updateType === 'daily'" class="space-y-4">
                                    <div class="form-group">
                                        <label class="form-label">Daily Status Summary *</label>
                                        <textarea class="form-control form-textarea" v-model="communicationsModal.form.dailySummary" 
                                                  rows="3" placeholder="Brief summary of department status..." 
                                                  required aria-required="true" aria-label="Daily status summary"></textarea>
                                        <small class="text-muted">This will appear in the Live Statistics panel</small>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Key Highlights</label>
                                        <div class="space-y-2">
                                            <input type="text" class="form-control" v-model="communicationsModal.form.highlight1" 
                                                   placeholder="Highlight 1 (e.g., ER: 3 critical cases)" aria-label="Highlight 1">
                                            <input type="text" class="form-control" v-model="communicationsModal.form.highlight2" 
                                                   placeholder="Highlight 2 (e.g., ICU: 90% capacity)" aria-label="Highlight 2">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Set Alert Status</label>
                                        <div class="alert-options-grid">
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.alerts.erBusy">
                                                <span>ER Busy</span>
                                            </label>
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.alerts.icuFull">
                                                <span>ICU at Capacity</span>
                                            </label>
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.alerts.wardFull">
                                                <span>Ward Full</span>
                                            </label>
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.alerts.staffShortage">
                                                <span>Staff Shortage</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Metric Update -->
                                <div v-if="communicationsModal.form.updateType === 'metric'" class="space-y-4">
                                    <div class="form-group">
                                        <label class="form-label">Metric Information</label>
                                        <div class="metric-inputs-grid">
                                            <div class="space-y-2">
                                                <input type="text" class="form-control" v-model="communicationsModal.form.metricName" 
                                                       placeholder="Metric name (e.g., ER Wait Time)" aria-label="Metric name">
                                                <input type="text" class="form-control" v-model="communicationsModal.form.metricValue" 
                                                       placeholder="Current value (e.g., 15 mins)" aria-label="Metric value">
                                            </div>
                                            <div class="space-y-2">
                                                <select class="form-select" v-model="communicationsModal.form.metricTrend" aria-label="Metric trend">
                                                    <option value="improved">Improved </option>
                                                    <option value="worsened">Worsened </option>
                                                    <option value="stable">Stable </option>
                                                </select>
                                                <input type="text" class="form-control" v-model="communicationsModal.form.metricChange" 
                                                       placeholder="Change amount (e.g., +5%)" aria-label="Change amount">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Context Note</label>
                                        <textarea class="form-control" v-model="communicationsModal.form.metricNote" 
                                                  rows="2" placeholder="Brief context about this metric..." aria-label="Metric context"></textarea>
                                    </div>
                                </div>

                                <!-- Alert Status -->
                                <div v-if="communicationsModal.form.updateType === 'alert'" class="space-y-4">
                                    <div class="form-group">
                                        <label class="form-label">Alert Level</label>
                                        <select class="form-select" v-model="communicationsModal.form.alertLevel" aria-label="Alert level">
                                            <option value="low">Low - Informational</option>
                                            <option value="medium">Medium - Attention Required</option>
                                            <option value="high">High - Immediate Action</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Alert Message *</label>
                                        <textarea class="form-control form-textarea" v-model="communicationsModal.form.alertMessage" 
                                                  rows="3" placeholder="Describe the alert situation..." 
                                                  required aria-required="true" aria-label="Alert message"></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Affected Areas</label>
                                        <div class="alert-options-grid">
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.affectedAreas.er">
                                                <span>Emergency Room</span>
                                            </label>
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.affectedAreas.icu">
                                                <span>ICU</span>
                                            </label>
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.affectedAreas.ward">
                                                <span>Ward</span>
                                            </label>
                                            <label class="alert-option">
                                                <input type="checkbox" class="form-check-input" v-model="communicationsModal.form.affectedAreas.surgery">
                                                <span>Surgery</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="communicationsModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveCommunication">
                            <i class="fas fa-paper-plane"></i> Publish Communication
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 4: Add/Edit On-call Schedule -->
            <div v-if="onCallModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-phone-medical"></i>
                            {{ onCallModal.mode === 'add' ? 'Schedule On-call' : 'Edit On-call Schedule' }}
                        </div>
                        <button class="modal-close" @click="onCallModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Date *</label>
                                <input type="date" class="form-control" v-model="onCallModal.form.duty_date" 
                                       required aria-required="true" aria-label="Duty date">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Shift Type *</label>
                                <select class="form-select" v-model="onCallModal.form.shift_type" 
                                        required aria-required="true" aria-label="Shift type">
                                    <option value="primary">Primary Call</option>
                                    <option value="backup">Backup Call</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Primary Physician *</label>
                                <select class="form-select" v-model="onCallModal.form.primary_physician_id" 
                                        required aria-required="true" aria-label="Primary physician">
                                    <option value="">Select Physician</option>
                                    <option v-for="physician in availablePhysicians" :key="physician.id" :value="physician.id">
                                        {{ physician.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Backup Physician</label>
                                <select class="form-select" v-model="onCallModal.form.backup_physician_id" aria-label="Backup physician">
                                    <option value="">No Backup</option>
                                    <option v-for="physician in availablePhysicians" :key="physician.id" :value="physician.id">
                                        {{ physician.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Start Time *</label>
                                <input type="time" class="form-control" v-model="onCallModal.form.start_time" 
                                       required aria-required="true" aria-label="Start time">
                            </div>
                            <div class="form-group">
                                <label class="form-label">End Time *</label>
                                <input type="time" class="form-control" v-model="onCallModal.form.end_time" 
                                       required aria-required="true" aria-label="End time">
                            </div>
                            <div class="form-group col-span-2">
                                <label class="form-label">Coverage Area</label>
                                <select class="form-select" v-model="onCallModal.form.coverage_area" aria-label="Coverage area">
                                    <option value="emergency">Emergency Department</option>
                                    <option value="icu">Intensive Care Unit</option>
                                    <option value="ward">General Ward</option>
                                    <option value="consultation">Consultations</option>
                                    <option value="all">All Areas</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="onCallModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveOnCallSchedule">
                            <i class="fas fa-save"></i> {{ onCallModal.mode === 'add' ? 'Schedule On-call' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 5: Add/Edit Rotation -->
            <div v-if="rotationModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-calendar-check"></i>
                            {{ rotationModal.mode === 'add' ? 'Add Rotation' : 'Edit Rotation' }}
                        </div>
                        <button class="modal-close" @click="rotationModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Rotation ID</label>
                                <input type="text" class="form-control" v-model="rotationModal.form.rotation_id" 
                                       aria-label="Rotation ID">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status *</label>
                                <select class="form-select" v-model="rotationModal.form.rotation_status" 
                                        required aria-required="true" aria-label="Rotation status">
                                    <option value="scheduled">Scheduled</option>
                                    <option value="active">Active</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Resident *</label>
                                <select class="form-select" v-model="rotationModal.form.resident_id" 
                                        required aria-required="true" aria-label="Resident">
                                    <option value="">Select Resident</option>
                                    <option v-for="resident in availableResidents" :key="resident.id" :value="resident.id">
                                        {{ resident.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Training Unit *</label>
                                <select class="form-select" v-model="rotationModal.form.training_unit_id" 
                                        required aria-required="true" aria-label="Training unit">
                                    <option value="">Select Unit</option>
                                    <option v-for="unit in trainingUnits" :key="unit.id" :value="unit.id">
                                        {{ unit.unit_name }}
                                    </option>
                                </select>
                            </div>
                           <div class="form-group">
    <label class="form-label">Start Date *</label>
    <input type="date" class="form-control" v-model="rotationModal.form.start_date" 
           required aria-required="true" aria-label="Start Date">
</div>
<div class="form-group">
    <label class="form-label">End Date *</label>
    <input type="date" class="form-control" v-model="rotationModal.form.end_date" 
           required aria-required="true" aria-label="End Date">
</div>
                            <div class="form-group">
                                <label class="form-label">Supervising Attending</label>
                                <select class="form-select" v-model="rotationModal.form.supervising_attending_id" 
                                        aria-label="Supervising attending">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="attending in availableAttendings" :key="attending.id" :value="attending.id">
                                        {{ attending.full_name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Rotation Category *</label>
                                <select class="form-select" v-model="rotationModal.form.rotation_category" 
                                        required aria-required="true" aria-label="Rotation category">
                                    <option value="clinical_rotation">Clinical Rotation</option>
                                    <option value="elective_rotation">Elective Rotation</option>
                                    <option value="research_rotation">Research</option>
                                    <option value="vacation_rotation">Vacation</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="rotationModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveRotation">
                            <i class="fas fa-save"></i> {{ rotationModal.mode === 'add' ? 'Add Rotation' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 6: Add/Edit Training Unit -->
            <div v-if="trainingUnitModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-hospital-user"></i>
                            {{ trainingUnitModal.mode === 'add' ? 'Add Training Unit' : 'Edit Training Unit' }}
                        </div>
                        <button class="modal-close" @click="trainingUnitModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Unit Name *</label>
                                <input type="text" class="form-control" v-model="trainingUnitModal.form.unit_name" 
                                       required aria-required="true" aria-label="Unit name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Unit Code *</label>
                                <input type="text" class="form-control" v-model="trainingUnitModal.form.unit_code" 
                                       required aria-required="true" aria-label="Unit code">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Department *</label>
                                <select class="form-select" v-model="trainingUnitModal.form.department_id" 
                                        required aria-required="true" aria-label="Department">
                                    <option value="">Select Department</option>
                                    <option v-for="department in departments" :key="department.id" :value="department.id">
                                        {{ department.name }}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status *</label>
                                <select class="form-select" v-model="trainingUnitModal.form.unit_status" 
                                        required aria-required="true" aria-label="Unit status">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Maximum Residents *</label>
                                <input type="number" class="form-control" v-model="trainingUnitModal.form.maximum_residents" 
                                       min="1" max="50" required aria-required="true" aria-label="Maximum residents">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Specialty</label>
                                <input type="text" class="form-control" v-model="trainingUnitModal.form.specialty" 
                                       placeholder="e.g., Pulmonology, Critical Care" aria-label="Specialty">
                            </div>
                            <div class="form-group col-span-2">
                                <label class="form-label">Supervising Attending</label>
                                <select class="form-select" v-model="trainingUnitModal.form.supervising_attending_id" 
                                        aria-label="Supervising attending">
                                    <option value="">Select Supervisor</option>
                                    <option v-for="attending in availableAttendings" :key="attending.id" :value="attending.id">
                                        {{ attending.full_name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="trainingUnitModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveTrainingUnit">
                            <i class="fas fa-save"></i> {{ trainingUnitModal.mode === 'add' ? 'Add Unit' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 7: Add/Edit Absence -->
            <div v-if="absenceModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-user-clock"></i>
                            {{ absenceModal.mode === 'add' ? 'Record Absence' : 'Edit Absence' }}
                        </div>
                        <button class="modal-close" @click="absenceModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">Staff Member *</label>
                                <select class="form-select" v-model="absenceModal.form.staff_id" 
                                        required aria-required="true" aria-label="Staff member">
                                    <option value="">Select Staff Member</option>
                                    <option v-for="staff in medicalStaff" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Absence Reason</label>
                                    <select class="form-select" v-model="absenceModal.form.absence_reason" aria-label="Absence reason">
                                        <option value="vacation">Vacation</option>
                                        <option value="sick_leave">Sick Leave</option>
                                        <option value="conference">Conference</option>
                                        <option value="training">Training</option>
                                        <option value="personal">Personal</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" v-model="absenceModal.form.status" aria-label="Absence status">
                                        <option value="active">Active</option>
                                        <option value="upcoming">Upcoming</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Start Date *</label>
                                    <input type="date" class="form-control" v-model="absenceModal.form.start_date" 
                                           required aria-required="true" aria-label="Start date">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">End Date *</label>
                                    <input type="date" class="form-control" v-model="absenceModal.form.end_date" 
                                           required aria-required="true" aria-label="End date">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Replacement Staff</label>
                                <select class="form-select" v-model="absenceModal.form.replacement_staff_id" aria-label="Replacement staff">
                                    <option value="">No Replacement</option>
                                    <option v-for="staff in availableReplacementStaff" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Notes</label>
                                <textarea class="form-control" v-model="absenceModal.form.notes" rows="3" 
                                          placeholder="Additional notes about this absence..." aria-label="Absence notes"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="absenceModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveAbsence">
                            <i class="fas fa-save"></i> {{ absenceModal.mode === 'add' ? 'Record Absence' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 8: Add/Edit Department -->
            <div v-if="departmentModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-sitemap"></i>
                            {{ departmentModal.mode === 'add' ? 'Add Department' : 'Edit Department' }}
                        </div>
                        <button class="modal-close" @click="departmentModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Department Name *</label>
                                <input type="text" class="form-control" v-model="departmentModal.form.name" 
                                       required aria-required="true" aria-label="Department name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Department Code *</label>
                                <input type="text" class="form-control" v-model="departmentModal.form.code" 
                                       required aria-required="true" aria-label="Department code">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status *</label>
                                <select class="form-select" v-model="departmentModal.form.status" 
                                        required aria-required="true" aria-label="Department status">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="archived">Archived</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Head of Department</label>
                                <select class="form-select" v-model="departmentModal.form.head_of_department_id" 
                                        aria-label="Head of department">
                                    <option value="">Select Head</option>
                                    <option v-for="staff in availableHeadsOfDepartment" :key="staff.id" :value="staff.id">
                                        {{ staff.full_name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="departmentModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveDepartment">
                            <i class="fas fa-save"></i> {{ departmentModal.mode === 'add' ? 'Add Department' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 9: User Profile -->
            <div v-if="userProfileModal.show" class="modal-overlay">
                <div class="modal-container">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas fa-user"></i> Profile Settings
                        </div>
                        <button class="modal-close" @click="userProfileModal.show = false" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <div class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">Full Name *</label>
                                <input type="text" class="form-control" v-model="userProfileModal.form.full_name" 
                                       required aria-required="true" aria-label="Full name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email *</label>
                                <input type="email" class="form-control" v-model="userProfileModal.form.email" 
                                       required aria-required="true" aria-label="Email" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Department</label>
                                <select class="form-select" v-model="userProfileModal.form.department_id" aria-label="Department">
                                    <option value="">Select Department</option>
                                    <option v-for="department in departments" :key="department.id" :value="department.id">
                                        {{ department.name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="userProfileModal.show = false">Cancel</button>
                        <button class="btn btn-primary" @click="saveUserProfile">
                            <i class="fas fa-save"></i> Save Profile
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODAL 10: Confirmation Modal -->
            <div v-if="confirmationModal.show" class="modal-overlay">
                <div class="modal-container" style="max-width: 500px;">
                    <div class="modal-header">
                        <div class="modal-title">
                            <i class="fas" :class="confirmationModal.icon || 'fa-question-circle'"></i>
                            {{ confirmationModal.title || 'Confirm Action' }}
                        </div>
                        <button class="modal-close" @click="cancelConfirmation" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="modal-body">
                        <p class="text-center text-gray-700 mb-4">{{ confirmationModal.message || 'Are you sure you want to proceed?' }}</p>
                        <div v-if="confirmationModal.details" class="p-3 bg-blue-50 rounded mb-4">
                            <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                            {{ confirmationModal.details }}
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-secondary" @click="cancelConfirmation">
                            {{ confirmationModal.cancelButtonText || 'Cancel' }}
                        </button>
                        <button class="btn" :class="confirmationModal.confirmButtonClass || 'btn-danger'" @click="confirmAction">
                            <i :class="confirmationModal.confirmButtonIcon || 'fa-check'"></i>
                            {{ confirmationModal.confirmButtonText || 'Confirm' }}
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </div>

        <!-- Vue Application -->
    <script src="app.js"></script>
    
    <!-- Simple Loading Check -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Just hide any loading screens after app loads
            setTimeout(function() {
                const loadingDiv = document.getElementById('app-loading');
                if (loadingDiv) {
                    loadingDiv.style.display = 'none';
                }
                
                // Also check for v-cloak removal
                const appElement = document.getElementById('app');
                if (appElement && appElement.hasAttribute('v-cloak')) {
                    appElement.removeAttribute('v-cloak');
                }
            }, 1000); // Wait 1 second then force show app
        });
    </script>
</body>
</html>
